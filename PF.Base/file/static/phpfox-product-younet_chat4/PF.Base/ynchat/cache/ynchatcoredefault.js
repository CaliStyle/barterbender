
(function(a,b){function cy(a){return f.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}function cv(a){if(!ck[a]){var b=c.body,d=f("<"+a+">").appendTo(b),e=d.css("display");d.remove();if(e==="none"||e===""){cl||(cl=c.createElement("iframe"),cl.frameBorder=cl.width=cl.height=0),b.appendChild(cl);if(!cm||!cl.createElement)cm=(cl.contentWindow||cl.contentDocument).document,cm.write((c.compatMode==="CSS1Compat"?"<!doctype html>":"")+"<html><body>"),cm.close();d=cm.createElement(a),cm.body.appendChild(d),e=f.css(d,"display"),b.removeChild(cl)}ck[a]=e}return ck[a]}function cu(a,b){var c={};f.each(cq.concat.apply([],cq.slice(0,b)),function(){c[this]=a});return c}function ct(){cr=b}function cs(){setTimeout(ct,0);return cr=f.now()}function cj(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function ci(){try{return new a.XMLHttpRequest}catch(b){}}function cc(a,c){a.dataFilter&&(c=a.dataFilter(c,a.dataType));var d=a.dataTypes,e={},g,h,i=d.length,j,k=d[0],l,m,n,o,p;for(g=1;g<i;g++){if(g===1)for(h in a.converters)typeof h=="string"&&(e[h.toLowerCase()]=a.converters[h]);l=k,k=d[g];if(k==="*")k=l;else if(l!=="*"&&l!==k){m=l+" "+k,n=e[m]||e["* "+k];if(!n){p=b;for(o in e){j=o.split(" ");if(j[0]===l||j[0]==="*"){p=e[j[1]+" "+k];if(p){o=e[o],o===!0?n=p:p===!0&&(n=o);break}}}}!n&&!p&&f.error("No conversion from "+m.replace(" "," to ")),n!==!0&&(c=n?n(c):p(o(c)))}}return c}function cb(a,c,d){var e=a.contents,f=a.dataTypes,g=a.responseFields,h,i,j,k;for(i in g)i in d&&(c[g[i]]=d[i]);while(f[0]==="*")f.shift(),h===b&&(h=a.mimeType||c.getResponseHeader("content-type"));if(h)for(i in e)if(e[i]&&e[i].test(h)){f.unshift(i);break}if(f[0]in d)j=f[0];else{for(i in d){if(!f[0]||a.converters[i+" "+f[0]]){j=i;break}k||(k=i)}j=j||k}if(j){j!==f[0]&&f.unshift(j);return d[j]}}function ca(a,b,c,d){if(f.isArray(b))f.each(b,function(b,e){c||bE.test(a)?d(a,e):ca(a+"["+(typeof e=="object"||f.isArray(e)?b:"")+"]",e,c,d)});else if(!c&&b!=null&&typeof b=="object")for(var e in b)ca(a+"["+e+"]",b[e],c,d);else d(a,b)}function b_(a,c){var d,e,g=f.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((g[d]?a:e||(e={}))[d]=c[d]);e&&f.extend(!0,a,e)}function b$(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;var h=a[f],i=0,j=h?h.length:0,k=a===bT,l;for(;i<j&&(k||!l);i++)l=h[i](c,d,e),typeof l=="string"&&(!k||g[l]?l=b:(c.dataTypes.unshift(l),l=b$(a,c,d,e,l,g)));(k||!l)&&!g["*"]&&(l=b$(a,c,d,e,"*",g));return l}function bZ(a){return function(b,c){typeof b!="string"&&(c=b,b="*");if(f.isFunction(c)){var d=b.toLowerCase().split(bP),e=0,g=d.length,h,i,j;for(;e<g;e++)h=d[e],j=/^\+/.test(h),j&&(h=h.substr(1)||"*"),i=a[h]=a[h]||[],i[j?"unshift":"push"](c)}}}function bC(a,b,c){var d=b==="width"?a.offsetWidth:a.offsetHeight,e=b==="width"?bx:by,g=0,h=e.length;if(d>0){if(c!=="border")for(;g<h;g++)c||(d-=parseFloat(f.css(a,"padding"+e[g]))||0),c==="margin"?d+=parseFloat(f.css(a,c+e[g]))||0:d-=parseFloat(f.css(a,"border"+e[g]+"Width"))||0;return d+"px"}d=bz(a,b,b);if(d<0||d==null)d=a.style[b]||0;d=parseFloat(d)||0;if(c)for(;g<h;g++)d+=parseFloat(f.css(a,"padding"+e[g]))||0,c!=="padding"&&(d+=parseFloat(f.css(a,"border"+e[g]+"Width"))||0),c==="margin"&&(d+=parseFloat(f.css(a,c+e[g]))||0);return d+"px"}function bp(a,b){b.src?f.ajax({url:b.src,async:!1,dataType:"script"}):f.globalEval((b.text||b.textContent||b.innerHTML||"").replace(bf,"/*$0*/")),b.parentNode&&b.parentNode.removeChild(b)}function bo(a){var b=c.createElement("div");bh.appendChild(b),b.innerHTML=a.outerHTML;return b.firstChild}function bn(a){var b=(a.nodeName||"").toLowerCase();b==="input"?bm(a):b!=="script"&&typeof a.getElementsByTagName!="undefined"&&f.grep(a.getElementsByTagName("input"),bm)}function bm(a){if(a.type==="checkbox"||a.type==="radio")a.defaultChecked=a.checked}function bl(a){return typeof a.getElementsByTagName!="undefined"?a.getElementsByTagName("*"):typeof a.querySelectorAll!="undefined"?a.querySelectorAll("*"):[]}function bk(a,b){var c;if(b.nodeType===1){b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase();if(c==="object")b.outerHTML=a.outerHTML;else if(c!=="input"||a.type!=="checkbox"&&a.type!=="radio"){if(c==="option")b.selected=a.defaultSelected;else if(c==="input"||c==="textarea")b.defaultValue=a.defaultValue}else a.checked&&(b.defaultChecked=b.checked=a.checked),b.value!==a.value&&(b.value=a.value);b.removeAttribute(f.expando)}}function bj(a,b){if(b.nodeType===1&&!!f.hasData(a)){var c,d,e,g=f._data(a),h=f._data(b,g),i=g.events;if(i){delete h.handle,h.events={};for(c in i)for(d=0,e=i[c].length;d<e;d++)f.event.add(b,c+(i[c][d].namespace?".":"")+i[c][d].namespace,i[c][d],i[c][d].data)}h.data&&(h.data=f.extend({},h.data))}}function bi(a,b){return f.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function U(a){var b=V.split("|"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}function T(a,b,c){b=b||0;if(f.isFunction(b))return f.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c});if(b.nodeType)return f.grep(a,function(a,d){return a===b===c});if(typeof b=="string"){var d=f.grep(a,function(a){return a.nodeType===1});if(O.test(b))return f.filter(b,d,!c);b=f.filter(b,d)}return f.grep(a,function(a,d){return f.inArray(a,b)>=0===c})}function S(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function K(){return!0}function J(){return!1}function n(a,b,c){var d=b+"defer",e=b+"queue",g=b+"mark",h=f._data(a,d);h&&(c==="queue"||!f._data(a,e))&&(c==="mark"||!f._data(a,g))&&setTimeout(function(){!f._data(a,e)&&!f._data(a,g)&&(f.removeData(a,d,!0),h.fire())},0)}function m(a){for(var b in a){if(b==="data"&&f.isEmptyObject(a[b]))continue;if(b!=="toJSON")return!1}return!0}function l(a,c,d){if(d===b&&a.nodeType===1){var e="data-"+c.replace(k,"-$1").toLowerCase();d=a.getAttribute(e);if(typeof d=="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:f.isNumeric(d)?parseFloat(d):j.test(d)?f.parseJSON(d):d}catch(g){}f.data(a,c,d)}else d=b}return d}function h(a){var b=g[a]={},c,d;a=a.split(/\s+/);for(c=0,d=a.length;c<d;c++)b[a[c]]=!0;return b}var c=a.document,d=a.navigator,e=a.location,f=function(){function J(){if(!e.isReady){try{c.documentElement.doScroll("left")}catch(a){setTimeout(J,1);return}e.ready()}}var e=function(a,b){return new e.fn.init(a,b,h)},f=a.jsynchat,g=a.$,h,i=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,j=/\S/,k=/^\s+/,l=/\s+$/,m=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,n=/^[\],:{}\s]*$/,o=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,p=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,q=/(?:^|:|,)(?:\s*\[)+/g,r=/(webkit)[ \/]([\w.]+)/,s=/(opera)(?:.*version)?[ \/]([\w.]+)/,t=/(msie) ([\w.]+)/,u=/(mozilla)(?:.*? rv:([\w.]+))?/,v=/-([a-z]|[0-9])/ig,w=/^-ms-/,x=function(a,b){return(b+"").toUpperCase()},y=d.userAgent,z,A,B,C=Object.prototype.toString,D=Object.prototype.hasOwnProperty,E=Array.prototype.push,F=Array.prototype.slice,G=String.prototype.trim,H=Array.prototype.indexOf,I={};e.fn=e.prototype={constructor:e,init:function(a,d,f){var g,h,j,k;if(!a)return this;if(a.nodeType){this.context=this[0]=a,this.length=1;return this}if(a==="body"&&!d&&c.body){this.context=c,this[0]=c.body,this.selector=a,this.length=1;return this}if(typeof a=="string"){a.charAt(0)!=="<"||a.charAt(a.length-1)!==">"||a.length<3?g=i.exec(a):g=[null,a,null];if(g&&(g[1]||!d)){if(g[1]){d=d instanceof e?d[0]:d,k=d?d.ownerDocument||d:c,j=m.exec(a),j?e.isPlainObject(d)?(a=[c.createElement(j[1])],e.fn.attr.call(a,d,!0)):a=[k.createElement(j[1])]:(j=e.buildFragment([g[1]],[k]),a=(j.cacheable?e.clone(j.fragment):j.fragment).childNodes);return e.merge(this,a)}h=c.getElementById(g[2]);if(h&&h.parentNode){if(h.id!==g[2])return f.find(a);this.length=1,this[0]=h}this.context=c,this.selector=a;return this}return!d||d.jsynchat?(d||f).find(a):this.constructor(d).find(a)}if(e.isFunction(a))return f.ready(a);a.selector!==b&&(this.selector=a.selector,this.context=a.context);return e.makeArray(a,this)},selector:"",jsynchat:"1.7.1",length:0,size:function(){return this.length},toArray:function(){return F.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=this.constructor();e.isArray(a)?E.apply(d,a):e.merge(d,a),d.prevObject=this,d.context=this.context,b==="find"?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")");return d},each:function(a,b){return e.each(this,a,b)},ready:function(a){e.bindReady(),A.add(a);return this},eq:function(a){a=+a;return a===-1?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(F.apply(this,arguments),"slice",F.call(arguments).join(","))},map:function(a){return this.pushStack(e.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:E,sort:[].sort,splice:[].splice},e.fn.init.prototype=e.fn,e.extend=e.fn.extend=function(){var a,c,d,f,g,h,i=arguments[0]||{},j=1,k=arguments.length,l=!1;typeof i=="boolean"&&(l=i,i=arguments[1]||{},j=2),typeof i!="object"&&!e.isFunction(i)&&(i={}),k===j&&(i=this,--j);for(;j<k;j++)if((a=arguments[j])!=null)for(c in a){d=i[c],f=a[c];if(i===f)continue;l&&f&&(e.isPlainObject(f)||(g=e.isArray(f)))?(g?(g=!1,h=d&&e.isArray(d)?d:[]):h=d&&e.isPlainObject(d)?d:{},i[c]=e.extend(l,h,f)):f!==b&&(i[c]=f)}return i},e.extend({noConflict:function(b){a.$===e&&(a.$=g),b&&a.jsynchat===e&&(a.jsynchat=f);return e},isReady:!1,readyWait:1,holdReady:function(a){a?e.readyWait++:e.ready(!0)},ready:function(a){if(a===!0&&!--e.readyWait||a!==!0&&!e.isReady){if(!c.body)return setTimeout(e.ready,1);e.isReady=!0;if(a!==!0&&--e.readyWait>0)return;A.fireWith(c,[e]),e.fn.trigger&&e(c).trigger("ready").off("ready")}},bindReady:function(){if(!A){A=e.Callbacks("once memory");if(c.readyState==="complete")return setTimeout(e.ready,1);if(c.addEventListener)c.addEventListener("DOMContentLoaded",B,!1),a.addEventListener("load",e.ready,!1);else if(c.attachEvent){c.attachEvent("onreadystatechange",B),a.attachEvent("onload",e.ready);var b=!1;try{b=a.frameElement==null}catch(d){}c.documentElement.doScroll&&b&&J()}}},isFunction:function(a){return e.type(a)==="function"},isArray:Array.isArray||function(a){return e.type(a)==="array"},isWindow:function(a){return a&&typeof a=="object"&&"setInterval"in a},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return a==null?String(a):I[C.call(a)]||"object"},isPlainObject:function(a){if(!a||e.type(a)!=="object"||a.nodeType||e.isWindow(a))return!1;try{if(a.constructor&&!D.call(a,"constructor")&&!D.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}var d;for(d in a);return d===b||D.call(a,d)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw new Error(a)},parseJSON:function(b){if(typeof b!="string"||!b)return null;b=e.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(n.test(b.replace(o,"@").replace(p,"]").replace(q,"")))return(new Function("return "+b))();e.error("Invalid JSON: "+b)},parseXML:function(c){var d,f;try{a.DOMParser?(f=new DOMParser,d=f.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(g){d=b}(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&e.error("Invalid XML: "+c);return d},noop:function(){},globalEval:function(b){b&&j.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(w,"ms-").replace(v,x)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var f,g=0,h=a.length,i=h===b||e.isFunction(a);if(d){if(i){for(f in a)if(c.apply(a[f],d)===!1)break}else for(;g<h;)if(c.apply(a[g++],d)===!1)break}else if(i){for(f in a)if(c.call(a[f],f,a[f])===!1)break}else for(;g<h;)if(c.call(a[g],g,a[g++])===!1)break;return a},trim:G?function(a){return a==null?"":G.call(a)}:function(a){return a==null?"":(a+"").replace(k,"").replace(l,"")},makeArray:function(a,b){var c=b||[];if(a!=null){var d=e.type(a);a.length==null||d==="string"||d==="function"||d==="regexp"||e.isWindow(a)?E.call(c,a):e.merge(c,a)}return c},inArray:function(a,b,c){var d;if(b){if(H)return H.call(b,a,c);d=b.length,c=c?c<0?Math.max(0,d+c):c:0;for(;c<d;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=a.length,e=0;if(typeof c.length=="number")for(var f=c.length;e<f;e++)a[d++]=c[e];else while(c[e]!==b)a[d++]=c[e++];a.length=d;return a},grep:function(a,b,c){var d=[],e;c=!!c;for(var f=0,g=a.length;f<g;f++)e=!!b(a[f],f),c!==e&&d.push(a[f]);return d},map:function(a,c,d){var f,g,h=[],i=0,j=a.length,k=a instanceof e||j!==b&&typeof j=="number"&&(j>0&&a[0]&&a[j-1]||j===0||e.isArray(a));if(k)for(;i<j;i++)f=c(a[i],i,d),f!=null&&(h[h.length]=f);else for(g in a)f=c(a[g],g,d),f!=null&&(h[h.length]=f);return h.concat.apply([],h)},guid:1,proxy:function(a,c){if(typeof c=="string"){var d=a[c];c=a,a=d}if(!e.isFunction(a))return b;var f=F.call(arguments,2),g=function(){return a.apply(c,f.concat(F.call(arguments)))};g.guid=a.guid=a.guid||g.guid||e.guid++;return g},access:function(a,c,d,f,g,h){var i=a.length;if(typeof c=="object"){for(var j in c)e.access(a,j,c[j],f,g,d);return a}if(d!==b){f=!h&&f&&e.isFunction(d);for(var k=0;k<i;k++)g(a[k],c,f?d.call(a[k],k,g(a[k],c)):d,h);return a}return i?g(a[0],c):b},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();var b=r.exec(a)||s.exec(a)||t.exec(a)||a.indexOf("compatible")<0&&u.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}e.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function(d,f){f&&f instanceof e&&!(f instanceof a)&&(f=a(f));return e.fn.init.call(this,d,f,b)},a.fn.init.prototype=a.fn;var b=a(c);return a},browser:{}}),e.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){I["[object "+b+"]"]=b.toLowerCase()}),z=e.uaMatch(y),z.browser&&(e.browser[z.browser]=!0,e.browser.version=z.version),e.browser.webkit&&(e.browser.safari=!0),j.test(" ")&&(k=/^[\s\xA0]+/,l=/[\s\xA0]+$/),h=e(c),c.addEventListener?B=function(){c.removeEventListener("DOMContentLoaded",B,!1),e.ready()}:c.attachEvent&&(B=function(){c.readyState==="complete"&&(c.detachEvent("onreadystatechange",B),e.ready())});return e}(),g={};f.Callbacks=function(a){a=a?g[a]||h(a):{};var c=[],d=[],e,i,j,k,l,m=function(b){var d,e,g,h,i;for(d=0,e=b.length;d<e;d++)g=b[d],h=f.type(g),h==="array"?m(g):h==="function"&&(!a.unique||!o.has(g))&&c.push(g)},n=function(b,f){f=f||[],e=!a.memory||[b,f],i=!0,l=j||0,j=0,k=c.length;for(;c&&l<k;l++)if(c[l].apply(b,f)===!1&&a.stopOnFalse){e=!0;break}i=!1,c&&(a.once?e===!0?o.disable():c=[]:d&&d.length&&(e=d.shift(),o.fireWith(e[0],e[1])))},o={add:function(){if(c){var a=c.length;m(arguments),i?k=c.length:e&&e!==!0&&(j=a,n(e[0],e[1]))}return this},remove:function(){if(c){var b=arguments,d=0,e=b.length;for(;d<e;d++)for(var f=0;f<c.length;f++)if(b[d]===c[f]){i&&f<=k&&(k--,f<=l&&l--),c.splice(f--,1);if(a.unique)break}}return this},has:function(a){if(c){var b=0,d=c.length;for(;b<d;b++)if(a===c[b])return!0}return!1},empty:function(){c=[];return this},disable:function(){c=d=e=b;return this},disabled:function(){return!c},lock:function(){d=b,(!e||e===!0)&&o.disable();return this},locked:function(){return!d},fireWith:function(b,c){d&&(i?a.once||d.push([b,c]):(!a.once||!e)&&n(b,c));return this},fire:function(){o.fireWith(this,arguments);return this},fired:function(){return!!e}};return o};var i=[].slice;f.extend({Deferred:function(a){var b=f.Callbacks("once memory"),c=f.Callbacks("once memory"),d=f.Callbacks("memory"),e="pending",g={resolve:b,reject:c,notify:d},h={done:b.add,fail:c.add,progress:d.add,state:function(){return e},isResolved:b.fired,isRejected:c.fired,then:function(a,b,c){i.done(a).fail(b).progress(c);return this},always:function(){i.done.apply(i,arguments).fail.apply(i,arguments);return this},pipe:function(a,b,c){return f.Deferred(function(d){f.each({done:[a,"resolve"],fail:[b,"reject"],progress:[c,"notify"]},function(a,b){var c=b[0],e=b[1],g;f.isFunction(c)?i[a](function(){g=c.apply(this,arguments),g&&f.isFunction(g.promise)?g.promise().then(d.resolve,d.reject,d.notify):d[e+"With"](this===i?d:this,[g])}):i[a](d[e])})}).promise()},promise:function(a){if(a==null)a=h;else for(var b in h)a[b]=h[b];return a}},i=h.promise({}),j;for(j in g)i[j]=g[j].fire,i[j+"With"]=g[j].fireWith;i.done(function(){e="resolved"},c.disable,d.lock).fail(function(){e="rejected"},b.disable,d.lock),a&&a.call(i,i);return i},when:function(a){function m(a){return function(b){e[a]=arguments.length>1?i.call(arguments,0):b,j.notifyWith(k,e)}}function l(a){return function(c){b[a]=arguments.length>1?i.call(arguments,0):c,--g||j.resolveWith(j,b)}}var b=i.call(arguments,0),c=0,d=b.length,e=Array(d),g=d,h=d,j=d<=1&&a&&f.isFunction(a.promise)?a:f.Deferred(),k=j.promise();if(d>1){for(;c<d;c++)b[c]&&b[c].promise&&f.isFunction(b[c].promise)?b[c].promise().then(l(c),j.reject,m(c)):--g;g||j.resolveWith(j,b)}else j!==a&&j.resolveWith(j,d?[a]:[]);return k}}),f.support=function(){var b,d,e,g,h,i,j,k,l,m,n,o,p,q=c.createElement("div"),r=c.documentElement;q.setAttribute("className","t"),q.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",d=q.getElementsByTagName("*"),e=q.getElementsByTagName("a")[0];if(!d||!d.length||!e)return{};g=c.createElement("select"),h=g.appendChild(c.createElement("option")),i=q.getElementsByTagName("input")[0],b={leadingWhitespace:q.firstChild.nodeType===3,tbody:!q.getElementsByTagName("tbody").length,htmlSerialize:!!q.getElementsByTagName("link").length,style:/top/.test(e.getAttribute("style")),hrefNormalized:e.getAttribute("href")==="/a",opacity:/^0.55/.test(e.style.opacity),cssFloat:!!e.style.cssFloat,checkOn:i.value==="on",optSelected:h.selected,getSetAttribute:q.className!=="t",enctype:!!c.createElement("form").enctype,html5Clone:c.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0},i.checked=!0,b.noCloneChecked=i.cloneNode(!0).checked,g.disabled=!0,b.optDisabled=!h.disabled;try{delete q.test}catch(s){b.deleteExpando=!1}!q.addEventListener&&q.attachEvent&&q.fireEvent&&(q.attachEvent("onclick",function(){b.noCloneEvent=!1}),q.cloneNode(!0).fireEvent("onclick")),i=c.createElement("input"),i.value="t",i.setAttribute("type","radio"),b.radioValue=i.value==="t",i.setAttribute("checked","checked"),q.appendChild(i),k=c.createDocumentFragment(),k.appendChild(q.lastChild),b.checkClone=k.cloneNode(!0).cloneNode(!0).lastChild.checked,b.appendChecked=i.checked,k.removeChild(i),k.appendChild(q),q.innerHTML="",a.getComputedStyle&&(j=c.createElement("div"),j.style.width="0",j.style.marginRight="0",q.style.width="2px",q.appendChild(j),b.reliableMarginRight=(parseInt((a.getComputedStyle(j,null)||{marginRight:0}).marginRight,10)||0)===0);if(q.attachEvent)for(o in{submit:1,change:1,focusin:1})n="on"+o,p=n in q,p||(q.setAttribute(n,"return;"),p=typeof q[n]=="function"),b[o+"Bubbles"]=p;k.removeChild(q),k=g=h=j=q=i=null,f(function(){var a,d,e,g,h,i,j,k,m,n,o,r=c.getElementsByTagName("body")[0];!r||(j=1,k="position:absolute;top:0;left:0;width:1px;height:1px;margin:0;",m="visibility:hidden;border:0;",n="style='"+k+"border:5px solid #000;padding:0;'",o="<div "+n+"><div></div></div>"+"<table "+n+" cellpadding='0' cellspacing='0'>"+"<tr><td></td></tr></table>",a=c.createElement("div"),a.style.cssText=m+"width:0;height:0;position:static;top:0;margin-top:"+j+"px",r.insertBefore(a,r.firstChild),q=c.createElement("div"),a.appendChild(q),q.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>",l=q.getElementsByTagName("td"),p=l[0].offsetHeight===0,l[0].style.display="",l[1].style.display="none",b.reliableHiddenOffsets=p&&l[0].offsetHeight===0,q.innerHTML="",q.style.width=q.style.paddingLeft="1px",f.boxModel=b.boxModel=q.offsetWidth===2,typeof q.style.zoom!="undefined"&&(q.style.display="inline",q.style.zoom=1,b.inlineBlockNeedsLayout=q.offsetWidth===2,q.style.display="",q.innerHTML="<div style='width:4px;'></div>",b.shrinkWrapBlocks=q.offsetWidth!==2),q.style.cssText=k+m,q.innerHTML=o,d=q.firstChild,e=d.firstChild,h=d.nextSibling.firstChild.firstChild,i={doesNotAddBorder:e.offsetTop!==5,doesAddBorderForTableAndCells:h.offsetTop===5},e.style.position="fixed",e.style.top="20px",i.fixedPosition=e.offsetTop===20||e.offsetTop===15,e.style.position=e.style.top="",d.style.overflow="hidden",d.style.position="relative",i.subtractsBorderForOverflowNotVisible=e.offsetTop===-5,i.doesNotIncludeMarginInBodyOffset=r.offsetTop!==j,r.removeChild(a),q=a=null,f.extend(b,i))});return b}();var j=/^(?:\{.*\}|\[.*\])$/,k=/([A-Z])/g;f.extend({cache:{},uuid:0,expando:"jsynchat"+(f.fn.jsynchat+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){a=a.nodeType?f.cache[a[f.expando]]:a[f.expando];return!!a&&!m(a)},data:function(a,c,d,e){if(!!f.acceptData(a)){var g,h,i,j=f.expando,k=typeof c=="string",l=a.nodeType,m=l?f.cache:a,n=l?a[j]:a[j]&&j,o=c==="events";if((!n||!m[n]||!o&&!e&&!m[n].data)&&k&&d===b)return;n||(l?a[j]=n=++f.uuid:n=j),m[n]||(m[n]={},l||(m[n].toJSON=f.noop));if(typeof c=="object"||typeof c=="function")e?m[n]=f.extend(m[n],c):m[n].data=f.extend(m[n].data,c);g=h=m[n],e||(h.data||(h.data={}),h=h.data),d!==b&&(h[f.camelCase(c)]=d);if(o&&!h[c])return g.events;k?(i=h[c],i==null&&(i=h[f.camelCase(c)])):i=h;return i}},removeData:function(a,b,c){if(!!f.acceptData(a)){var d,e,g,h=f.expando,i=a.nodeType,j=i?f.cache:a,k=i?a[h]:h;if(!j[k])return;if(b){d=c?j[k]:j[k].data;if(d){f.isArray(b)||(b in d?b=[b]:(b=f.camelCase(b),b in d?b=[b]:b=b.split(" ")));for(e=0,g=b.length;e<g;e++)delete d[b[e]];if(!(c?m:f.isEmptyObject)(d))return}}if(!c){delete j[k].data;if(!m(j[k]))return}f.support.deleteExpando||!j.setInterval?delete j[k]:j[k]=null,i&&(f.support.deleteExpando?delete a[h]:a.removeAttribute?a.removeAttribute(h):a[h]=null)}},_data:function(a,b,c){return f.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=f.noData[a.nodeName.toLowerCase()];if(b)return b!==!0&&a.getAttribute("classid")===b}return!0}}),f.fn.extend({data:function(a,c){var d,e,g,h=null;if(typeof a=="undefined"){if(this.length){h=f.data(this[0]);if(this[0].nodeType===1&&!f._data(this[0],"parsedAttrs")){e=this[0].attributes;for(var i=0,j=e.length;i<j;i++)g=e[i].name,g.indexOf("data-")===0&&(g=f.camelCase(g.substring(5)),l(this[0],g,h[g]));f._data(this[0],"parsedAttrs",!0)}}return h}if(typeof a=="object")return this.each(function(){f.data(this,a)});d=a.split("."),d[1]=d[1]?"."+d[1]:"";if(c===b){h=this.triggerHandler("getData"+d[1]+"!",[d[0]]),h===b&&this.length&&(h=f.data(this[0],a),h=l(this[0],a,h));return h===b&&d[1]?this.data(d[0]):h}return this.each(function(){var b=f(this),e=[d[0],c];b.triggerHandler("setData"+d[1]+"!",e),f.data(this,a,c),b.triggerHandler("changeData"+d[1]+"!",e)})},removeData:function(a){return this.each(function(){f.removeData(this,a)})}}),f.extend({_mark:function(a,b){a&&(b=(b||"fx")+"mark",f._data(a,b,(f._data(a,b)||0)+1))},_unmark:function(a,b,c){a!==!0&&(c=b,b=a,a=!1);if(b){c=c||"fx";var d=c+"mark",e=a?0:(f._data(b,d)||1)-1;e?f._data(b,d,e):(f.removeData(b,d,!0),n(b,c,"mark"))}},queue:function(a,b,c){var d;if(a){b=(b||"fx")+"queue",d=f._data(a,b),c&&(!d||f.isArray(c)?d=f._data(a,b,f.makeArray(c)):d.push(c));return d||[]}},dequeue:function(a,b){b=b||"fx";var c=f.queue(a,b),d=c.shift(),e={};d==="inprogress"&&(d=c.shift()),d&&(b==="fx"&&c.unshift("inprogress"),f._data(a,b+".run",e),d.call(a,function(){f.dequeue(a,b)},e)),c.length||(f.removeData(a,b+"queue "+b+".run",!0),n(a,b,"queue"))}}),f.fn.extend({queue:function(a,c){typeof a!="string"&&(c=a,a="fx");if(c===b)return f.queue(this[0],a);return this.each(function(){var b=f.queue(this,a,c);a==="fx"&&b[0]!=="inprogress"&&f.dequeue(this,a)})},dequeue:function(a){return this.each(function(){f.dequeue(this,a)})},delay:function(a,b){a=f.fx?f.fx.speeds[a]||a:a,b=b||"fx";return this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){function m(){--h||d.resolveWith(e,[e])}typeof a!="string"&&(c=a,a=b),a=a||"fx";var d=f.Deferred(),e=this,g=e.length,h=1,i=a+"defer",j=a+"queue",k=a+"mark",l;while(g--)if(l=f.data(e[g],i,b,!0)||(f.data(e[g],j,b,!0)||f.data(e[g],k,b,!0))&&f.data(e[g],i,f.Callbacks("once memory"),!0))h++,l.add(m);m();return d.promise()}});var o=/[\n\t\r]/g,p=/\s+/,q=/\r/g,r=/^(?:button|input)$/i,s=/^(?:button|input|object|select|textarea)$/i,t=/^a(?:rea)?$/i,u=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,v=f.support.getSetAttribute,w,x,y;f.fn.extend({attr:function(a,b){return f.access(this,a,b,!0,f.attr)},removeAttr:function(a){return this.each(function(){f.removeAttr(this,a)})},prop:function(a,b){return f.access(this,a,b,!0,f.prop)},removeProp:function(a){a=f.propFix[a]||a;return this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,g,h,i;if(f.isFunction(a))return this.each(function(b){f(this).addClass(a.call(this,b,this.className))});if(a&&typeof a=="string"){b=a.split(p);for(c=0,d=this.length;c<d;c++){e=this[c];if(e.nodeType===1)if(!e.className&&b.length===1)e.className=a;else{g=" "+e.className+" ";for(h=0,i=b.length;h<i;h++)~g.indexOf(" "+b[h]+" ")||(g+=b[h]+" ");e.className=f.trim(g)}}}return this},removeClass:function(a){var c,d,e,g,h,i,j;if(f.isFunction(a))return this.each(function(b){f(this).removeClass(a.call(this,b,this.className))});if(a&&typeof a=="string"||a===b){c=(a||"").split(p);for(d=0,e=this.length;d<e;d++){g=this[d];if(g.nodeType===1&&g.className)if(a){h=(" "+g.className+" ").replace(o," ");for(i=0,j=c.length;i<j;i++)h=h.replace(" "+c[i]+" "," ");g.className=f.trim(h)}else g.className=""}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b=="boolean";if(f.isFunction(a))return this.each(function(c){f(this).toggleClass(a.call(this,c,this.className,b),b)});return this.each(function(){if(c==="string"){var e,g=0,h=f(this),i=b,j=a.split(p);while(e=j[g++])i=d?i:!h.hasClass(e),h[i?"addClass":"removeClass"](e)}else if(c==="undefined"||c==="boolean")this.className&&f._data(this,"__className__",this.className),this.className=this.className||a===!1?"":f._data(this,"__className__")||""})},hasClass:function(a){var b=" "+a+" ",c=0,d=this.length;for(;c<d;c++)if(this[c].nodeType===1&&(" "+this[c].className+" ").replace(o," ").indexOf(b)>-1)return!0;return!1},val:function(a){var c,d,e,g=this[0];{if(!!arguments.length){e=f.isFunction(a);return this.each(function(d){var g=f(this),h;if(this.nodeType===1){e?h=a.call(this,d,g.val()):h=a,h==null?h="":typeof h=="number"?h+="":f.isArray(h)&&(h=f.map(h,function(a){return a==null?"":a+""})),c=f.valHooks[this.nodeName.toLowerCase()]||f.valHooks[this.type];if(!c||!("set"in c)||c.set(this,h,"value")===b)this.value=h}})}if(g){c=f.valHooks[g.nodeName.toLowerCase()]||f.valHooks[g.type];if(c&&"get"in c&&(d=c.get(g,"value"))!==b)return d;d=g.value;return typeof d=="string"?d.replace(q,""):d==null?"":d}}}}),f.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d,e,g=a.selectedIndex,h=[],i=a.options,j=a.type==="select-one";if(g<0)return null;c=j?g:0,d=j?g+1:i.length;for(;c<d;c++){e=i[c];if(e.selected&&(f.support.optDisabled?!e.disabled:e.getAttribute("disabled")===null)&&(!e.parentNode.disabled||!f.nodeName(e.parentNode,"optgroup"))){b=f(e).val();if(j)return b;h.push(b)}}if(j&&!h.length&&i.length)return f(i[g]).val();return h},set:function(a,b){var c=f.makeArray(b);f(a).find("option").each(function(){this.selected=f.inArray(f(this).val(),c)>=0}),c.length||(a.selectedIndex=-1);return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(a,c,d,e){var g,h,i,j=a.nodeType;if(!!a&&j!==3&&j!==8&&j!==2){if(e&&c in f.attrFn)return f(a)[c](d);if(typeof a.getAttribute=="undefined")return f.prop(a,c,d);i=j!==1||!f.isXMLDoc(a),i&&(c=c.toLowerCase(),h=f.attrHooks[c]||(u.test(c)?x:w));if(d!==b){if(d===null){f.removeAttr(a,c);return}if(h&&"set"in h&&i&&(g=h.set(a,d,c))!==b)return g;a.setAttribute(c,""+d);return d}if(h&&"get"in h&&i&&(g=h.get(a,c))!==null)return g;g=a.getAttribute(c);return g===null?b:g}},removeAttr:function(a,b){var c,d,e,g,h=0;if(b&&a.nodeType===1){d=b.toLowerCase().split(p),g=d.length;for(;h<g;h++)e=d[h],e&&(c=f.propFix[e]||e,f.attr(a,e,""),a.removeAttribute(v?e:c),u.test(e)&&c in a&&(a[c]=!1))}},attrHooks:{type:{set:function(a,b){if(r.test(a.nodeName)&&a.parentNode)f.error("type property can't be changed");else if(!f.support.radioValue&&b==="radio"&&f.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b),c&&(a.value=c);return b}}},value:{get:function(a,b){if(w&&f.nodeName(a,"button"))return w.get(a,b);return b in a?a.value:null},set:function(a,b,c){if(w&&f.nodeName(a,"button"))return w.set(a,b,c);a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,g,h,i=a.nodeType;if(!!a&&i!==3&&i!==8&&i!==2){h=i!==1||!f.isXMLDoc(a),h&&(c=f.propFix[c]||c,g=f.propHooks[c]);return d!==b?g&&"set"in g&&(e=g.set(a,d,c))!==b?e:a[c]=d:g&&"get"in g&&(e=g.get(a,c))!==null?e:a[c]}},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):s.test(a.nodeName)||t.test(a.nodeName)&&a.href?0:b}}}}),f.attrHooks.tabindex=f.propHooks.tabIndex,x={get:function(a,c){var d,e=f.prop(a,c);return e===!0||typeof e!="boolean"&&(d=a.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(a,b,c){var d;b===!1?f.removeAttr(a,c):(d=f.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase()));return c}},v||(y={name:!0,id:!0},w=f.valHooks.button={get:function(a,c){var d;d=a.getAttributeNode(c);return d&&(y[c]?d.nodeValue!=="":d.specified)?d.nodeValue:b},set:function(a,b,d){var e=a.getAttributeNode(d);e||(e=c.createAttribute(d),a.setAttributeNode(e));return e.nodeValue=b+""}},f.attrHooks.tabindex.set=w.set,f.each(["width","height"],function(a,b){f.attrHooks[b]=f.extend(f.attrHooks[b],{set:function(a,c){if(c===""){a.setAttribute(b,"auto");return c}}})}),f.attrHooks.contenteditable={get:w.get,set:function(a,b,c){b===""&&(b="false"),w.set(a,b,c)}}),f.support.hrefNormalized||f.each(["href","src","width","height"],function(a,c){f.attrHooks[c]=f.extend(f.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return d===null?b:d}})}),f.support.style||(f.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}}),f.support.optSelected||(f.propHooks.selected=f.extend(f.propHooks.selected,{get:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex);return null}})),f.support.enctype||(f.propFix.enctype="encoding"),f.support.checkOn||f.each(["radio","checkbox"],function(){f.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}}),f.each(["radio","checkbox"],function(){f.valHooks[this]=f.extend(f.valHooks[this],{set:function(a,b){if(f.isArray(b))return a.checked=f.inArray(f(a).val(),b)>=0}})});var z=/^(?:textarea|input|select)$/i,A=/^([^\.]*)?(?:\.(.+))?$/,B=/\bhover(\.\S+)?\b/,C=/^key/,D=/^(?:mouse|contextmenu)|click/,E=/^(?:focusinfocus|focusoutblur)$/,F=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,G=function(a){var b=F.exec(a);b&&(b[1]=(b[1]||"").toLowerCase(),b[3]=b[3]&&new RegExp("(?:^|\\s)"+b[3]+"(?:\\s|$)"));return b},H=function(a,b){var c=a.attributes||{};return(!b[1]||a.nodeName.toLowerCase()===b[1])&&(!b[2]||(c.id||{}).value===b[2])&&(!b[3]||b[3].test((c["class"]||{}).value))},I=function(a){return f.event.special.hover?a:a.replace(B,"mouseenter$1 mouseleave$1")};f.event={add:function(a,c,d,e,g){var h,i,j,k,l,m,n,o,p,q,r,s;if(!(a.nodeType===3||a.nodeType===8||!c||!d||!(h=f._data(a)))){d.handler&&(p=d,d=p.handler),d.guid||(d.guid=f.guid++),j=h.events,j||(h.events=j={}),i=h.handle,i||(h.handle=i=function(a){return typeof f!="undefined"&&(!a||f.event.triggered!==a.type)?f.event.dispatch.apply(i.elem,arguments):b},i.elem=a),c=f.trim(I(c)).split(" ");for(k=0;k<c.length;k++){l=A.exec(c[k])||[],m=l[1],n=(l[2]||"").split(".").sort(),s=f.event.special[m]||{},m=(g?s.delegateType:s.bindType)||m,s=f.event.special[m]||{},o=f.extend({type:m,origType:l[1],data:e,handler:d,guid:d.guid,selector:g,quick:G(g),namespace:n.join(".")},p),r=j[m];if(!r){r=j[m]=[],r.delegateCount=0;if(!s.setup||s.setup.call(a,e,n,i)===!1)a.addEventListener?a.addEventListener(m,i,!1):a.attachEvent&&a.attachEvent("on"+m,i)}s.add&&(s.add.call(a,o),o.handler.guid||(o.handler.guid=d.guid)),g?r.splice(r.delegateCount++,0,o):r.push(o),f.event.global[m]=!0}a=null}},global:{},remove:function(a,b,c,d,e){var g=f.hasData(a)&&f._data(a),h,i,j,k,l,m,n,o,p,q,r,s;if(!!g&&!!(o=g.events)){b=f.trim(I(b||"")).split(" ");for(h=0;h<b.length;h++){i=A.exec(b[h])||[],j=k=i[1],l=i[2];if(!j){for(j in o)f.event.remove(a,j+b[h],c,d,!0);continue}p=f.event.special[j]||{},j=(d?p.delegateType:p.bindType)||j,r=o[j]||[],m=r.length,l=l?new RegExp("(^|\\.)"+l.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;for(n=0;n<r.length;n++)s=r[n],(e||k===s.origType)&&(!c||c.guid===s.guid)&&(!l||l.test(s.namespace))&&(!d||d===s.selector||d==="**"&&s.selector)&&(r.splice(n--,1),s.selector&&r.delegateCount--,p.remove&&p.remove.call(a,s));r.length===0&&m!==r.length&&((!p.teardown||p.teardown.call(a,l)===!1)&&f.removeEvent(a,j,g.handle),delete o[j])}f.isEmptyObject(o)&&(q=g.handle,q&&(q.elem=null),f.removeData(a,["events","handle"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,e,g){if(!e||e.nodeType!==3&&e.nodeType!==8){var h=c.type||c,i=[],j,k,l,m,n,o,p,q,r,s;if(E.test(h+f.event.triggered))return;h.indexOf("!")>=0&&(h=h.slice(0,-1),k=!0),h.indexOf(".")>=0&&(i=h.split("."),h=i.shift(),i.sort());if((!e||f.event.customEvent[h])&&!f.event.global[h])return;c=typeof c=="object"?c[f.expando]?c:new f.Event(h,c):new f.Event(h),c.type=h,c.isTrigger=!0,c.exclusive=k,c.namespace=i.join("."),c.namespace_re=c.namespace?new RegExp("(^|\\.)"+i.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,o=h.indexOf(":")<0?"on"+h:"";if(!e){j=f.cache;for(l in j)j[l].events&&j[l].events[h]&&f.event.trigger(c,d,j[l].handle.elem,!0);return}c.result=b,c.target||(c.target=e),d=d!=null?f.makeArray(d):[],d.unshift(c),p=f.event.special[h]||{};if(p.trigger&&p.trigger.apply(e,d)===!1)return;r=[[e,p.bindType||h]];if(!g&&!p.noBubble&&!f.isWindow(e)){s=p.delegateType||h,m=E.test(s+h)?e:e.parentNode,n=null;for(;m;m=m.parentNode)r.push([m,s]),n=m;n&&n===e.ownerDocument&&r.push([n.defaultView||n.parentWindow||a,s])}for(l=0;l<r.length&&!c.isPropagationStopped();l++)m=r[l][0],c.type=r[l][1],q=(f._data(m,"events")||{})[c.type]&&f._data(m,"handle"),q&&q.apply(m,d),q=o&&m[o],q&&f.acceptData(m)&&q.apply(m,d)===!1&&c.preventDefault();c.type=h,!g&&!c.isDefaultPrevented()&&(!p._default||p._default.apply(e.ownerDocument,d)===!1)&&(h!=="click"||!f.nodeName(e,"a"))&&f.acceptData(e)&&o&&e[h]&&(h!=="focus"&&h!=="blur"||c.target.offsetWidth!==0)&&!f.isWindow(e)&&(n=e[o],n&&(e[o]=null),f.event.triggered=h,e[h](),f.event.triggered=b,n&&(e[o]=n));return c.result}},dispatch:function(c){c=f.event.fix(c||a.event);var d=(f._data(this,"events")||{})[c.type]||[],e=d.delegateCount,g=[].slice.call(arguments,0),h=!c.exclusive&&!c.namespace,i=[],j,k,l,m,n,o,p,q,r,s,t;g[0]=c,c.delegateTarget=this;if(e&&!c.target.disabled&&(!c.button||c.type!=="click")){m=f(this),m.context=this.ownerDocument||this;for(l=c.target;l!=this;l=l.parentNode||this){o={},q=[],m[0]=l;for(j=0;j<e;j++)r=d[j],s=r.selector,o[s]===b&&(o[s]=r.quick?H(l,r.quick):m.is(s)),o[s]&&q.push(r);q.length&&i.push({elem:l,matches:q})}}d.length>e&&i.push({elem:this,matches:d.slice(e)});for(j=0;j<i.length&&!c.isPropagationStopped();j++){p=i[j],c.currentTarget=p.elem;for(k=0;k<p.matches.length&&!c.isImmediatePropagationStopped();k++){r=p.matches[k];if(h||!c.namespace&&!r.namespace||c.namespace_re&&c.namespace_re.test(r.namespace))c.data=r.data,c.handleObj=r,n=((f.event.special[r.origType]||{}).handle||r.handler).apply(p.elem,g),n!==b&&(c.result=n,n===!1&&(c.preventDefault(),c.stopPropagation()))}}return c.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){a.which==null&&(a.which=b.charCode!=null?b.charCode:b.keyCode);return a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,d){var e,f,g,h=d.button,i=d.fromElement;a.pageX==null&&d.clientX!=null&&(e=a.target.ownerDocument||c,f=e.documentElement,g=e.body,a.pageX=d.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),a.pageY=d.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)),!a.relatedTarget&&i&&(a.relatedTarget=i===a.target?d.toElement:i),!a.which&&h!==b&&(a.which=h&1?1:h&2?3:h&4?2:0);return a}},fix:function(a){if(a[f.expando])return a;var d,e,g=a,h=f.event.fixHooks[a.type]||{},i=h.props?this.props.concat(h.props):this.props;a=f.Event(g);for(d=i.length;d;)e=i[--d],a[e]=g[e];a.target||(a.target=g.srcElement||c),a.target.nodeType===3&&(a.target=a.target.parentNode),a.metaKey===b&&(a.metaKey=a.ctrlKey);return h.filter?h.filter(a,g):a},special:{ready:{setup:f.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){f.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}},simulate:function(a,b,c,d){var e=f.extend(new f.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?f.event.trigger(e,null,b):f.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},f.event.handle=f.event.dispatch,f.removeEvent=c.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)},f.Event=function(a,b){if(!(this instanceof f.Event))return new f.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?K:J):this.type=a,b&&f.extend(this,b),this.timeStamp=a&&a.timeStamp||f.now(),this[f.expando]=!0},f.Event.prototype={preventDefault:function(){this.isDefaultPrevented=K;var a=this.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=K;var a=this.originalEvent;!a||(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=K,this.stopPropagation()},isDefaultPrevented:J,isPropagationStopped:J,isImmediatePropagationStopped:J},f.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){f.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c=this,d=a.relatedTarget,e=a.handleObj,g=e.selector,h;if(!d||d!==c&&!f.contains(c,d))a.type=e.origType,h=e.handler.apply(this,arguments),a.type=b;return h}}}),f.support.submitBubbles||(f.event.special.submit={setup:function(){if(f.nodeName(this,"form"))return!1;f.event.add(this,"click._submit keypress._submit",function(a){var c=a.target,d=f.nodeName(c,"input")||f.nodeName(c,"button")?c.form:b;d&&!d._submit_attached&&(f.event.add(d,"submit._submit",function(a){this.parentNode&&!a.isTrigger&&f.event.simulate("submit",this.parentNode,a,!0)}),d._submit_attached=!0)})},teardown:function(){if(f.nodeName(this,"form"))return!1;f.event.remove(this,"._submit")}}),f.support.changeBubbles||(f.event.special.change={setup:function(){if(z.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")f.event.add(this,"propertychange._change",function(a){a.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),f.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1,f.event.simulate("change",this,a,!0))});return!1}f.event.add(this,"beforeactivate._change",function(a){var b=a.target;z.test(b.nodeName)&&!b._change_attached&&(f.event.add(b,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&f.event.simulate("change",this.parentNode,a,!0)}),b._change_attached=!0)})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||b.type!=="radio"&&b.type!=="checkbox")return a.handleObj.handler.apply(this,arguments)},teardown:function(){f.event.remove(this,"._change");return z.test(this.nodeName)}}),f.support.focusinBubbles||f.each({focus:"focusin",blur:"focusout"},function(a,b){var d=0,e=function(a){f.event.simulate(b,a.target,f.event.fix(a),!0)};f.event.special[b]={setup:function(){d++===0&&c.addEventListener(a,e,!0)},teardown:function(){--d===0&&c.removeEventListener(a,e,!0)}}}),f.fn.extend({on:function(a,c,d,e,g){var h,i;if(typeof a=="object"){typeof c!="string"&&(d=c,c=b);for(i in a)this.on(i,c,d,a[i],g);return this}d==null&&e==null?(e=c,d=c=b):e==null&&(typeof c=="string"?(e=d,d=b):(e=d,d=c,c=b));if(e===!1)e=J;else if(!e)return this;g===1&&(h=e,e=function(a){f().off(a);return h.apply(this,arguments)},e.guid=h.guid||(h.guid=f.guid++));return this.each(function(){f.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on.call(this,a,b,c,d,1)},off:function(a,c,d){if(a&&a.preventDefault&&a.handleObj){var e=a.handleObj;f(a.delegateTarget).off(e.namespace?e.type+"."+e.namespace:e.type,e.selector,e.handler);return this}if(typeof a=="object"){for(var g in a)this.off(g,c,a[g]);return this}if(c===!1||typeof c=="function")d=c,c=b;d===!1&&(d=J);return this.each(function(){f.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){f(this.context).on(a,this.selector,b,c);return this},die:function(a,b){f(this.context).off(a,this.selector||"**",b);return this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return arguments.length==1?this.off(a,"**"):this.off(b,a,c)},trigger:function(a,b){return this.each(function(){f.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return f.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||f.guid++,d=0,e=function(c){var e=(f._data(this,"lastToggle"+a.guid)||0)%d;f._data(this,"lastToggle"+a.guid,e+1),c.preventDefault();return b[e].apply(this,arguments)||!1};e.guid=c;while(d<b.length)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){f.fn[b]=function(a,c){c==null&&(c=a,a=null);return arguments.length>0?this.on(b,null,a,c):this.trigger(b)},f.attrFn&&(f.attrFn[b]=!0),C.test(b)&&(f.event.fixHooks[b]=f.event.keyHooks),D.test(b)&&(f.event.fixHooks[b]=f.event.mouseHooks)}),function(){function x(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}if(j.nodeType===1){g||(j[d]=c,j.sizset=h);if(typeof b!="string"){if(j===b){k=!0;break}}else if(m.filter(b,[j]).length>0){k=j;break}}j=j[a]}e[h]=k}}}function w(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}j.nodeType===1&&!g&&(j[d]=c,j.sizset=h);if(j.nodeName.toLowerCase()===b){k=j;break}j=j[a]}e[h]=k}}}var a=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,d="sizcache"+(Math.random()+"").replace(".",""),e=0,g=Object.prototype.toString,h=!1,i=!0,j=/\\/g,k=/\r\n/g,l=/\W/;[0,0].sort(function(){i=!1;return 0});var m=function(b,d,e,f){e=e||[],d=d||c;var h=d;if(d.nodeType!==1&&d.nodeType!==9)return[];if(!b||typeof b!="string")return e;var i,j,k,l,n,q,r,t,u=!0,v=m.isXML(d),w=[],x=b;do{a.exec(""),i=a.exec(x);if(i){x=i[3],w.push(i[1]);if(i[2]){l=i[3];break}}}while(i);if(w.length>1&&p.exec(b))if(w.length===2&&o.relative[w[0]])j=y(w[0]+w[1],d,f);else{j=o.relative[w[0]]?[d]:m(w.shift(),d);while(w.length)b=w.shift(),o.relative[b]&&(b+=w.shift()),j=y(b,j,f)}else{!f&&w.length>1&&d.nodeType===9&&!v&&o.match.ID.test(w[0])&&!o.match.ID.test(w[w.length-1])&&(n=m.find(w.shift(),d,v),d=n.expr?m.filter(n.expr,n.set)[0]:n.set[0]);if(d){n=f?{expr:w.pop(),set:s(f)}:m.find(w.pop(),w.length===1&&(w[0]==="~"||w[0]==="+")&&d.parentNode?d.parentNode:d,v),j=n.expr?m.filter(n.expr,n.set):n.set,w.length>0?k=s(j):u=!1;while(w.length)q=w.pop(),r=q,o.relative[q]?r=w.pop():q="",r==null&&(r=d),o.relative[q](k,r,v)}else k=w=[]}k||(k=j),k||m.error(q||b);if(g.call(k)==="[object Array]")if(!u)e.push.apply(e,k);else if(d&&d.nodeType===1)for(t=0;k[t]!=null;t++)k[t]&&(k[t]===!0||k[t].nodeType===1&&m.contains(d,k[t]))&&e.push(j[t]);else for(t=0;k[t]!=null;t++)k[t]&&k[t].nodeType===1&&e.push(j[t]);else s(k,e);l&&(m(l,h,e,f),m.uniqueSort(e));return e};m.uniqueSort=function(a){if(u){h=i,a.sort(u);if(h)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}return a},m.matches=function(a,b){return m(a,null,null,b)},m.matchesSelector=function(a,b){return m(b,null,null,[a]).length>0},m.find=function(a,b,c){var d,e,f,g,h,i;if(!a)return[];for(e=0,f=o.order.length;e<f;e++){h=o.order[e];if(g=o.leftMatch[h].exec(a)){i=g[1],g.splice(1,1);if(i.substr(i.length-1)!=="\\"){g[1]=(g[1]||"").replace(j,""),d=o.find[h](g,b,c);if(d!=null){a=a.replace(o.match[h],"");break}}}}d||(d=typeof b.getElementsByTagName!="undefined"?b.getElementsByTagName("*"):[]);return{set:d,expr:a}},m.filter=function(a,c,d,e){var f,g,h,i,j,k,l,n,p,q=a,r=[],s=c,t=c&&c[0]&&m.isXML(c[0]);while(a&&c.length){for(h in o.filter)if((f=o.leftMatch[h].exec(a))!=null&&f[2]){k=o.filter[h],l=f[1],g=!1,f.splice(1,1);if(l.substr(l.length-1)==="\\")continue;s===r&&(r=[]);if(o.preFilter[h]){f=o.preFilter[h](f,s,d,r,e,t);if(!f)g=i=!0;else if(f===!0)continue}if(f)for(n=0;(j=s[n])!=null;n++)j&&(i=k(j,f,n,s),p=e^i,d&&i!=null?p?g=!0:s[n]=!1:p&&(r.push(j),g=!0));if(i!==b){d||(s=r),a=a.replace(o.match[h],"");if(!g)return[];break}}if(a===q)if(g==null)m.error(a);else break;q=a}return s},m.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)};var n=m.getText=function(a){var b,c,d=a.nodeType,e="";if(d){if(d===1||d===9){if(typeof a.textContent=="string")return a.textContent;if(typeof a.innerText=="string")return a.innerText.replace(k,"");for(a=a.firstChild;a;a=a.nextSibling)e+=n(a)}else if(d===3||d===4)return a.nodeValue}else for(b=0;c=a[b];b++)c.nodeType!==8&&(e+=n(c));return e},o=m.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b=="string",d=c&&!l.test(b),e=c&&!d;d&&(b=b.toLowerCase());for(var f=0,g=a.length,h;f<g;f++)if(h=a[f]){while((h=h.previousSibling)&&h.nodeType!==1);a[f]=e||h&&h.nodeName.toLowerCase()===b?h||!1:h===b}e&&m.filter(b,a,!0)},">":function(a,b){var c,d=typeof b=="string",e=0,f=a.length;if(d&&!l.test(b)){b=b.toLowerCase();for(;e<f;e++){c=a[e];if(c){var g=c.parentNode;a[e]=g.nodeName.toLowerCase()===b?g:!1}}}else{for(;e<f;e++)c=a[e],c&&(a[e]=d?c.parentNode:c.parentNode===b);d&&m.filter(b,a,!0)}},"":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("parentNode",b,f,a,d,c)},"~":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("previousSibling",b,f,a,d,c)}},find:{ID:function(a,b,c){if(typeof b.getElementById!="undefined"&&!c){var d=b.getElementById(a[1]);return d&&d.parentNode?[d]:[]}},NAME:function(a,b){if(typeof b.getElementsByName!="undefined"){var c=[],d=b.getElementsByName(a[1]);for(var e=0,f=d.length;e<f;e++)d[e].getAttribute("name")===a[1]&&c.push(d[e]);return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!="undefined")return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,f){a=" "+a[1].replace(j,"")+" ";if(f)return a;for(var g=0,h;(h=b[g])!=null;g++)h&&(e^(h.className&&(" "+h.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(h):c&&(b[g]=!1));return!1},ID:function(a){return a[1].replace(j,"")},TAG:function(a,b){return a[1].replace(j,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||m.error(a[0]),a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0,a[3]=b[3]-0}else a[2]&&m.error(a[0]);a[0]=e++;return a},ATTR:function(a,b,c,d,e,f){var g=a[1]=a[1].replace(j,"");!f&&o.attrMap[g]&&(a[1]=o.attrMap[g]),a[4]=(a[4]||a[5]||"").replace(j,""),a[2]==="~="&&(a[4]=" "+a[4]+" ");return a},PSEUDO:function(b,c,d,e,f){if(b[1]==="not")if((a.exec(b[3])||"").length>1||/^\w/.test(b[3]))b[3]=m(b[3],null,null,c);else{var g=m.filter(b[3],c,d,!0^f);d||e.push.apply(e,g);return!1}else if(o.match.POS.test(b[0])||o.match.CHILD.test(b[0]))return!0;return b},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!m(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()==="input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=o.filters[e];if(f)return f(a,c,b,d);if(e==="contains")return(a.textContent||a.innerText||n([a])||"").indexOf(b[3])>=0;if(e==="not"){var g=b[3];for(var h=0,i=g.length;h<i;h++)if(g[h]===a)return!1;return!0}m.error(e)},CHILD:function(a,b){var c,e,f,g,h,i,j,k=b[1],l=a;switch(k){case"only":case"first":while(l=l.previousSibling)if(l.nodeType===1)return!1;if(k==="first")return!0;l=a;case"last":while(l=l.nextSibling)if(l.nodeType===1)return!1;return!0;case"nth":c=b[2],e=b[3];if(c===1&&e===0)return!0;f=b[0],g=a.parentNode;if(g&&(g[d]!==f||!a.nodeIndex)){i=0;for(l=g.firstChild;l;l=l.nextSibling)l.nodeType===1&&(l.nodeIndex=++i);g[d]=f}j=a.nodeIndex-e;return c===0?j===0:j%c===0&&j/c>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||!!a.nodeName&&a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],d=m.attr?m.attr(a,c):o.attrHandle[c]?o.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),e=d+"",f=b[2],g=b[4];return d==null?f==="!=":!f&&m.attr?d!=null:f==="="?e===g:f==="*="?e.indexOf(g)>=0:f==="~="?(" "+e+" ").indexOf(g)>=0:g?f==="!="?e!==g:f==="^="?e.indexOf(g)===0:f==="$="?e.substr(e.length-g.length)===g:f==="|="?e===g||e.substr(0,g.length+1)===g+"-":!1:e&&d!==!1},POS:function(a,b,c,d){var e=b[2],f=o.setFilters[e];if(f)return f(a,c,b,d)}}},p=o.match.POS,q=function(a,b){return"\\"+(b-0+1)};for(var r in o.match)o.match[r]=new RegExp(o.match[r].source+/(?![^\[]*\])(?![^\(]*\))/.source),o.leftMatch[r]=new RegExp(/(^(?:.|\r|\n)*?)/.source+o.match[r].source.replace(/\\(\d+)/g,q));var s=function(a,b){a=Array.prototype.slice.call(a,0);if(b){b.push.apply(b,a);return b}return a};try{Array.prototype.slice.call(c.documentElement.childNodes,0)[0].nodeType}catch(t){s=function(a,b){var c=0,d=b||[];if(g.call(a)==="[object Array]")Array.prototype.push.apply(d,a);else if(typeof a.length=="number")for(var e=a.length;c<e;c++)d.push(a[c]);else for(;a[c];c++)d.push(a[c]);return d}}var u,v;c.documentElement.compareDocumentPosition?u=function(a,b){if(a===b){h=!0;return 0}if(!a.compareDocumentPosition||!b.compareDocumentPosition)return a.compareDocumentPosition?-1:1;return a.compareDocumentPosition(b)&4?-1:1}:(u=function(a,b){if(a===b){h=!0;return 0}if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[],g=a.parentNode,i=b.parentNode,j=g;if(g===i)return v(a,b);if(!g)return-1;if(!i)return 1;while(j)e.unshift(j),j=j.parentNode;j=i;while(j)f.unshift(j),j=j.parentNode;c=e.length,d=f.length;for(var k=0;k<c&&k<d;k++)if(e[k]!==f[k])return v(e[k],f[k]);return k===c?v(a,f[k],-1):v(e[k],b,1)},v=function(a,b,c){if(a===b)return c;var d=a.nextSibling;while(d){if(d===b)return-1;d=d.nextSibling}return 1}),function(){var a=c.createElement("div"),d="script"+(new Date).getTime(),e=c.documentElement;a.innerHTML="<a name='"+d+"'/>",e.insertBefore(a,e.firstChild),c.getElementById(d)&&(o.find.ID=function(a,c,d){if(typeof c.getElementById!="undefined"&&!d){var e=c.getElementById(a[1]);return e?e.id===a[1]||typeof e.getAttributeNode!="undefined"&&e.getAttributeNode("id").nodeValue===a[1]?[e]:b:[]}},o.filter.ID=function(a,b){var c=typeof a.getAttributeNode!="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b}),e.removeChild(a),e=a=null}(),function(){var a=c.createElement("div");a.appendChild(c.createComment("")),a.getElementsByTagName("*").length>0&&(o.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){var d=[];for(var e=0;c[e];e++)c[e].nodeType===1&&d.push(c[e]);c=d}return c}),a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!="undefined"&&a.firstChild.getAttribute("href")!=="#"&&(o.attrHandle.href=function(a){return a.getAttribute("href",2)}),a=null}(),c.querySelectorAll&&function(){var a=m,b=c.createElement("div"),d="__sizzle__";b.innerHTML="<p class='TEST'></p>";if(!b.querySelectorAll||b.querySelectorAll(".TEST").length!==0){m=function(b,e,f,g){e=e||c;if(!g&&!m.isXML(e)){var h=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(h&&(e.nodeType===1||e.nodeType===9)){if(h[1])return s(e.getElementsByTagName(b),f);if(h[2]&&o.find.CLASS&&e.getElementsByClassName)return s(e.getElementsByClassName(h[2]),f)}if(e.nodeType===9){if(b==="body"&&e.body)return s([e.body],f);if(h&&h[3]){var i=e.getElementById(h[3]);if(!i||!i.parentNode)return s([],f);if(i.id===h[3])return s([i],f)}try{return s(e.querySelectorAll(b),f)}catch(j){}}else if(e.nodeType===1&&e.nodeName.toLowerCase()!=="object"){var k=e,l=e.getAttribute("id"),n=l||d,p=e.parentNode,q=/^\s*[+~]/.test(b);l?n=n.replace(/'/g,"\\$&"):e.setAttribute("id",n),q&&p&&(e=e.parentNode);try{if(!q||p)return s(e.querySelectorAll("[id='"+n+"'] "+b),f)}catch(r){}finally{l||k.removeAttribute("id")}}}return a(b,e,f,g)};for(var e in a)m[e]=a[e];b=null}}(),function(){var a=c.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var d=!b.call(c.createElement("div"),"div"),e=!1;try{b.call(c.documentElement,"[test!='']:sizzle")}catch(f){e=!0}m.matchesSelector=function(a,c){c=c.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!m.isXML(a))try{if(e||!o.match.PSEUDO.test(c)&&!/!=/.test(c)){var f=b.call(a,c);if(f||!d||a.document&&a.document.nodeType!==11)return f}}catch(g){}return m(c,null,null,[a]).length>0}}}(),function(){var a=c.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(!!a.getElementsByClassName&&a.getElementsByClassName("e").length!==0){a.lastChild.className="e";if(a.getElementsByClassName("e").length===1)return;o.order.splice(1,0,"CLASS"),o.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!="undefined"&&!c)return b.getElementsByClassName(a[1])},a=null}}(),c.documentElement.contains?m.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:c.documentElement.compareDocumentPosition?m.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16)}:m.contains=function(){return!1},m.isXML=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":!1};var y=function(a,b,c){var d,e=[],f="",g=b.nodeType?[b]:b;while(d=o.match.PSEUDO.exec(a))f+=d[0],a=a.replace(o.match.PSEUDO,"");a=o.relative[a]?a+"*":a;for(var h=0,i=g.length;h<i;h++)m(a,g[h],e,c);return m.filter(f,e)};m.attr=f.attr,m.selectors.attrMap={},f.find=m,f.expr=m.selectors,f.expr[":"]=f.expr.filters,f.unique=m.uniqueSort,f.text=m.getText,f.isXMLDoc=m.isXML,f.contains=m.contains}();var L=/Until$/,M=/^(?:parents|prevUntil|prevAll)/,N=/,/,O=/^.[^:#\[\.,]*$/,P=Array.prototype.slice,Q=f.expr.match.POS,R={children:!0,contents:!0,next:!0,prev:!0};f.fn.extend({find:function(a){var b=this,c,d;if(typeof a!="string")return f(a).filter(function(){for(c=0,d=b.length;c<d;c++)if(f.contains(b[c],this))return!0});var e=this.pushStack("","find",a),g,h,i;for(c=0,d=this.length;c<d;c++){g=e.length,f.find(a,this[c],e);if(c>0)for(h=g;h<e.length;h++)for(i=0;i<g;i++)if(e[i]===e[h]){e.splice(h--,1);break}}return e},has:function(a){var b=f(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++)if(f.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(T(this,a,!1),"not",a)},filter:function(a){return this.pushStack(T(this,a,!0),"filter",a)},is:function(a){return!!a&&(typeof a=="string"?Q.test(a)?f(a,this.context).index(this[0])>=0:f.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c=[],d,e,g=this[0];if(f.isArray(a)){var h=1;while(g&&g.ownerDocument&&g!==b){for(d=0;d<a.length;d++)f(g).is(a[d])&&c.push({selector:a[d],elem:g,level:h});g=g.parentNode,h++}return c}var i=Q.test(a)||typeof a!="string"?f(a,b||this.context):0;for(d=0,e=this.length;d<e;d++){g=this[d];while(g){if(i?i.index(g)>-1:f.find.matchesSelector(g,a)){c.push(g);break}g=g.parentNode;if(!g||!g.ownerDocument||g===b||g.nodeType===11)break}}c=c.length>1?f.unique(c):c;return this.pushStack(c,"closest",a)},index:function(a){if(!a)return this[0]&&this[0].parentNode?this.prevAll().length:-1;if(typeof a=="string")return f.inArray(this[0],f(a));return f.inArray(a.jsynchat?a[0]:a,this)},add:function(a,b){var c=typeof a=="string"?f(a,b):f.makeArray(a&&a.nodeType?[a]:a),d=f.merge(this.get(),c);return this.pushStack(S(c[0])||S(d[0])?d:f.unique(d))},andSelf:function(){return this.add(this.prevObject)}}),f.each({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return f.dir(a,"parentNode")},parentsUntil:function(a,b,c){return f.dir(a,"parentNode",c)},next:function(a){return f.nth(a,2,"nextSibling")},prev:function(a){return f.nth(a,2,"previousSibling")},nextAll:function(a){return f.dir(a,"nextSibling")},prevAll:function(a){return f.dir(a,"previousSibling")},nextUntil:function(a,b,c){return f.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return f.dir(a,"previousSibling",c)},siblings:function(a){return f.sibling(a.parentNode.firstChild,a)},children:function(a){return f.sibling(a.firstChild)},contents:function(a){return f.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:f.makeArray(a.childNodes)}},function(a,b){f.fn[a]=function(c,d){var e=f.map(this,b,c);L.test(a)||(d=c),d&&typeof d=="string"&&(e=f.filter(d,e)),e=this.length>1&&!R[a]?f.unique(e):e,(this.length>1||N.test(d))&&M.test(a)&&(e=e.reverse());return this.pushStack(e,a,P.call(arguments).join(","))}}),f.extend({filter:function(a,b,c){c&&(a=":not("+a+")");return b.length===1?f.find.matchesSelector(b[0],a)?[b[0]]:[]:f.find.matches(a,b)},dir:function(a,c,d){var e=[],g=a[c];while(g&&g.nodeType!==9&&(d===b||g.nodeType!==1||!f(g).is(d)))g.nodeType===1&&e.push(g),g=g[c];return e},nth:function(a,b,c,d){b=b||1;var e=0;for(;a;a=a[c])if(a.nodeType===1&&++e===b)break;return a},sibling:function(a,b){var c=[];for(;a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var V="abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",W=/ jsynchat\d+="(?:\d+|null)"/g,X=/^\s+/,Y=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,Z=/<([\w:]+)/,$=/<tbody/i,_=/<|&#?\w+;/,ba=/<(?:script|style)/i,bb=/<(?:script|object|embed|option|style)/i,bc=new RegExp("<(?:"+V+")","i"),bd=/checked\s*(?:[^=]|=\s*.checked.)/i,be=/\/(java|ecma)script/i,bf=/^\s*<!(?:\[CDATA\[|\-\-)/,bg={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},bh=U(c);bg.optgroup=bg.option,bg.tbody=bg.tfoot=bg.colgroup=bg.caption=bg.thead,bg.th=bg.td,f.support.htmlSerialize||(bg._default=[1,"div<div>","</div>"]),f.fn.extend({text:function(a){if(f.isFunction(a))return this.each(function(b){var c=f(this);c.text(a.call(this,b,c.text()))});if(typeof a!="object"&&a!==b)return this.empty().append((this[0]&&this[0].ownerDocument||c).createTextNode(a));return f.text(this)},wrapAll:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapAll(a.call(this,b))});if(this[0]){var b=f(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&a.firstChild.nodeType===1)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapInner(a.call(this,b))});return this.each(function(){var b=f(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=f.isFunction(a);return this.each(function(c){f(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){f.nodeName(this,"body")||f(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=f.clean(arguments);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,f.clean(arguments));return a}},remove:function(a,b){for(var c=0,d;(d=this[c])!=null;c++)if(!a||f.filter(a,[d]).length)!b&&d.nodeType===1&&(f.cleanData(d.getElementsByTagName("*")),f.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d);return this},empty:function()
{for(var a=0,b;(b=this[a])!=null;a++){b.nodeType===1&&f.cleanData(b.getElementsByTagName("*"));while(b.firstChild)b.removeChild(b.firstChild)}return this},clone:function(a,b){a=a==null?!1:a,b=b==null?a:b;return this.map(function(){return f.clone(this,a,b)})},html:function(a){if(a===b)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(W,""):null;if(typeof a=="string"&&!ba.test(a)&&(f.support.leadingWhitespace||!X.test(a))&&!bg[(Z.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Y,"<$1></$2>");try{for(var c=0,d=this.length;c<d;c++)this[c].nodeType===1&&(f.cleanData(this[c].getElementsByTagName("*")),this[c].innerHTML=a)}catch(e){this.empty().append(a)}}else f.isFunction(a)?this.each(function(b){var c=f(this);c.html(a.call(this,b,c.html()))}):this.empty().append(a);return this},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(f.isFunction(a))return this.each(function(b){var c=f(this),d=c.html();c.replaceWith(a.call(this,b,d))});typeof a!="string"&&(a=f(a).detach());return this.each(function(){var b=this.nextSibling,c=this.parentNode;f(this).remove(),b?f(b).before(a):f(c).append(a)})}return this.length?this.pushStack(f(f.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){var e,g,h,i,j=a[0],k=[];if(!f.support.checkClone&&arguments.length===3&&typeof j=="string"&&bd.test(j))return this.each(function(){f(this).domManip(a,c,d,!0)});if(f.isFunction(j))return this.each(function(e){var g=f(this);a[0]=j.call(this,e,c?g.html():b),g.domManip(a,c,d)});if(this[0]){i=j&&j.parentNode,f.support.parentNode&&i&&i.nodeType===11&&i.childNodes.length===this.length?e={fragment:i}:e=f.buildFragment(a,this,k),h=e.fragment,h.childNodes.length===1?g=h=h.firstChild:g=h.firstChild;if(g){c=c&&f.nodeName(g,"tr");for(var l=0,m=this.length,n=m-1;l<m;l++)d.call(c?bi(this[l],g):this[l],e.cacheable||m>1&&l<n?f.clone(h,!0,!0):h)}k.length&&f.each(k,bp)}return this}}),f.buildFragment=function(a,b,d){var e,g,h,i,j=a[0];b&&b[0]&&(i=b[0].ownerDocument||b[0]),i.createDocumentFragment||(i=c),a.length===1&&typeof j=="string"&&j.length<512&&i===c&&j.charAt(0)==="<"&&!bb.test(j)&&(f.support.checkClone||!bd.test(j))&&(f.support.html5Clone||!bc.test(j))&&(g=!0,h=f.fragments[j],h&&h!==1&&(e=h)),e||(e=i.createDocumentFragment(),f.clean(a,i,e,d)),g&&(f.fragments[j]=h?e:1);return{fragment:e,cacheable:g}},f.fragments={},f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){f.fn[a]=function(c){var d=[],e=f(c),g=this.length===1&&this[0].parentNode;if(g&&g.nodeType===11&&g.childNodes.length===1&&e.length===1){e[b](this[0]);return this}for(var h=0,i=e.length;h<i;h++){var j=(h>0?this.clone(!0):this).get();f(e[h])[b](j),d=d.concat(j)}return this.pushStack(d,a,e.selector)}}),f.extend({clone:function(a,b,c){var d,e,g,h=f.support.html5Clone||!bc.test("<"+a.nodeName)?a.cloneNode(!0):bo(a);if((!f.support.noCloneEvent||!f.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!f.isXMLDoc(a)){bk(a,h),d=bl(a),e=bl(h);for(g=0;d[g];++g)e[g]&&bk(d[g],e[g])}if(b){bj(a,h);if(c){d=bl(a),e=bl(h);for(g=0;d[g];++g)bj(d[g],e[g])}}d=e=null;return h},clean:function(a,b,d,e){var g;b=b||c,typeof b.createElement=="undefined"&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||c);var h=[],i;for(var j=0,k;(k=a[j])!=null;j++){typeof k=="number"&&(k+="");if(!k)continue;if(typeof k=="string")if(!_.test(k))k=b.createTextNode(k);else{k=k.replace(Y,"<$1></$2>");var l=(Z.exec(k)||["",""])[1].toLowerCase(),m=bg[l]||bg._default,n=m[0],o=b.createElement("div");b===c?bh.appendChild(o):U(b).appendChild(o),o.innerHTML=m[1]+k+m[2];while(n--)o=o.lastChild;if(!f.support.tbody){var p=$.test(k),q=l==="table"&&!p?o.firstChild&&o.firstChild.childNodes:m[1]==="<table>"&&!p?o.childNodes:[];for(i=q.length-1;i>=0;--i)f.nodeName(q[i],"tbody")&&!q[i].childNodes.length&&q[i].parentNode.removeChild(q[i])}!f.support.leadingWhitespace&&X.test(k)&&o.insertBefore(b.createTextNode(X.exec(k)[0]),o.firstChild),k=o.childNodes}var r;if(!f.support.appendChecked)if(k[0]&&typeof(r=k.length)=="number")for(i=0;i<r;i++)bn(k[i]);else bn(k);k.nodeType?h.push(k):h=f.merge(h,k)}if(d){g=function(a){return!a.type||be.test(a.type)};for(j=0;h[j];j++)if(e&&f.nodeName(h[j],"script")&&(!h[j].type||h[j].type.toLowerCase()==="text/javascript"))e.push(h[j].parentNode?h[j].parentNode.removeChild(h[j]):h[j]);else{if(h[j].nodeType===1){var s=f.grep(h[j].getElementsByTagName("script"),g);h.splice.apply(h,[j+1,0].concat(s))}d.appendChild(h[j])}}return h},cleanData:function(a){var b,c,d=f.cache,e=f.event.special,g=f.support.deleteExpando;for(var h=0,i;(i=a[h])!=null;h++){if(i.nodeName&&f.noData[i.nodeName.toLowerCase()])continue;c=i[f.expando];if(c){b=d[c];if(b&&b.events){for(var j in b.events)e[j]?f.event.remove(i,j):f.removeEvent(i,j,b.handle);b.handle&&(b.handle.elem=null)}g?delete i[f.expando]:i.removeAttribute&&i.removeAttribute(f.expando),delete d[c]}}}});var bq=/alpha\([^)]*\)/i,br=/opacity=([^)]*)/,bs=/([A-Z]|^ms)/g,bt=/^-?\d+(?:px)?$/i,bu=/^-?\d/,bv=/^([\-+])=([\-+.\de]+)/,bw={position:"absolute",visibility:"hidden",display:"block"},bx=["Left","Right"],by=["Top","Bottom"],bz,bA,bB;f.fn.css=function(a,c){if(arguments.length===2&&c===b)return this;return f.access(this,a,c,!0,function(a,c,d){return d!==b?f.style(a,c,d):f.css(a,c)})},f.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=bz(a,"opacity","opacity");return c===""?"1":c}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":f.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(!!a&&a.nodeType!==3&&a.nodeType!==8&&!!a.style){var g,h,i=f.camelCase(c),j=a.style,k=f.cssHooks[i];c=f.cssProps[i]||i;if(d===b){if(k&&"get"in k&&(g=k.get(a,!1,e))!==b)return g;return j[c]}h=typeof d,h==="string"&&(g=bv.exec(d))&&(d=+(g[1]+1)*+g[2]+parseFloat(f.css(a,c)),h="number");if(d==null||h==="number"&&isNaN(d))return;h==="number"&&!f.cssNumber[i]&&(d+="px");if(!k||!("set"in k)||(d=k.set(a,d))!==b)try{j[c]=d}catch(l){}}},css:function(a,c,d){var e,g;c=f.camelCase(c),g=f.cssHooks[c],c=f.cssProps[c]||c,c==="cssFloat"&&(c="float");if(g&&"get"in g&&(e=g.get(a,!0,d))!==b)return e;if(bz)return bz(a,c)},swap:function(a,b,c){var d={};for(var e in b)d[e]=a.style[e],a.style[e]=b[e];c.call(a);for(e in b)a.style[e]=d[e]}}),f.curCSS=f.css,f.each(["height","width"],function(a,b){f.cssHooks[b]={get:function(a,c,d){var e;if(c){if(a.offsetWidth!==0)return bC(a,b,d);f.swap(a,bw,function(){e=bC(a,b,d)});return e}},set:function(a,b){if(!bt.test(b))return b;b=parseFloat(b);if(b>=0)return b+"px"}}}),f.support.opacity||(f.cssHooks.opacity={get:function(a,b){return br.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=f.isNumeric(b)?"alpha(opacity="+b*100+")":"",g=d&&d.filter||c.filter||"";c.zoom=1;if(b>=1&&f.trim(g.replace(bq,""))===""){c.removeAttribute("filter");if(d&&!d.filter)return}c.filter=bq.test(g)?g.replace(bq,e):g+" "+e}}),f(function(){f.support.reliableMarginRight||(f.cssHooks.marginRight={get:function(a,b){var c;f.swap(a,{display:"inline-block"},function(){b?c=bz(a,"margin-right","marginRight"):c=a.style.marginRight});return c}})}),c.defaultView&&c.defaultView.getComputedStyle&&(bA=function(a,b){var c,d,e;b=b.replace(bs,"-$1").toLowerCase(),(d=a.ownerDocument.defaultView)&&(e=d.getComputedStyle(a,null))&&(c=e.getPropertyValue(b),c===""&&!f.contains(a.ownerDocument.documentElement,a)&&(c=f.style(a,b)));return c}),c.documentElement.currentStyle&&(bB=function(a,b){var c,d,e,f=a.currentStyle&&a.currentStyle[b],g=a.style;f===null&&g&&(e=g[b])&&(f=e),!bt.test(f)&&bu.test(f)&&(c=g.left,d=a.runtimeStyle&&a.runtimeStyle.left,d&&(a.runtimeStyle.left=a.currentStyle.left),g.left=b==="fontSize"?"1em":f||0,f=g.pixelLeft+"px",g.left=c,d&&(a.runtimeStyle.left=d));return f===""?"auto":f}),bz=bA||bB,f.expr&&f.expr.filters&&(f.expr.filters.hidden=function(a){var b=a.offsetWidth,c=a.offsetHeight;return b===0&&c===0||!f.support.reliableHiddenOffsets&&(a.style&&a.style.display||f.css(a,"display"))==="none"},f.expr.filters.visible=function(a){return!f.expr.filters.hidden(a)});var bD=/%20/g,bE=/\[\]$/,bF=/\r?\n/g,bG=/#.*$/,bH=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,bI=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,bJ=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,bK=/^(?:GET|HEAD)$/,bL=/^\/\//,bM=/\?/,bN=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bO=/^(?:select|textarea)/i,bP=/\s+/,bQ=/([?&])_=[^&]*/,bR=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,bS=f.fn.load,bT={},bU={},bV,bW,bX=["*/"]+["*"];try{bV=e.href}catch(bY){bV=c.createElement("a"),bV.href="",bV=bV.href}bW=bR.exec(bV.toLowerCase())||[],f.fn.extend({load:function(a,c,d){if(typeof a!="string"&&bS)return bS.apply(this,arguments);if(!this.length)return this;var e=a.indexOf(" ");if(e>=0){var g=a.slice(e,a.length);a=a.slice(0,e)}var h="GET";c&&(f.isFunction(c)?(d=c,c=b):typeof c=="object"&&(c=f.param(c,f.ajaxSettings.traditional),h="POST"));var i=this;f.ajax({url:a,type:h,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText,a.isResolved()&&(a.done(function(a){c=a}),i.html(g?f("<div>").append(c.replace(bN,"")).find(g):c)),d&&i.each(d,[c,b,a])}});return this},serialize:function(){return f.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?f.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||bO.test(this.nodeName)||bI.test(this.type))}).map(function(a,b){var c=f(this).val();return c==null?null:f.isArray(c)?f.map(c,function(a,c){return{name:b.name,value:a.replace(bF,"\r\n")}}):{name:b.name,value:c.replace(bF,"\r\n")}}).get()}}),f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){f.fn[b]=function(a){return this.on(b,a)}}),f.each(["get","post"],function(a,c){f[c]=function(a,d,e,g){f.isFunction(d)&&(g=g||e,e=d,d=b);return f.ajax({type:c,url:a,data:d,success:e,dataType:g})}}),f.extend({getScript:function(a,c){return f.get(a,b,c,"script")},getJSON:function(a,b,c){return f.get(a,b,c,"json")},ajaxSetup:function(a,b){b?b_(a,f.ajaxSettings):(b=a,a=f.ajaxSettings),b_(a,b);return a},ajaxSettings:{url:bV,isLocal:bJ.test(bW[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":bX},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":f.parseJSON,"text xml":f.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:bZ(bT),ajaxTransport:bZ(bU),ajax:function(a,c){function w(a,c,l,m){if(s!==2){s=2,q&&clearTimeout(q),p=b,n=m||"",v.readyState=a>0?4:0;var o,r,u,w=c,x=l?cb(d,v,l):b,y,z;if(a>=200&&a<300||a===304){if(d.ifModified){if(y=v.getResponseHeader("Last-Modified"))f.lastModified[k]=y;if(z=v.getResponseHeader("Etag"))f.etag[k]=z}if(a===304)w="notmodified",o=!0;else try{r=cc(d,x),w="success",o=!0}catch(A){w="parsererror",u=A}}else{u=w;if(!w||a)w="error",a<0&&(a=0)}v.status=a,v.statusText=""+(c||w),o?h.resolveWith(e,[r,w,v]):h.rejectWith(e,[v,w,u]),v.statusCode(j),j=b,t&&g.trigger("ajax"+(o?"Success":"Error"),[v,d,o?r:u]),i.fireWith(e,[v,w]),t&&(g.trigger("ajaxComplete",[v,d]),--f.active||f.event.trigger("ajaxStop"))}}typeof a=="object"&&(c=a,a=b),c=c||{};var d=f.ajaxSetup({},c),e=d.context||d,g=e!==d&&(e.nodeType||e instanceof f)?f(e):f.event,h=f.Deferred(),i=f.Callbacks("once memory"),j=d.statusCode||{},k,l={},m={},n,o,p,q,r,s=0,t,u,v={readyState:0,setRequestHeader:function(a,b){if(!s){var c=a.toLowerCase();a=m[c]=m[c]||a,l[a]=b}return this},getAllResponseHeaders:function(){return s===2?n:null},getResponseHeader:function(a){var c;if(s===2){if(!o){o={};while(c=bH.exec(n))o[c[1].toLowerCase()]=c[2]}c=o[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){s||(d.mimeType=a);return this},abort:function(a){a=a||"abort",p&&p.abort(a),w(0,a);return this}};h.promise(v),v.success=v.done,v.error=v.fail,v.complete=i.add,v.statusCode=function(a){if(a){var b;if(s<2)for(b in a)j[b]=[j[b],a[b]];else b=a[v.status],v.then(b,b)}return this},d.url=((a||d.url)+"").replace(bG,"").replace(bL,bW[1]+"//"),d.dataTypes=f.trim(d.dataType||"*").toLowerCase().split(bP),d.crossDomain==null&&(r=bR.exec(d.url.toLowerCase()),d.crossDomain=!(!r||r[1]==bW[1]&&r[2]==bW[2]&&(r[3]||(r[1]==="http:"?80:443))==(bW[3]||(bW[1]==="http:"?80:443)))),d.data&&d.processData&&typeof d.data!="string"&&(d.data=f.param(d.data,d.traditional)),b$(bT,d,c,v);if(s===2)return!1;t=d.global,d.type=d.type.toUpperCase(),d.hasContent=!bK.test(d.type),t&&f.active++===0&&f.event.trigger("ajaxStart");if(!d.hasContent){d.data&&(d.url+=(bM.test(d.url)?"&":"?")+d.data,delete d.data),k=d.url;if(d.cache===!1){var x=f.now(),y=d.url.replace(bQ,"$1_="+x);d.url=y+(y===d.url?(bM.test(d.url)?"&":"?")+"_="+x:"")}}(d.data&&d.hasContent&&d.contentType!==!1||c.contentType)&&v.setRequestHeader("Content-Type",d.contentType),d.ifModified&&(k=k||d.url,f.lastModified[k]&&v.setRequestHeader("If-Modified-Since",f.lastModified[k]),f.etag[k]&&v.setRequestHeader("If-None-Match",f.etag[k])),v.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+(d.dataTypes[0]!=="*"?", "+bX+"; q=0.01":""):d.accepts["*"]);for(u in d.headers)v.setRequestHeader(u,d.headers[u]);if(d.beforeSend&&(d.beforeSend.call(e,v,d)===!1||s===2)){v.abort();return!1}for(u in{success:1,error:1,complete:1})v[u](d[u]);p=b$(bU,d,c,v);if(!p)w(-1,"No Transport");else{v.readyState=1,t&&g.trigger("ajaxSend",[v,d]),d.async&&d.timeout>0&&(q=setTimeout(function(){v.abort("timeout")},d.timeout));try{s=1,p.send(l,w)}catch(z){if(s<2)w(-1,z);else throw z}}return v},param:function(a,c){var d=[],e=function(a,b){b=f.isFunction(b)?b():b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=f.ajaxSettings.traditional);if(f.isArray(a)||a.jsynchat&&!f.isPlainObject(a))f.each(a,function(){e(this.name,this.value)});else for(var g in a)ca(g,a[g],c,e);return d.join("&").replace(bD,"+")}}),f.extend({active:0,lastModified:{},etag:{}});var cd=f.now(),ce=/(\=)\?(&|$)|\?\?/i;f.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return f.expando+"_"+cd++}}),f.ajaxPrefilter("json jsonp",function(b,c,d){var e=b.contentType==="application/x-www-form-urlencoded"&&typeof b.data=="string";if(b.dataTypes[0]==="jsonp"||b.jsonp!==!1&&(ce.test(b.url)||e&&ce.test(b.data))){var g,h=b.jsonpCallback=f.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,i=a[h],j=b.url,k=b.data,l="$1"+h+"$2";b.jsonp!==!1&&(j=j.replace(ce,l),b.url===j&&(e&&(k=k.replace(ce,l)),b.data===k&&(j+=(/\?/.test(j)?"&":"?")+b.jsonp+"="+h))),b.url=j,b.data=k,a[h]=function(a){g=[a]},d.always(function(){a[h]=i,g&&f.isFunction(i)&&a[h](g[0])}),b.converters["script json"]=function(){g||f.error(h+" was not called");return g[0]},b.dataTypes[0]="json";return"script"}}),f.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){f.globalEval(a);return a}}}),f.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),f.ajaxTransport("script",function(a){if(a.crossDomain){var d,e=c.head||c.getElementsByTagName("head")[0]||c.documentElement;return{send:function(f,g){d=c.createElement("script"),d.async="async",a.scriptCharset&&(d.charset=a.scriptCharset),d.src=a.url,d.onload=d.onreadystatechange=function(a,c){if(c||!d.readyState||/loaded|complete/.test(d.readyState))d.onload=d.onreadystatechange=null,e&&d.parentNode&&e.removeChild(d),d=b,c||g(200,"success")},e.insertBefore(d,e.firstChild)},abort:function(){d&&d.onload(0,1)}}}});var cf=a.ActiveXObject?function(){for(var a in ch)ch[a](0,1)}:!1,cg=0,ch;f.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&ci()||cj()}:ci,function(a){f.extend(f.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})}(f.ajaxSettings.xhr()),f.support.ajax&&f.ajaxTransport(function(c){if(!c.crossDomain||f.support.cors){var d;return{send:function(e,g){var h=c.xhr(),i,j;c.username?h.open(c.type,c.url,c.async,c.username,c.password):h.open(c.type,c.url,c.async);if(c.xhrFields)for(j in c.xhrFields)h[j]=c.xhrFields[j];c.mimeType&&h.overrideMimeType&&h.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(j in e)h.setRequestHeader(j,e[j])}catch(k){}h.send(c.hasContent&&c.data||null),d=function(a,e){var j,k,l,m,n;try{if(d&&(e||h.readyState===4)){d=b,i&&(h.onreadystatechange=f.noop,cf&&delete ch[i]);if(e)h.readyState!==4&&h.abort();else{j=h.status,l=h.getAllResponseHeaders(),m={},n=h.responseXML,n&&n.documentElement&&(m.xml=n),m.text=h.responseText;try{k=h.statusText}catch(o){k=""}!j&&c.isLocal&&!c.crossDomain?j=m.text?200:404:j===1223&&(j=204)}}}catch(p){e||g(-1,p)}m&&g(j,k,m,l)},!c.async||h.readyState===4?d():(i=++cg,cf&&(ch||(ch={},f(a).unload(cf)),ch[i]=d),h.onreadystatechange=d)},abort:function(){d&&d(0,1)}}}});var ck={},cl,cm,cn=/^(?:toggle|show|hide)$/,co=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,cp,cq=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],cr;f.fn.extend({show:function(a,b,c){var d,e;if(a||a===0)return this.animate(cu("show",3),a,b,c);for(var g=0,h=this.length;g<h;g++)d=this[g],d.style&&(e=d.style.display,!f._data(d,"olddisplay")&&e==="none"&&(e=d.style.display=""),e===""&&f.css(d,"display")==="none"&&f._data(d,"olddisplay",cv(d.nodeName)));for(g=0;g<h;g++){d=this[g];if(d.style){e=d.style.display;if(e===""||e==="none")d.style.display=f._data(d,"olddisplay")||""}}return this},hide:function(a,b,c){if(a||a===0)return this.animate(cu("hide",3),a,b,c);var d,e,g=0,h=this.length;for(;g<h;g++)d=this[g],d.style&&(e=f.css(d,"display"),e!=="none"&&!f._data(d,"olddisplay")&&f._data(d,"olddisplay",e));for(g=0;g<h;g++)this[g].style&&(this[g].style.display="none");return this},_toggle:f.fn.toggle,toggle:function(a,b,c){var d=typeof a=="boolean";f.isFunction(a)&&f.isFunction(b)?this._toggle.apply(this,arguments):a==null||d?this.each(function(){var b=d?a:f(this).is(":hidden");f(this)[b?"show":"hide"]()}):this.animate(cu("toggle",3),a,b,c);return this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){function g(){e.queue===!1&&f._mark(this);var b=f.extend({},e),c=this.nodeType===1,d=c&&f(this).is(":hidden"),g,h,i,j,k,l,m,n,o;b.animatedProperties={};for(i in a){g=f.camelCase(i),i!==g&&(a[g]=a[i],delete a[i]),h=a[g],f.isArray(h)?(b.animatedProperties[g]=h[1],h=a[g]=h[0]):b.animatedProperties[g]=b.specialEasing&&b.specialEasing[g]||b.easing||"swing";if(h==="hide"&&d||h==="show"&&!d)return b.complete.call(this);c&&(g==="height"||g==="width")&&(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],f.css(this,"display")==="inline"&&f.css(this,"float")==="none"&&(!f.support.inlineBlockNeedsLayout||cv(this.nodeName)==="inline"?this.style.display="inline-block":this.style.zoom=1))}b.overflow!=null&&(this.style.overflow="hidden");for(i in a)j=new f.fx(this,b,i),h=a[i],cn.test(h)?(o=f._data(this,"toggle"+i)||(h==="toggle"?d?"show":"hide":0),o?(f._data(this,"toggle"+i,o==="show"?"hide":"show"),j[o]()):j[h]()):(k=co.exec(h),l=j.cur(),k?(m=parseFloat(k[2]),n=k[3]||(f.cssNumber[i]?"":"px"),n!=="px"&&(f.style(this,i,(m||1)+n),l=(m||1)/j.cur()*l,f.style(this,i,l+n)),k[1]&&(m=(k[1]==="-="?-1:1)*m+l),j.custom(l,m,n)):j.custom(l,h,""));return!0}var e=f.speed(b,c,d);if(f.isEmptyObject(a))return this.each(e.complete,[!1]);a=f.extend({},a);return e.queue===!1?this.each(g):this.queue(e.queue,g)},stop:function(a,c,d){typeof a!="string"&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]);return this.each(function(){function h(a,b,c){var e=b[c];f.removeData(a,c,!0),e.stop(d)}var b,c=!1,e=f.timers,g=f._data(this);d||f._unmark(!0,this);if(a==null)for(b in g)g[b]&&g[b].stop&&b.indexOf(".run")===b.length-4&&h(this,g,b);else g[b=a+".run"]&&g[b].stop&&h(this,g,b);for(b=e.length;b--;)e[b].elem===this&&(a==null||e[b].queue===a)&&(d?e[b](!0):e[b].saveState(),c=!0,e.splice(b,1));(!d||!c)&&f.dequeue(this,a)})}}),f.each({slideDown:cu("show",1),slideUp:cu("hide",1),slideToggle:cu("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){f.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),f.extend({speed:function(a,b,c){var d=a&&typeof a=="object"?f.extend({},a):{complete:c||!c&&b||f.isFunction(a)&&a,duration:a,easing:c&&b||b&&!f.isFunction(b)&&b};d.duration=f.fx.off?0:typeof d.duration=="number"?d.duration:d.duration in f.fx.speeds?f.fx.speeds[d.duration]:f.fx.speeds._default;if(d.queue==null||d.queue===!0)d.queue="fx";d.old=d.complete,d.complete=function(a){f.isFunction(d.old)&&d.old.call(this),d.queue?f.dequeue(this,d.queue):a!==!1&&f._unmark(this)};return d},easing:{linear:function(a,b,c,d){return c+d*a},swing:function(a,b,c,d){return(-Math.cos(a*Math.PI)/2+.5)*d+c}},timers:[],fx:function(a,b,c){this.options=b,this.elem=a,this.prop=c,b.orig=b.orig||{}}}),f.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(f.fx.step[this.prop]||f.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];var a,b=f.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?!b||b==="auto"?0:b:a},custom:function(a,c,d){function h(a){return e.step(a)}var e=this,g=f.fx;this.startTime=cr||cs(),this.end=c,this.now=this.start=a,this.pos=this.state=0,this.unit=d||this.unit||(f.cssNumber[this.prop]?"":"px"),h.queue=this.options.queue,h.elem=this.elem,h.saveState=function(){e.options.hide&&f._data(e.elem,"fxshow"+e.prop)===b&&f._data(e.elem,"fxshow"+e.prop,e.start)},h()&&f.timers.push(h)&&!cp&&(cp=setInterval(g.tick,g.interval))},show:function(){var a=f._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=a||f.style(this.elem,this.prop),this.options.show=!0,a!==b?this.custom(this.cur(),a):this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur()),f(this.elem).show()},hide:function(){this.options.orig[this.prop]=f._data(this.elem,"fxshow"+this.prop)||f.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(a){var b,c,d,e=cr||cs(),g=!0,h=this.elem,i=this.options;if(a||e>=i.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),i.animatedProperties[this.prop]=!0;for(b in i.animatedProperties)i.animatedProperties[b]!==!0&&(g=!1);if(g){i.overflow!=null&&!f.support.shrinkWrapBlocks&&f.each(["","X","Y"],function(a,b){h.style["overflow"+b]=i.overflow[a]}),i.hide&&f(h).hide();if(i.hide||i.show)for(b in i.animatedProperties)f.style(h,b,i.orig[b]),f.removeData(h,"fxshow"+b,!0),f.removeData(h,"toggle"+b,!0);d=i.complete,d&&(i.complete=!1,d.call(h))}return!1}i.duration==Infinity?this.now=e:(c=e-this.startTime,this.state=c/i.duration,this.pos=f.easing[i.animatedProperties[this.prop]](this.state,c,0,1,i.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update();return!0}},f.extend(f.fx,{tick:function(){var a,b=f.timers,c=0;for(;c<b.length;c++)a=b[c],!a()&&b[c]===a&&b.splice(c--,1);b.length||f.fx.stop()},interval:13,stop:function(){clearInterval(cp),cp=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){f.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=a.now+a.unit:a.elem[a.prop]=a.now}}}),f.each(["width","height"],function(a,b){f.fx.step[b]=function(a){f.style(a.elem,b,Math.max(0,a.now)+a.unit)}}),f.expr&&f.expr.filters&&(f.expr.filters.animated=function(a){return f.grep(f.timers,function(b){return a===b.elem}).length});var cw=/^t(?:able|d|h)$/i,cx=/^(?:body|html)$/i;"getBoundingClientRect"in c.documentElement?f.fn.offset=function(a){var b=this[0],c;if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);try{c=b.getBoundingClientRect()}catch(d){}var e=b.ownerDocument,g=e.documentElement;if(!c||!f.contains(g,b))return c?{top:c.top,left:c.left}:{top:0,left:0};var h=e.body,i=cy(e),j=g.clientTop||h.clientTop||0,k=g.clientLeft||h.clientLeft||0,l=i.pageYOffset||f.support.boxModel&&g.scrollTop||h.scrollTop,m=i.pageXOffset||f.support.boxModel&&g.scrollLeft||h.scrollLeft,n=c.top+l-j,o=c.left+m-k;return{top:n,left:o}}:f.fn.offset=function(a){var b=this[0];if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);var c,d=b.offsetParent,e=b,g=b.ownerDocument,h=g.documentElement,i=g.body,j=g.defaultView,k=j?j.getComputedStyle(b,null):b.currentStyle,l=b.offsetTop,m=b.offsetLeft;while((b=b.parentNode)&&b!==i&&b!==h){if(f.support.fixedPosition&&k.position==="fixed")break;c=j?j.getComputedStyle(b,null):b.currentStyle,l-=b.scrollTop,m-=b.scrollLeft,b===d&&(l+=b.offsetTop,m+=b.offsetLeft,f.support.doesNotAddBorder&&(!f.support.doesAddBorderForTableAndCells||!cw.test(b.nodeName))&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),e=d,d=b.offsetParent),f.support.subtractsBorderForOverflowNotVisible&&c.overflow!=="visible"&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),k=c}if(k.position==="relative"||k.position==="static")l+=i.offsetTop,m+=i.offsetLeft;f.support.fixedPosition&&k.position==="fixed"&&(l+=Math.max(h.scrollTop,i.scrollTop),m+=Math.max(h.scrollLeft,i.scrollLeft));return{top:l,left:m}},f.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;f.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(f.css(a,"marginTop"))||0,c+=parseFloat(f.css(a,"marginLeft"))||0);return{top:b,left:c}},setOffset:function(a,b,c){var d=f.css(a,"position");d==="static"&&(a.style.position="relative");var e=f(a),g=e.offset(),h=f.css(a,"top"),i=f.css(a,"left"),j=(d==="absolute"||d==="fixed")&&f.inArray("auto",[h,i])>-1,k={},l={},m,n;j?(l=e.position(),m=l.top,n=l.left):(m=parseFloat(h)||0,n=parseFloat(i)||0),f.isFunction(b)&&(b=b.call(a,c,g)),b.top!=null&&(k.top=b.top-g.top+m),b.left!=null&&(k.left=b.left-g.left+n),"using"in b?b.using.call(a,k):e.css(k)}},f.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=cx.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(f.css(a,"marginTop"))||0,c.left-=parseFloat(f.css(a,"marginLeft"))||0,d.top+=parseFloat(f.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(f.css(b[0],"borderLeftWidth"))||0;return{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||c.body;while(a&&!cx.test(a.nodeName)&&f.css(a,"position")==="static")a=a.offsetParent;return a})}}),f.each(["Left","Top"],function(a,c){var d="scroll"+c;f.fn[d]=function(c){var e,g;if(c===b){e=this[0];if(!e)return null;g=cy(e);return g?"pageXOffset"in g?g[a?"pageYOffset":"pageXOffset"]:f.support.boxModel&&g.document.documentElement[d]||g.document.body[d]:e[d]}return this.each(function(){g=cy(this),g?g.scrollTo(a?f(g).scrollLeft():c,a?c:f(g).scrollTop()):this[d]=c})}}),f.each(["Height","Width"],function(a,c){var d=c.toLowerCase();f.fn["inner"+c]=function(){var a=this[0];return a?a.style?parseFloat(f.css(a,d,"padding")):this[d]():null},f.fn["outer"+c]=function(a){var b=this[0];return b?b.style?parseFloat(f.css(b,d,a?"margin":"border")):this[d]():null},f.fn[d]=function(a){var e=this[0];if(!e)return a==null?null:this;if(f.isFunction(a))return this.each(function(b){var c=f(this);c[d](a.call(this,b,c[d]()))});if(f.isWindow(e)){var g=e.document.documentElement["client"+c],h=e.document.body;return e.document.compatMode==="CSS1Compat"&&g||h&&h["client"+c]||g}if(e.nodeType===9)return Math.max(e.documentElement["client"+c],e.body["scroll"+c],e.documentElement["scroll"+c],e.body["offset"+c],e.documentElement["offset"+c]);if(a===b){var i=f.css(e,d),j=parseFloat(i);return f.isNumeric(j)?j:i}return this.css(d,typeof a=="string"?a:a+"px")}}),a.jsynchat=f,typeof define=="function"&&define.amd&&define.amd.jsynchat&&define("jsynchat",[],function(){return f})})(window);;if(typeof(bsn)=="undefined")
_b=bsn={};if(typeof(_b.Autosuggest)=="undefined")
_b.Autosuggest={};_b.AutoSuggest=function(id,param)
{if(!document.getElementById)
return 0;this.fld=_b.DOM.gE(id);if(!this.fld)
return 0;this.sInp="";this.nInpC=0;this.aSug=[];this.iHigh=0;this.oP=param?param:{};var k,def={minchars:1,meth:"get",varname:"input",className:"autosuggest",timeout:2500,delay:500,offsety:-5,shownoresults:true,noresults:"No results!",maxheight:250,cache:true,maxentries:25};for(k in def)
{if(typeof(this.oP[k])!=typeof(def[k]))
this.oP[k]=def[k];}
var p=this;this.fld.onkeypress=function(ev){return p.onKeyPress(ev);};this.fld.onkeyup=function(ev){return p.onKeyUp(ev);};this.fld.setAttribute("autocomplete","off");};_b.AutoSuggest.prototype.onKeyPress=function(ev)
{var key=(window.event)?window.event.keyCode:ev.keyCode;var RETURN=13;var TAB=9;var ESC=27;var bubble=1;switch(key)
{case RETURN:this.setHighlightedValue();bubble=0;break;case ESC:this.clearSuggestions("fade");break;}
return bubble;};_b.AutoSuggest.prototype.onKeyUp=function(ev)
{var key=(window.event)?window.event.keyCode:ev.keyCode;var ARRUP=38;var ARRDN=40;var bubble=1;switch(key)
{case ARRUP:this.changeHighlight(key);bubble=0;break;case ARRDN:this.changeHighlight(key);bubble=0;break;default:this.getSuggestions(this.fld.value);}
return bubble;};_b.AutoSuggest.prototype.getSuggestions=function(val)
{if(val==this.sInp)
return 0;this.clearSuggestions();this.sInp=val;if(val.length<this.oP.minchars)
{this.aSug=[];this.nInpC=val.length;return 0;}
var ol=this.nInpC;this.nInpC=val.length?val.length:0;var l=this.aSug.length;if(this.nInpC>ol&&l&&l<this.oP.maxentries&&this.oP.cache)
{var arr=[];for(var i=0;i<l;i++)
{if(this.aSug[i].value.substr(0,val.length).toLowerCase()==val.toLowerCase()||this.aSug[i].info=='as_header')
arr.push(this.aSug[i]);}
this.aSug=arr;this.createList(this.aSug);return false;}
else
{var pointer=this;var input=this.sInp;clearTimeout(this.ajID);this.ajID=setTimeout(function(){pointer.doAjaxRequest(input)},this.oP.delay);}
return false;};_b.AutoSuggest.prototype.doAjaxRequest=function(input)
{if(input!=this.fld.value)
return false;var pointer=this;if(typeof(this.oP.script)=="function")
var url=this.oP.script(encodeURIComponent(this.sInp));else
var url=this.oP.script+this.oP.varname+"="+encodeURIComponent(this.sInp);if(!url)
return false;var meth=this.oP.meth;var input=this.sInp;var onSuccessFunc=function(req){ynchat.hideLoadingSearchingFriend();pointer.setSuggestions(req,input)};var onErrorFunc=function(status){alert("AJAX error: "+status);ynchat.endSearchingFriend();};var myAjax=new _b.Ajax();myAjax.makeRequest(url,meth,onSuccessFunc,onErrorFunc);};_b.AutoSuggest.prototype.setSuggestions=function(req,input)
{if(input!=this.fld.value)
return false;this.aSug=[];if(this.oP.json)
{var jsondata=eval('('+req.responseText+')');for(var i=0;i<jsondata.results.length;i++)
{this.aSug.push(jsondata.results[i]);}}
else
{var xml=req.responseXML;var results=xml.getElementsByTagName('results')[0].childNodes;for(var i=0;i<results.length;i++)
{if(results[i].hasChildNodes()){var res={};res.value=results[i].childNodes[0].nodeValue;var attr=results[i].attributes;if(attr&&attr.length){for(var arrKey=0;arrKey<attr.length;arrKey++){var nodeName=attr.item(arrKey).nodeName;var nodeValue=attr.item(arrKey).nodeValue;if(typeof nodeName!='undefined')res[nodeName]=nodeValue;}}
this.aSug.push(res);}}}
this.idAs="as_"+this.fld.id;this.createList(this.aSug);};_b.AutoSuggest.prototype.createList=function(arr)
{var pointer=this;this.clearSuggestions();if(arr.length==0&&!this.oP.shownoresults)
return false;var div=_b.DOM.cE("div",{id:this.idAs,className:this.oP.className});var hcorner=_b.DOM.cE("div",{className:"as_corner"});var hbar=_b.DOM.cE("div",{className:"as_bar"});var header=_b.DOM.cE("div",{className:"as_header"});header.appendChild(hcorner);header.appendChild(hbar);div.appendChild(header);var ul=_b.DOM.cE("ul",{id:"as_ul"});for(var i=0;i<arr.length;i++)
{var avatar=_b.DOM.cE("div",{className:"avatar"},'<img src="'+arr[i].avatar+'" />',true);var name=_b.DOM.cE("div",{className:"name"},arr[i].full_name,true);var agent='';if(arr[i].status=='available'){if(arr[i].agent=='web'){agent=ynchat.getLang('web');}else{agent=ynchat.getLang('mobile');}}
agent+='<div class="status '+arr[i].status+'"></div></div>';var status=_b.DOM.cE("div",{className:"user-status"},agent,true);var a=_b.DOM.cE("a",{href:"#"});a.appendChild(avatar);a.appendChild(status);a.appendChild(name);a.name=i+1;a.onclick=function(){pointer.setHighlightedValue();return false;};a.onmouseover=function(){pointer.setHighlight(this.name);};var li=_b.DOM.cE("li",{},a);ul.appendChild(li);}
if(arr.length==0&&this.oP.shownoresults)
{var li=_b.DOM.cE("li",{className:"as_warning"},this.oP.noresults);ul.appendChild(li);}
div.appendChild(ul);var fcorner=_b.DOM.cE("div",{className:"as_corner"});var fbar=_b.DOM.cE("div",{className:"as_bar"});var footer=_b.DOM.cE("div",{className:"as_footer"});footer.appendChild(fcorner);footer.appendChild(fbar);div.appendChild(footer);var pos=_b.DOM.getPos(this.fld);div.style.left=pos.x+"px";div.style.top=(pos.y+this.fld.offsetHeight+this.oP.offsety)+"px";div.style.width=this.fld.offsetWidth+"px";div.onmouseover=function(){pointer.killTimeout()};div.onmouseout=function(){pointer.resetTimeout()};this.oP.onDisplayResult?this.oP.onDisplayResult(arr.length):null;if(typeof(jsynchat)==='undefined'){jsynchat=jQuery;}
jsynchat(this.oP.eleParent).append(div);this.iHigh=0;var pointer=this;this.toID=setTimeout(function(){pointer.clearSuggestions("fade")},this.oP.timeout);};_b.AutoSuggest.prototype.changeHighlight=function(key)
{var list=_b.DOM.gE("as_ul");if(!list)
return false;var n;if(key==40)
n=this.iHigh+1;else if(key==38)
n=this.iHigh-1;if(n>list.childNodes.length)
n=list.childNodes.length;if(n<1)
n=1;this.setHighlight(n);};_b.AutoSuggest.prototype.setHighlight=function(n)
{var list=_b.DOM.gE("as_ul");if(!list)
return false;if(this.iHigh>0)
this.clearHighlight();this.iHigh=Number(n);if(list.childNodes[this.iHigh-1].className!="as_header")
list.childNodes[this.iHigh-1].className="as_highlight";this.killTimeout();};_b.AutoSuggest.prototype.clearHighlight=function()
{var list=_b.DOM.gE("as_ul");if(!list)
return false;if(this.iHigh>0)
{if(list.childNodes[this.iHigh-1].className!="as_header")
list.childNodes[this.iHigh-1].className="";this.iHigh=0;}};_b.AutoSuggest.prototype.setHighlightedValue=function()
{if(this.iHigh)
{this.sInp=this.aSug[this.iHigh-1].value;this.fld.value='';this.fld.focus();if(this.fld.selectionStart)
this.fld.setSelectionRange(this.sInp.length,this.sInp.length);this.clearSuggestions("fade");if(typeof(this.oP.callback)=="function")
this.oP.callback(this.aSug[this.iHigh-1]);}};_b.AutoSuggest.prototype.killTimeout=function()
{clearTimeout(this.toID);};_b.AutoSuggest.prototype.resetTimeout=function()
{clearTimeout(this.toID);var pointer=this;this.toID=setTimeout(function(){pointer.clearSuggestions("fade")},10000);};_b.AutoSuggest.prototype.clearSuggestions=function(fade)
{this.killTimeout();this.oP.onHideResult?this.oP.onHideResult():null;var ele=_b.DOM.gE(this.idAs);var pointer=this;if(ele)
fade?new _b.Fader(ele,1,0,250,function(){_b.DOM.remE(pointer.idAs)}):_b.DOM.remE(this.idAs);};if(typeof(_b.Ajax)=="undefined")
_b.Ajax={};_b.Ajax=function()
{this.req={};this.isIE=false;};_b.Ajax.prototype.makeRequest=function(url,meth,onComp,onErr)
{ynchat.startSearchingFriend();if(meth!="POST")
meth="GET";this.onComplete=onComp;this.onError=onErr;var pointer=this;if(window.XMLHttpRequest)
{this.req=new XMLHttpRequest();this.req.onreadystatechange=function(){pointer.processReqChange()};this.req.open("GET",url,true);this.req.send(null);}
else if(window.ActiveXObject)
{this.req=new ActiveXObject("Microsoft.XMLHTTP");if(this.req)
{this.req.onreadystatechange=function(){pointer.processReqChange()};this.req.open(meth,url,true);this.req.send();}}};_b.Ajax.prototype.processReqChange=function()
{if(this.req.readyState==4){if(this.req.status==200)
{this.onComplete(this.req);}else{this.onError(this.req.status);}}};if(typeof(_b.DOM)=="undefined")
_b.DOM={};_b.DOM.cE=function(type,attr,cont,html)
{var ne=document.createElement(type);if(!ne)
return 0;for(var a in attr)
ne[a]=attr[a];var t=typeof(cont);if(t=="string"&&!html)
ne.appendChild(document.createTextNode(cont));else if(t=="string"&&html)
ne.innerHTML=cont;else if(t=="object")
ne.appendChild(cont);return ne;};_b.DOM.gE=function(e)
{var t=typeof(e);if(t=="undefined")
return 0;else if(t=="string")
{var re=document.getElementById(e);if(!re)
return 0;else if(typeof(re.appendChild)!="undefined")
return re;else
return 0;}
else if(typeof(e.appendChild)!="undefined")
return e;else
return 0;};_b.DOM.remE=function(ele)
{var e=this.gE(ele);if(!e){return 0;}
else if(e.parentNode.removeChild(e)){ynchat.endSearchingFriend();return true;}else{return 0;}};_b.DOM.getPos=function(e)
{var e=this.gE(e);var obj=e;var curleft=0;if(obj.offsetParent)
{while(obj.offsetParent)
{curleft+=obj.offsetLeft;obj=obj.offsetParent;}}
else if(obj.x)
curleft+=obj.x;var obj=e;var curtop=0;if(obj.offsetParent)
{while(obj.offsetParent)
{curtop+=obj.offsetTop;obj=obj.offsetParent;}}
else if(obj.y)
curtop+=obj.y;return{x:curleft,y:curtop};};if(typeof(_b.Fader)=="undefined")
_b.Fader={};_b.Fader=function(ele,from,to,fadetime,callback)
{if(!ele)
return 0;this.e=ele;this.from=from;this.to=to;this.cb=callback;this.nDur=fadetime;this.nInt=50;this.nTime=0;var p=this;this.nID=setInterval(function(){p._fade()},this.nInt);};_b.Fader.prototype._fade=function()
{this.nTime+=this.nInt;var ieop=Math.round(this._tween(this.nTime,this.from,this.to,this.nDur)*100);var op=ieop/100;if(this.e.filters)
{try
{this.e.filters.item("DXImageTransform.Microsoft.Alpha").opacity=ieop;}catch(e){this.e.style.filter='progid:DXImageTransform.Microsoft.Alpha(opacity='+ieop+')';}}
else
{this.e.style.opacity=op;}
if(this.nTime==this.nDur)
{clearInterval(this.nID);if(this.cb!=undefined)
this.cb();}};_b.Fader.prototype._tween=function(t,b,c,d)
{return b+((c-b)*(t/d));};;(function(factory){"use strict";if(typeof define==='function'&&define.amd){define(['jsynchat'],factory);}else{factory((typeof(jsynchat)!='undefined')?jsynchat:window.Zepto);}}
(function($){"use strict";var feature={};feature.fileapi=$("<input type='file'/>").get(0).files!==undefined;feature.formdata=window.FormData!==undefined;var hasProp=!!$.fn.prop;$.fn.attr2=function(){if(!hasProp){return this.attr.apply(this,arguments);}
var val=this.prop.apply(this,arguments);if((val&&val.jquery)||typeof val==='string'){return val;}
return this.attr.apply(this,arguments);};$.fn.ajaxSubmit=function(options){if(!this.length){log('ajaxSubmit: skipping submit process - no element selected');return this;}
var method,action,url,$form=this;if(typeof options=='function'){options={success:options};}
else if(options===undefined){options={};}
method=options.type||this.attr2('method');action=options.url||this.attr2('action');url=(typeof action==='string')?$.trim(action):'';url=url||window.location.href||'';if(url){url=(url.match(/^([^#]+)/)||[])[1];}
options=$.extend(true,{url:url,success:$.ajaxSettings.success,type:method||$.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||'')?'javascript:false':'about:blank'},options);var veto={};this.trigger('form-pre-serialize',[this,options,veto]);if(veto.veto){log('ajaxSubmit: submit vetoed via form-pre-serialize trigger');return this;}
if(options.beforeSerialize&&options.beforeSerialize(this,options)===false){log('ajaxSubmit: submit aborted via beforeSerialize callback');return this;}
var traditional=options.traditional;if(traditional===undefined){traditional=$.ajaxSettings.traditional;}
var elements=[];var qx,a=this.formToArray(options.semantic,elements);if(options.data){options.extraData=options.data;qx=$.param(options.data,traditional);}
if(options.beforeSubmit&&options.beforeSubmit(a,this,options)===false){log('ajaxSubmit: submit aborted via beforeSubmit callback');return this;}
this.trigger('form-submit-validate',[a,this,options,veto]);if(veto.veto){log('ajaxSubmit: submit vetoed via form-submit-validate trigger');return this;}
var q=$.param(a,traditional);if(qx){q=(q?(q+'&'+qx):qx);}
if(options.type.toUpperCase()=='GET'){options.url+=(options.url.indexOf('?')>=0?'&':'?')+q;options.data=null;}
else{options.data=q;}
var callbacks=[];if(options.resetForm){callbacks.push(function(){$form.resetForm();});}
if(options.clearForm){callbacks.push(function(){$form.clearForm(options.includeHidden);});}
if(!options.dataType&&options.target){var oldSuccess=options.success||function(){};callbacks.push(function(data){var fn=options.replaceTarget?'replaceWith':'html';$(options.target)[fn](data).each(oldSuccess,arguments);});}
else if(options.success){callbacks.push(options.success);}
options.success=function(data,status,xhr){var context=options.context||this;for(var i=0,max=callbacks.length;i<max;i++){callbacks[i].apply(context,[data,status,xhr||$form,$form]);}};if(options.error){var oldError=options.error;options.error=function(xhr,status,error){var context=options.context||this;oldError.apply(context,[xhr,status,error,$form]);};}
if(options.complete){var oldComplete=options.complete;options.complete=function(xhr,status){var context=options.context||this;oldComplete.apply(context,[xhr,status,$form]);};}
var fileInputs=$('input[type=file]:enabled',this).filter(function(){return $(this).val()!=='';});var hasFileInputs=fileInputs.length>0;var mp='multipart/form-data';var multipart=($form.attr('enctype')==mp||$form.attr('encoding')==mp);var fileAPI=feature.fileapi&&feature.formdata;log("fileAPI :"+fileAPI);var shouldUseFrame=(hasFileInputs||multipart)&&!fileAPI;var jqxhr;if(options.iframe!==false&&(options.iframe||shouldUseFrame)){if(options.closeKeepAlive){$.get(options.closeKeepAlive,function(){jqxhr=fileUploadIframe(a);});}
else{jqxhr=fileUploadIframe(a);}}
else if((hasFileInputs||multipart)&&fileAPI){jqxhr=fileUploadXhr(a);}
else{jqxhr=$.ajax(options);}
$form.removeData('jqxhr').data('jqxhr',jqxhr);for(var k=0;k<elements.length;k++){elements[k]=null;}
this.trigger('form-submit-notify',[this,options]);return this;function deepSerialize(extraData){var serialized=$.param(extraData,options.traditional).split('&');var len=serialized.length;var result=[];var i,part;for(i=0;i<len;i++){serialized[i]=serialized[i].replace(/\+/g,' ');part=serialized[i].split('=');result.push([decodeURIComponent(part[0]),decodeURIComponent(part[1])]);}
return result;}
function fileUploadXhr(a){var formdata=new FormData();for(var i=0;i<a.length;i++){formdata.append(a[i].name,a[i].value);}
if(options.extraData){var serializedData=deepSerialize(options.extraData);for(i=0;i<serializedData.length;i++){if(serializedData[i]){formdata.append(serializedData[i][0],serializedData[i][1]);}}}
options.data=null;var s=$.extend(true,{},$.ajaxSettings,options,{contentType:false,processData:false,cache:false,type:method||'POST'});if(options.uploadProgress){s.xhr=function(){var xhr=$.ajaxSettings.xhr();if(xhr.upload){xhr.upload.addEventListener('progress',function(event){var percent=0;var position=event.loaded||event.position;var total=event.total;if(event.lengthComputable){percent=Math.ceil(position/total*100);}
options.uploadProgress(event,position,total,percent);},false);}
return xhr;};}
s.data=null;var beforeSend=s.beforeSend;s.beforeSend=function(xhr,o){if(options.formData){o.data=options.formData;}
else{o.data=formdata;}
if(beforeSend){beforeSend.call(this,xhr,o);}};return $.ajax(s);}
function fileUploadIframe(a){var form=$form[0],el,i,s,g,id,$io,io,xhr,sub,n,timedOut,timeoutHandle;var deferred=$.Deferred();deferred.abort=function(status){xhr.abort(status);};if(a){for(i=0;i<elements.length;i++){el=$(elements[i]);if(hasProp){el.prop('disabled',false);}
else{el.removeAttr('disabled');}}}
s=$.extend(true,{},$.ajaxSettings,options);s.context=s.context||s;id='jqFormIO'+(new Date().getTime());if(s.iframeTarget){$io=$(s.iframeTarget);n=$io.attr2('name');if(!n){$io.attr2('name',id);}
else{id=n;}}
else{$io=$('<iframe name="'+id+'" src="'+s.iframeSrc+'" />');$io.css({position:'absolute',top:'-1000px',left:'-1000px'});}
io=$io[0];xhr={aborted:0,responseText:null,responseXML:null,status:0,statusText:'n/a',getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(status){var e=(status==='timeout'?'timeout':'aborted');log('aborting upload... '+e);this.aborted=1;try{if(io.contentWindow.document.execCommand){io.contentWindow.document.execCommand('Stop');}}
catch(ignore){}
$io.attr('src',s.iframeSrc);xhr.error=e;if(s.error){s.error.call(s.context,xhr,e,status);}
if(g){$.event.trigger("ajaxError",[xhr,s,e]);}
if(s.complete){s.complete.call(s.context,xhr,e);}}};g=s.global;if(g&&0===$.active++){$.event.trigger("ajaxStart");}
if(g){$.event.trigger("ajaxSend",[xhr,s]);}
if(s.beforeSend&&s.beforeSend.call(s.context,xhr,s)===false){if(s.global){$.active--;}
deferred.reject();return deferred;}
if(xhr.aborted){deferred.reject();return deferred;}
sub=form.clk;if(sub){n=sub.name;if(n&&!sub.disabled){s.extraData=s.extraData||{};s.extraData[n]=sub.value;if(sub.type=="image"){s.extraData[n+'.x']=form.clk_x;s.extraData[n+'.y']=form.clk_y;}}}
var CLIENT_TIMEOUT_ABORT=1;var SERVER_ABORT=2;function getDoc(frame){var doc=null;try{if(frame.contentWindow){doc=frame.contentWindow.document;}}catch(err){log('cannot get iframe.contentWindow document: '+err);}
if(doc){return doc;}
try{doc=frame.contentDocument?frame.contentDocument:frame.document;}catch(err){log('cannot get iframe.contentDocument: '+err);doc=frame.document;}
return doc;}
var csrf_token=$('meta[name=csrf-token]').attr('content');var csrf_param=$('meta[name=csrf-param]').attr('content');if(csrf_param&&csrf_token){s.extraData=s.extraData||{};s.extraData[csrf_param]=csrf_token;}
function doSubmit(){var t=$form.attr2('target'),a=$form.attr2('action'),mp='multipart/form-data',et=$form.attr('enctype')||$form.attr('encoding')||mp;form.setAttribute('target',id);if(!method||/post/i.test(method)){form.setAttribute('method','POST');}
if(a!=s.url){form.setAttribute('action',s.url);}
if(!s.skipEncodingOverride&&(!method||/post/i.test(method))){$form.attr({encoding:'multipart/form-data',enctype:'multipart/form-data'});}
if(s.timeout){timeoutHandle=setTimeout(function(){timedOut=true;cb(CLIENT_TIMEOUT_ABORT);},s.timeout);}
function checkState(){try{var state=getDoc(io).readyState;log('state = '+state);if(state&&state.toLowerCase()=='uninitialized'){setTimeout(checkState,50);}}
catch(e){log('Server abort: ',e,' (',e.name,')');cb(SERVER_ABORT);if(timeoutHandle){clearTimeout(timeoutHandle);}
timeoutHandle=undefined;}}
var extraInputs=[];try{if(s.extraData){for(var n in s.extraData){if(s.extraData.hasOwnProperty(n)){if($.isPlainObject(s.extraData[n])&&s.extraData[n].hasOwnProperty('name')&&s.extraData[n].hasOwnProperty('value')){extraInputs.push($('<input type="hidden" name="'+s.extraData[n].name+'">').val(s.extraData[n].value).appendTo(form)[0]);}else{extraInputs.push($('<input type="hidden" name="'+n+'">').val(s.extraData[n]).appendTo(form)[0]);}}}}
if(!s.iframeTarget){$io.appendTo('body');}
if(io.attachEvent){io.attachEvent('onload',cb);}
else{io.addEventListener('load',cb,false);}
setTimeout(checkState,15);try{form.submit();}catch(err){var submitFn=document.createElement('form').submit;submitFn.apply(form);}}
finally{form.setAttribute('action',a);form.setAttribute('enctype',et);if(t){form.setAttribute('target',t);}else{$form.removeAttr('target');}
$(extraInputs).remove();}}
if(s.forceSync){doSubmit();}
else{setTimeout(doSubmit,10);}
var data,doc,domCheckCount=50,callbackProcessed;function cb(e){if(xhr.aborted||callbackProcessed){return;}
doc=getDoc(io);if(!doc){log('cannot access response document');e=SERVER_ABORT;}
if(e===CLIENT_TIMEOUT_ABORT&&xhr){xhr.abort('timeout');deferred.reject(xhr,'timeout');return;}
else if(e==SERVER_ABORT&&xhr){xhr.abort('server abort');deferred.reject(xhr,'error','server abort');return;}
if(!doc||doc.location.href==s.iframeSrc){if(!timedOut){return;}}
if(io.detachEvent){io.detachEvent('onload',cb);}
else{io.removeEventListener('load',cb,false);}
var status='success',errMsg;try{if(timedOut){throw'timeout';}
var isXml=s.dataType=='xml'||doc.XMLDocument||$.isXMLDoc(doc);log('isXml='+isXml);if(!isXml&&window.opera&&(doc.body===null||!doc.body.innerHTML)){if(--domCheckCount){log('requeing onLoad callback, DOM not available');setTimeout(cb,250);return;}}
var docRoot=doc.body?doc.body:doc.documentElement;xhr.responseText=docRoot?docRoot.innerHTML:null;xhr.responseXML=doc.XMLDocument?doc.XMLDocument:doc;if(isXml){s.dataType='xml';}
xhr.getResponseHeader=function(header){var headers={'content-type':s.dataType};return headers[header.toLowerCase()];};if(docRoot){xhr.status=Number(docRoot.getAttribute('status'))||xhr.status;xhr.statusText=docRoot.getAttribute('statusText')||xhr.statusText;}
var dt=(s.dataType||'').toLowerCase();var scr=/(json|script|text)/.test(dt);if(scr||s.textarea){var ta=doc.getElementsByTagName('textarea')[0];if(ta){xhr.responseText=ta.value;xhr.status=Number(ta.getAttribute('status'))||xhr.status;xhr.statusText=ta.getAttribute('statusText')||xhr.statusText;}
else if(scr){var pre=doc.getElementsByTagName('pre')[0];var b=doc.getElementsByTagName('body')[0];if(pre){xhr.responseText=pre.textContent?pre.textContent:pre.innerText;}
else if(b){xhr.responseText=b.textContent?b.textContent:b.innerText;}}}
else if(dt=='xml'&&!xhr.responseXML&&xhr.responseText){xhr.responseXML=toXml(xhr.responseText);}
try{data=httpData(xhr,dt,s);}
catch(err){status='parsererror';xhr.error=errMsg=(err||status);}}
catch(err){log('error caught: ',err);status='error';xhr.error=errMsg=(err||status);}
if(xhr.aborted){log('upload aborted');status=null;}
if(xhr.status){status=(xhr.status>=200&&xhr.status<300||xhr.status===304)?'success':'error';}
if(status==='success'){if(s.success){s.success.call(s.context,data,'success',xhr);}
deferred.resolve(xhr.responseText,'success',xhr);if(g){$.event.trigger("ajaxSuccess",[xhr,s]);}}
else if(status){if(errMsg===undefined){errMsg=xhr.statusText;}
if(s.error){s.error.call(s.context,xhr,status,errMsg);}
deferred.reject(xhr,'error',errMsg);if(g){$.event.trigger("ajaxError",[xhr,s,errMsg]);}}
if(g){$.event.trigger("ajaxComplete",[xhr,s]);}
if(g&&!--$.active){$.event.trigger("ajaxStop");}
if(s.complete){s.complete.call(s.context,xhr,status);}
callbackProcessed=true;if(s.timeout){clearTimeout(timeoutHandle);}
setTimeout(function(){if(!s.iframeTarget){$io.remove();}
else{$io.attr('src',s.iframeSrc);}
xhr.responseXML=null;},100);}
var toXml=$.parseXML||function(s,doc){if(window.ActiveXObject){doc=new ActiveXObject('Microsoft.XMLDOM');doc.async='false';doc.loadXML(s);}
else{doc=(new DOMParser()).parseFromString(s,'text/xml');}
return(doc&&doc.documentElement&&doc.documentElement.nodeName!='parsererror')?doc:null;};var parseJSON=$.parseJSON||function(s){return window['eval']('('+s+')');};var httpData=function(xhr,type,s){var ct=xhr.getResponseHeader('content-type')||'',xml=type==='xml'||!type&&ct.indexOf('xml')>=0,data=xml?xhr.responseXML:xhr.responseText;if(xml&&data.documentElement.nodeName==='parsererror'){if($.error){$.error('parsererror');}}
if(s&&s.dataFilter){data=s.dataFilter(data,type);}
if(typeof data==='string'){if(type==='json'||!type&&ct.indexOf('json')>=0){data=parseJSON(data);}else if(type==="script"||!type&&ct.indexOf("javascript")>=0){$.globalEval(data);}}
return data;};return deferred;}};$.fn.ajaxForm=function(options){options=options||{};options.delegation=options.delegation&&$.isFunction($.fn.on);if(!options.delegation&&this.length===0){var o={s:this.selector,c:this.context};if(!$.isReady&&o.s){log('DOM not ready, queuing ajaxForm');$(function(){$(o.s,o.c).ajaxForm(options);});return this;}
log('terminating; zero elements found by selector'+($.isReady?'':' (DOM not ready)'));return this;}
if(options.delegation){$(document).off('submit.form-plugin',this.selector,doAjaxSubmit).off('click.form-plugin',this.selector,captureSubmittingElement).on('submit.form-plugin',this.selector,options,doAjaxSubmit).on('click.form-plugin',this.selector,options,captureSubmittingElement);return this;}
return this.ajaxFormUnbind().bind('submit.form-plugin',options,doAjaxSubmit).bind('click.form-plugin',options,captureSubmittingElement);};function doAjaxSubmit(e){var options=e.data;if(!e.isDefaultPrevented()){e.preventDefault();$(e.target).ajaxSubmit(options);}}
function captureSubmittingElement(e){var target=e.target;var $el=$(target);if(!($el.is("[type=submit],[type=image]"))){var t=$el.closest('[type=submit]');if(t.length===0){return;}
target=t[0];}
var form=this;form.clk=target;if(target.type=='image'){if(e.offsetX!==undefined){form.clk_x=e.offsetX;form.clk_y=e.offsetY;}else if(typeof $.fn.offset=='function'){var offset=$el.offset();form.clk_x=e.pageX-offset.left;form.clk_y=e.pageY-offset.top;}else{form.clk_x=e.pageX-target.offsetLeft;form.clk_y=e.pageY-target.offsetTop;}}
setTimeout(function(){form.clk=form.clk_x=form.clk_y=null;},100);}
$.fn.ajaxFormUnbind=function(){return this.unbind('submit.form-plugin click.form-plugin');};$.fn.formToArray=function(semantic,elements){var a=[];if(this.length===0){return a;}
var form=this[0];var formId=this.attr('id');var els=semantic?form.getElementsByTagName('*'):form.elements;var els2;if(els&&!/MSIE [678]/.test(navigator.userAgent)){els=$(els).get();}
if(formId){els2=$(':input[form="'+formId+'"]').get();if(els2.length){els=(els||[]).concat(els2);}}
if(!els||!els.length){return a;}
var i,j,n,v,el,max,jmax;for(i=0,max=els.length;i<max;i++){el=els[i];n=el.name;if(!n||el.disabled){continue;}
if(semantic&&form.clk&&el.type=="image"){if(form.clk==el){a.push({name:n,value:$(el).val(),type:el.type});a.push({name:n+'.x',value:form.clk_x},{name:n+'.y',value:form.clk_y});}
continue;}
v=$.fieldValue(el,true);if(v&&v.constructor==Array){if(elements){elements.push(el);}
for(j=0,jmax=v.length;j<jmax;j++){a.push({name:n,value:v[j]});}}
else if(feature.fileapi&&el.type=='file'){if(elements){elements.push(el);}
var files=el.files;if(files.length){for(j=0;j<files.length;j++){a.push({name:n,value:files[j],type:el.type});}}
else{a.push({name:n,value:'',type:el.type});}}
else if(v!==null&&typeof v!='undefined'){if(elements){elements.push(el);}
a.push({name:n,value:v,type:el.type,required:el.required});}}
if(!semantic&&form.clk){var $input=$(form.clk),input=$input[0];n=input.name;if(n&&!input.disabled&&input.type=='image'){a.push({name:n,value:$input.val()});a.push({name:n+'.x',value:form.clk_x},{name:n+'.y',value:form.clk_y});}}
return a;};$.fn.formSerialize=function(semantic){return $.param(this.formToArray(semantic));};$.fn.fieldSerialize=function(successful){var a=[];this.each(function(){var n=this.name;if(!n){return;}
var v=$.fieldValue(this,successful);if(v&&v.constructor==Array){for(var i=0,max=v.length;i<max;i++){a.push({name:n,value:v[i]});}}
else if(v!==null&&typeof v!='undefined'){a.push({name:this.name,value:v});}});return $.param(a);};$.fn.fieldValue=function(successful){for(var val=[],i=0,max=this.length;i<max;i++){var el=this[i];var v=$.fieldValue(el,successful);if(v===null||typeof v=='undefined'||(v.constructor==Array&&!v.length)){continue;}
if(v.constructor==Array){$.merge(val,v);}
else{val.push(v);}}
return val;};$.fieldValue=function(el,successful){var n=el.name,t=el.type,tag=el.tagName.toLowerCase();if(successful===undefined){successful=true;}
if(successful&&(!n||el.disabled||t=='reset'||t=='button'||(t=='checkbox'||t=='radio')&&!el.checked||(t=='submit'||t=='image')&&el.form&&el.form.clk!=el||tag=='select'&&el.selectedIndex==-1)){return null;}
if(tag=='select'){var index=el.selectedIndex;if(index<0){return null;}
var a=[],ops=el.options;var one=(t=='select-one');var max=(one?index+1:ops.length);for(var i=(one?index:0);i<max;i++){var op=ops[i];if(op.selected){var v=op.value;if(!v){v=(op.attributes&&op.attributes.value&&!(op.attributes.value.specified))?op.text:op.value;}
if(one){return v;}
a.push(v);}}
return a;}
return $(el).val();};$.fn.clearForm=function(includeHidden){return this.each(function(){$('input,select,textarea',this).clearFields(includeHidden);});};$.fn.clearFields=$.fn.clearInputs=function(includeHidden){var re=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var t=this.type,tag=this.tagName.toLowerCase();if(re.test(t)||tag=='textarea'){this.value='';}
else if(t=='checkbox'||t=='radio'){this.checked=false;}
else if(tag=='select'){this.selectedIndex=-1;}
else if(t=="file"){if(/MSIE/.test(navigator.userAgent)){$(this).replaceWith($(this).clone(true));}else{$(this).val('');}}
else if(includeHidden){if((includeHidden===true&&/hidden/.test(t))||(typeof includeHidden=='string'&&$(this).is(includeHidden))){this.value='';}}});};$.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=='function'||(typeof this.reset=='object'&&!this.reset.nodeType)){this.reset();}});};$.fn.enable=function(b){if(b===undefined){b=true;}
return this.each(function(){this.disabled=!b;});};$.fn.selected=function(select){if(select===undefined){select=true;}
return this.each(function(){var t=this.type;if(t=='checkbox'||t=='radio'){this.checked=select;}
else if(this.tagName.toLowerCase()=='option'){var $sel=$(this).parent('select');if(select&&$sel[0]&&$sel[0].type=='select-one'){$sel.find('option').selected(false);}
this.selected=select;}});};$.fn.ajaxSubmit.debug=false;function log(){if(!$.fn.ajaxSubmit.debug){return;}
var msg='[jquery.form] '+Array.prototype.join.call(arguments,'');if(window.console&&window.console.log){window.console.log(msg);}
else if(window.opera&&window.opera.postError){window.opera.postError(msg);}}}));;﻿(function($,len,createRange,duplicate){$.fn.caret=function(options,opt2){try{var start,end,t=this[0],browser=$.browser.msie;if(typeof options==="object"&&typeof options.start==="number"&&typeof options.end==="number"){start=options.start;end=options.end;}else if(typeof options==="number"&&typeof opt2==="number"){start=options;end=opt2;}else if(typeof options==="string"){if((start=t.value.indexOf(options))>-1)end=start+options[len];else start=null;}else if(Object.prototype.toString.call(options)==="[object RegExp]"){var re=options.exec(t.value);if(re!=null){start=re.index;end=start+re[0][len];}}
if(typeof start!="undefined"){if(browser){var selRange=this[0].createTextRange();selRange.collapse(true);selRange.moveStart('character',start);selRange.moveEnd('character',end-start);selRange.select();}else{this[0].selectionStart=start;this[0].selectionEnd=end;}
this[0].focus();return this}else{if(browser)
{var selection=document.selection;if(this[0].tagName.toLowerCase()!="textarea"){var val=this.val(),range=selection[createRange]()[duplicate]();range.moveEnd("character",val[len]);var s=(range.text==""?val[len]:val.lastIndexOf(range.text));range=selection[createRange]()[duplicate]();range.moveStart("character",-val[len]);var e=range.text[len];}else{var range=selection[createRange](),stored_range=range[duplicate]();stored_range.moveToElementText(this[0]);stored_range.setEndPoint('EndToEnd',range);var s=stored_range.text[len]-range.text[len],e=s+range.text[len]}}else{var s=t.selectionStart,e=t.selectionEnd;}
var te=t.value.substring(s,e);return{start:s,end:e,text:te,replace:function(st){return t.value.substring(0,s)+st+t.value.substring(e,t.value[len])}}}}catch(e){}
return{start:0,end:0,text:''};}})(jsynchat,"length","createRange","duplicate");;;(function($){var DEFAULT_SETTINGS={method:"GET",queryParam:"q",searchDelay:300,minChars:1,propertyToSearch:"name",jsonContainer:null,contentType:"json",excludeCurrent:false,excludeCurrentParameter:"x",prePopulate:null,processPrePopulate:false,hintText:"Type in a search term",noResultsText:"No results",searchingText:"Searching...",deleteText:"&#215;",animateDropdown:true,placeholder:null,theme:null,zindex:2099,resultsLimit:null,enableHTML:false,resultsFormatter:function(item){var string=item[this.propertyToSearch];return"<li>"+(this.enableHTML?string:_escapeHTML(string))+"</li>";},tokenFormatter:function(item){var string=item[this.propertyToSearch];return"<li><p>"+(this.enableHTML?string:_escapeHTML(string))+"</p></li>";},tokenLimit:null,tokenDelimiter:",",preventDuplicates:false,tokenValue:"id",allowFreeTagging:false,allowTabOut:false,autoSelectFirstResult:false,onResult:null,onCachedResult:null,onAdd:null,onFreeTaggingAdd:null,onDelete:null,onReady:null,idPrefix:"token-input-",disabled:false};var DEFAULT_CLASSES={tokenList:"token-input-list",token:"token-input-token",tokenReadOnly:"token-input-token-readonly",tokenDelete:"token-input-delete-token",selectedToken:"token-input-selected-token",highlightedToken:"token-input-highlighted-token",dropdown:"token-input-dropdown",dropdownItem:"token-input-dropdown-item",dropdownItem2:"token-input-dropdown-item2",selectedDropdownItem:"token-input-selected-dropdown-item",inputToken:"token-input-input-token",focused:"token-input-focused",disabled:"token-input-disabled"};var POSITION={BEFORE:0,AFTER:1,END:2};var KEY={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUMPAD_ENTER:108,COMMA:188};var HTML_ESCAPES={'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#x27;','/':'&#x2F;'};var HTML_ESCAPE_CHARS=/[&<>"'\/]/g;function coerceToString(val){return String((val===null||val===undefined)?'':val);}
function _escapeHTML(text){return coerceToString(text).replace(HTML_ESCAPE_CHARS,function(match){return HTML_ESCAPES[match];});}
var methods={init:function(url_or_data_or_function,options){var settings=$.extend({},DEFAULT_SETTINGS,options||{});return this.each(function(){$(this).data("settings",settings);$(this).data("tokenInputObject",new $.TokenList(this,url_or_data_or_function,settings));});},clear:function(){this.data("tokenInputObject").clear();return this;},add:function(item){this.data("tokenInputObject").add(item);return this;},remove:function(item){this.data("tokenInputObject").remove(item);return this;},get:function(){return this.data("tokenInputObject").getTokens();},toggleDisabled:function(disable){this.data("tokenInputObject").toggleDisabled(disable);return this;},setOptions:function(options){$(this).data("settings",$.extend({},$(this).data("settings"),options||{}));return this;},destroy:function(){if(this.data("tokenInputObject")){this.data("tokenInputObject").clear();var tmpInput=this;var closest=this.parent();closest.empty();tmpInput.show();closest.append(tmpInput);return tmpInput;}}};$.fn.tokenInput=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1));}else{return methods.init.apply(this,arguments);}};$.TokenList=function(input,url_or_data,settings){if(typeof(url_or_data)==="string"||typeof(url_or_data)==="function"){$(input).data("settings").url=url_or_data;var url=computeURL();if($(input).data("settings").crossDomain===undefined&&typeof url==="string"){if(url.indexOf("://")===-1){$(input).data("settings").crossDomain=false;}else{$(input).data("settings").crossDomain=(location.href.split(/\/+/g)[1]!==url.split(/\/+/g)[1]);}}}else if(typeof(url_or_data)==="object"){$(input).data("settings").local_data=url_or_data;}
if($(input).data("settings").classes){$(input).data("settings").classes=$.extend({},DEFAULT_CLASSES,$(input).data("settings").classes);}else if($(input).data("settings").theme){$(input).data("settings").classes={};$.each(DEFAULT_CLASSES,function(key,value){$(input).data("settings").classes[key]=value+"-"+$(input).data("settings").theme;});}else{$(input).data("settings").classes=DEFAULT_CLASSES;}
var saved_tokens=[];var token_count=0;var cache=new $.TokenList.Cache();var timeout;var input_val;var input_box=$("<input type=\"text\" autocomplete=\"off\" autocapitalize=\"off\" class=\"form-control\"/>").css({outline:"none"}).attr("id",$(input).data("settings").idPrefix+input.id).focus(function(){if($(input).data("settings").disabled){return false;}else
if($(input).data("settings").tokenLimit===null||$(input).data("settings").tokenLimit!==token_count){show_dropdown_hint();}
token_list.addClass($(input).data("settings").classes.focused);}).blur(function(){hide_dropdown();if($(input).data("settings").allowFreeTagging){add_freetagging_tokens();}
$(this).val("");token_list.removeClass($(input).data("settings").classes.focused);}).bind("keyup keydown blur update",resize_input).keydown(function(event){var previous_token;var next_token;switch(event.keyCode){case KEY.LEFT:case KEY.RIGHT:case KEY.UP:case KEY.DOWN:if(this.value.length===0){}else{var dropdown_item=null;if(event.keyCode===KEY.DOWN||event.keyCode===KEY.RIGHT){dropdown_item=$(dropdown).find('li').first();if(selected_dropdown_item){dropdown_item=$(selected_dropdown_item).next();}}else{dropdown_item=$(dropdown).find('li').last();if(selected_dropdown_item){dropdown_item=$(selected_dropdown_item).prev();}}
select_dropdown_item(dropdown_item);}
break;case KEY.BACKSPACE:previous_token=input_token.prev();if(this.value.length===0){if(selected_token){delete_token($(selected_token));hiddenInput.change();}else if(previous_token.length){select_token($(previous_token.get(0)));}
return false;}else if($(this).val().length===1){hide_dropdown();}else{setTimeout(function(){do_search();},5);}
break;case KEY.TAB:case KEY.ENTER:case KEY.NUMPAD_ENTER:case KEY.COMMA:if(selected_dropdown_item){add_token($(selected_dropdown_item).data("tokeninput"));hiddenInput.change();}else{if($(input).data("settings").allowFreeTagging){if($(input).data("settings").allowTabOut&&$(this).val()===""){return true;}else{add_freetagging_tokens();}}else{$(this).val("");if($(input).data("settings").allowTabOut){return true;}}
event.stopPropagation();event.preventDefault();}
return false;case KEY.ESCAPE:hide_dropdown();return true;default:if(String.fromCharCode(event.which)){setTimeout(function(){do_search();},5);}
break;}});if(settings.placeholder){input_box.attr("placeholder",settings.placeholder);}
var hiddenInput=$(input).hide().val("").focus(function(){focusWithTimeout(input_box);}).blur(function(){input_box.blur();return hiddenInput;});var selected_token=null;var selected_token_index=0;var selected_dropdown_item=null;var token_list=$("<ul />").addClass($(input).data("settings").classes.tokenList).click(function(event){var li=$(event.target).closest("li");if(li&&li.get(0)&&$.data(li.get(0),"tokeninput")){toggle_select_token(li);}else{if(selected_token){deselect_token($(selected_token),POSITION.END);}
focusWithTimeout(input_box);}}).mouseover(function(event){var li=$(event.target).closest("li");if(li&&selected_token!==this){li.addClass($(input).data("settings").classes.highlightedToken);}}).mouseout(function(event){var li=$(event.target).closest("li");if(li&&selected_token!==this){li.removeClass($(input).data("settings").classes.highlightedToken);}}).insertBefore(hiddenInput);var input_token=$("<li />").addClass($(input).data("settings").classes.inputToken).appendTo(token_list).append(input_box);var dropdown=$("<div/>").addClass($(input).data("settings").classes.dropdown).appendTo("div#ynchat-iframe-container .ynchat-popup-drop").hide();var input_resizer=$("<tester/>").insertAfter(input_box).css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:input_box.css("fontSize"),fontFamily:input_box.css("fontFamily"),fontWeight:input_box.css("fontWeight"),letterSpacing:input_box.css("letterSpacing"),whiteSpace:"nowrap"});hiddenInput.val("");var li_data=$(input).data("settings").prePopulate||hiddenInput.data("pre");if($(input).data("settings").processPrePopulate&&$.isFunction($(input).data("settings").onResult)){li_data=$(input).data("settings").onResult.call(hiddenInput,li_data);}
if(li_data&&li_data.length){$.each(li_data,function(index,value){insert_token(value);checkTokenLimit();input_box.attr("placeholder",null)});}
if($(input).data("settings").disabled){toggleDisabled(true);}
if(typeof($(input).data("settings").onReady)==="function"){$(input).data("settings").onReady.call();}
this.clear=function(){token_list.children("li").each(function(){if($(this).children("input").length===0){delete_token($(this));}});};this.add=function(item){add_token(item);};this.remove=function(item){token_list.children("li").each(function(){if($(this).children("input").length===0){var currToken=$(this).data("tokeninput");var match=true;for(var prop in item){if(item[prop]!==currToken[prop]){match=false;break;}}
if(match){delete_token($(this));}}});};this.getTokens=function(){return saved_tokens;};this.toggleDisabled=function(disable){toggleDisabled(disable);};resize_input();function escapeHTML(text){return $(input).data("settings").enableHTML?text:_escapeHTML(text);}
function toggleDisabled(disable){if(typeof disable==='boolean'){$(input).data("settings").disabled=disable}else{$(input).data("settings").disabled=!$(input).data("settings").disabled;}
input_box.attr('disabled',$(input).data("settings").disabled);token_list.toggleClass($(input).data("settings").classes.disabled,$(input).data("settings").disabled);if(selected_token){deselect_token($(selected_token),POSITION.END);}
hiddenInput.attr('disabled',$(input).data("settings").disabled);}
function checkTokenLimit(){if($(input).data("settings").tokenLimit!==null&&token_count>=$(input).data("settings").tokenLimit){input_box.hide();hide_dropdown();return;}}
function resize_input(){if(input_val===(input_val=input_box.val())){return;}
var width_left=token_list.width()-input_box.offset().left-token_list.offset().left;input_resizer.html(_escapeHTML(input_val)||_escapeHTML(settings.placeholder));input_box.width(Math.min(token_list.width(),Math.max(width_left,input_resizer.width()+30)));}
function add_freetagging_tokens(){var value=$.trim(input_box.val());var tokens=value.split($(input).data("settings").tokenDelimiter);$.each(tokens,function(i,token){if(!token){return;}
if($.isFunction($(input).data("settings").onFreeTaggingAdd)){token=$(input).data("settings").onFreeTaggingAdd.call(hiddenInput,token);}
var object={};object[$(input).data("settings").tokenValue]=object[$(input).data("settings").propertyToSearch]=token;add_token(object);});}
function insert_token(item){var $this_token=$($(input).data("settings").tokenFormatter(item));var readonly=item.readonly===true;if(readonly)$this_token.addClass($(input).data("settings").classes.tokenReadOnly);$this_token.addClass($(input).data("settings").classes.token).insertBefore(input_token);if(!readonly){$("<span>"+$(input).data("settings").deleteText+"</span>").addClass($(input).data("settings").classes.tokenDelete).appendTo($this_token).click(function(){if(!$(input).data("settings").disabled){delete_token($(this).parent());hiddenInput.change();return false;}});}
var token_data=item;$.data($this_token.get(0),"tokeninput",item);saved_tokens=saved_tokens.slice(0,selected_token_index).concat([token_data]).concat(saved_tokens.slice(selected_token_index));selected_token_index++;update_hiddenInput(saved_tokens,hiddenInput);token_count+=1;if($(input).data("settings").tokenLimit!==null&&token_count>=$(input).data("settings").tokenLimit){input_box.hide();hide_dropdown();}
return $this_token;}
function add_token(item){var callback=$(input).data("settings").onAdd;if(token_count>0&&$(input).data("settings").preventDuplicates){var found_existing_token=null;token_list.children().each(function(){var existing_token=$(this);var existing_data=$.data(existing_token.get(0),"tokeninput");if(existing_data&&existing_data[settings.tokenValue]===item[settings.tokenValue]){found_existing_token=existing_token;return false;}});if(found_existing_token){found_existing_token.addClass($(input).data("settings").classes.selectedToken);input_box.val("");hide_dropdown();return;}}
input_box.width(1);if($(input).data("settings").tokenLimit==null||token_count<$(input).data("settings").tokenLimit){insert_token(item);input_box.attr("placeholder",null);checkTokenLimit();}
input_box.val("");hide_dropdown();if($.isFunction(callback)){callback.call(hiddenInput,item);}}
function select_token(token){if(!$(input).data("settings").disabled){token.addClass($(input).data("settings").classes.selectedToken);selected_token=token.get(0);input_box.val("");hide_dropdown();}}
function deselect_token(token,position){token.removeClass($(input).data("settings").classes.selectedToken);selected_token=null;if(position===POSITION.BEFORE){input_token.insertBefore(token);selected_token_index--;}else if(position===POSITION.AFTER){input_token.insertAfter(token);selected_token_index++;}else{input_token.appendTo(token_list);selected_token_index=token_count;}
focusWithTimeout(input_box);}
function toggle_select_token(token){var previous_selected_token=selected_token;if(selected_token){deselect_token($(selected_token),POSITION.END);}
if(previous_selected_token===token.get(0)){deselect_token(token,POSITION.END);}else{select_token(token);}}
function delete_token(token){var token_data=$.data(token.get(0),"tokeninput");var callback=$(input).data("settings").onDelete;var index=token.prevAll().length;if(index>selected_token_index)index--;token.remove();selected_token=null;focusWithTimeout(input_box);saved_tokens=saved_tokens.slice(0,index).concat(saved_tokens.slice(index+1));if(saved_tokens.length==0){input_box.attr("placeholder",settings.placeholder)}
if(index<selected_token_index)selected_token_index--;update_hiddenInput(saved_tokens,hiddenInput);token_count-=1;if($(input).data("settings").tokenLimit!==null){input_box.show().val("");focusWithTimeout(input_box);}
if($.isFunction(callback)){callback.call(hiddenInput,token_data);}}
function update_hiddenInput(saved_tokens,hiddenInput){var token_values=$.map(saved_tokens,function(el){if(typeof $(input).data("settings").tokenValue=='function')
return $(input).data("settings").tokenValue.call(this,el);return el[$(input).data("settings").tokenValue];});hiddenInput.val(token_values.join($(input).data("settings").tokenDelimiter));}
function hide_dropdown(){dropdown.hide().empty();selected_dropdown_item=null;}
function show_dropdown(){var marinTop=parseInt(token_list.closest('.ynchat-popup').css("marginTop").replace('px',''));dropdown.css({position:"fixed",top:token_list.position().top+token_list.outerHeight()+marinTop,left:token_list.offset().left,width:token_list.width(),'z-index':$(input).data("settings").zindex}).show();}
function show_dropdown_searching(){if($(input).data("settings").searchingText){dropdown.html("<p>"+escapeHTML($(input).data("settings").searchingText)+"</p>");show_dropdown();}}
function show_dropdown_hint(){if($(input).data("settings").hintText){dropdown.html("<p>"+escapeHTML($(input).data("settings").hintText)+"</p>");show_dropdown();}}
var regexp_special_chars=new RegExp('[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\-]','g');function regexp_escape(term){return term.replace(regexp_special_chars,'\\$&');}
function highlight_term(value,term){return value.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+regexp_escape(term)+")(?![^<>]*>)(?![^&;]+;)","gi"),function(match,p1){return"<b>"+escapeHTML(p1)+"</b>";});}
function find_value_and_highlight_term(template,value,term){return template.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+regexp_escape(value)+")(?![^<>]*>)(?![^&;]+;)","g"),highlight_term(value,term));}
function excludeCurrent(results){if($(input).data("settings").excludeCurrent){var currentTokens=$(input).data("tokenInputObject").getTokens(),trimmedList=[];if(currentTokens.length){$.each(results,function(index,value){var notFound=true;$.each(currentTokens,function(cIndex,cValue){if(value[$(input).data("settings").propertyToSearch]==cValue[$(input).data("settings").propertyToSearch]){notFound=false;return false;}});if(notFound){trimmedList.push(value);}});results=trimmedList;}}
return results;}
function populateDropdown(query,results){results=excludeCurrent(results);if(results&&results.length){dropdown.empty();var dropdown_ul=$("<ul/>").appendTo(dropdown).mouseover(function(event){select_dropdown_item($(event.target).closest("li"));}).mousedown(function(event){add_token($(event.target).closest("li").data("tokeninput"));hiddenInput.change();return false;}).hide();if($(input).data("settings").resultsLimit&&results.length>$(input).data("settings").resultsLimit){results=results.slice(0,$(input).data("settings").resultsLimit);}
$.each(results,function(index,value){var this_li=$(input).data("settings").resultsFormatter(value);this_li=find_value_and_highlight_term(this_li,value[$(input).data("settings").propertyToSearch],query);this_li=$(this_li).appendTo(dropdown_ul);if(index%2){this_li.addClass($(input).data("settings").classes.dropdownItem);}else{this_li.addClass($(input).data("settings").classes.dropdownItem2);}
if(index===0&&$(input).data("settings").autoSelectFirstResult){select_dropdown_item(this_li);}
$.data(this_li.get(0),"tokeninput",value);});show_dropdown();if($(input).data("settings").animateDropdown){dropdown_ul.slideDown("fast");}else{dropdown_ul.show();}}else{if($(input).data("settings").noResultsText){dropdown.html("<p>"+escapeHTML($(input).data("settings").noResultsText)+"</p>");show_dropdown();}}}
function select_dropdown_item(item){if(item){if(selected_dropdown_item){deselect_dropdown_item($(selected_dropdown_item));}
item.addClass($(input).data("settings").classes.selectedDropdownItem);selected_dropdown_item=item.get(0);}}
function deselect_dropdown_item(item){item.removeClass($(input).data("settings").classes.selectedDropdownItem);selected_dropdown_item=null;}
function do_search(){var query=input_box.val();if(query&&query.length){if(selected_token){deselect_token($(selected_token),POSITION.AFTER);}
if(query.length>=$(input).data("settings").minChars){show_dropdown_searching();clearTimeout(timeout);timeout=setTimeout(function(){run_search(query);},$(input).data("settings").searchDelay);}else{hide_dropdown();}}}
function run_search(query){var cache_key=query+computeURL();var cached_results=cache.get(cache_key);if(cached_results){if($.isFunction($(input).data("settings").onCachedResult)){cached_results=$(input).data("settings").onCachedResult.call(hiddenInput,cached_results);}
populateDropdown(query,cached_results);}else{if($(input).data("settings").url){var url=computeURL();var ajax_params={};ajax_params.data={};if(url.indexOf("?")>-1){var parts=url.split("?");ajax_params.url=parts[0];var param_array=parts[1].split("&");$.each(param_array,function(index,value){var kv=value.split("=");ajax_params.data[kv[0]]=kv[1];});}else{ajax_params.url=url;}
ajax_params.data[$(input).data("settings").queryParam]=query;ajax_params.type=$(input).data("settings").method;ajax_params.dataType=$(input).data("settings").contentType;if($(input).data("settings").crossDomain){ajax_params.dataType="jsonp";}
if($(input).data("settings").excludeCurrent){var currentTokens=$(input).data("tokenInputObject").getTokens();var tokenList=$.map(currentTokens,function(el){if(typeof $(input).data("settings").tokenValue=='function')
return $(input).data("settings").tokenValue.call(this,el);return el[$(input).data("settings").tokenValue];});ajax_params.data[$(input).data("settings").excludeCurrentParameter]=tokenList.join($(input).data("settings").tokenDelimiter);}
ajax_params.success=function(results){cache.add(cache_key,$(input).data("settings").jsonContainer?results[$(input).data("settings").jsonContainer]:results);if($.isFunction($(input).data("settings").onResult)){results=$(input).data("settings").onResult.call(hiddenInput,results);}
if(input_box.val()===query){populateDropdown(query,$(input).data("settings").jsonContainer?results[$(input).data("settings").jsonContainer]:results);}};if(settings.onSend){settings.onSend(ajax_params);}
$.ajax(ajax_params);}else if($(input).data("settings").local_data){var results=$.grep($(input).data("settings").local_data,function(row){return row[$(input).data("settings").propertyToSearch].toLowerCase().indexOf(query.toLowerCase())>-1;});cache.add(cache_key,results);if($.isFunction($(input).data("settings").onResult)){results=$(input).data("settings").onResult.call(hiddenInput,results);}
populateDropdown(query,results);}}}
function computeURL(){var url=$(input).data("settings").url;if(typeof $(input).data("settings").url=='function'){url=$(input).data("settings").url.call($(input).data("settings"));}
return url;}
function focusWithTimeout(object){setTimeout(function(){object.focus();},50);}};$.TokenList.Cache=function(options){var settings,data={},size=0,flush;settings=$.extend({max_size:500},options);flush=function(){data={};size=0;};this.add=function(query,results){if(size>settings.max_size){flush();}
if(!data[query]){size+=1;}
data[query]=results;};this.get=function(query){return data[query];};};}(jsynchat));;;(function($,undefined){'use strict';var fls=!1,nll=null,prsflt=parseFloat,mathmn=Math.min,rxLastNr=/(-?\d+\.?\d*)$/g,rxLastNrNoDash=/(\d+\.?\d*)$/g,aPluginPrepare=[],aPluginSort=[],isString=function(o){return typeof o=='string';},loop=function(array,func){var l=array.length,i=l,j;while(i--){j=l-i-1;func(array[j],j);}},fnIndexOf=Array.prototype.indexOf||function(elm){var len=this.length,from=Number(arguments[1])||0;from=from<0?Math.ceil(from):Math.floor(from);if(from<0)from+=len;for(;from<len;from++){if(from in this&&this[from]===elm)return from;}
return-1;};$.tinysort={id:'TinySort',version:'1.5.6',copyright:'Copyright (c) 2008-2013 Ron Valstar',uri:'http://tinysort.sjeiti.com/',licensed:{MIT:'http://www.opensource.org/licenses/mit-license.php',GPL:'http://www.gnu.org/licenses/gpl.html'},plugin:(function(){var fn=function(prepare,sort){aPluginPrepare.push(prepare);aPluginSort.push(sort);};fn.indexOf=fnIndexOf;return fn;})(),defaults:{order:'asc',attr:nll,data:nll,useVal:fls,place:'start',returns:fls,cases:fls,forceStrings:fls,ignoreDashes:fls,sortFunction:nll}};$.fn.extend({tinysort:function(){var i,j,l,oThis=this,aNewOrder=[],aElements=[],aElementsParent=[],aCriteria=[],iCriteria=0,iCriteriaMax,aFind=[],aSettings=[],fnPluginPrepare=function(_settings){loop(aPluginPrepare,function(fn){fn.call(fn,_settings);});},fnPrepareSortElement=function(settings,element){if(typeof element=='string'){if(!settings.cases)element=toLowerCase(element);element=element.replace(/^\s*(.*?)\s*$/i,'$1');}
return element;},fnSort=function(a,b){var iReturn=0;if(iCriteria!==0)iCriteria=0;while(iReturn===0&&iCriteria<iCriteriaMax){var oPoint=aCriteria[iCriteria],oSett=oPoint.oSettings,rxLast=oSett.ignoreDashes?rxLastNrNoDash:rxLastNr;fnPluginPrepare(oSett);if(oSett.sortFunction){iReturn=oSett.sortFunction(a,b);}else if(oSett.order=='rand'){iReturn=Math.random()<0.5?1:-1;}else{var bNumeric=fls,sA=fnPrepareSortElement(oSett,a.s[iCriteria]),sB=fnPrepareSortElement(oSett,b.s[iCriteria]);if(!oSett.forceStrings){var aAnum=isString(sA)?sA&&sA.match(rxLast):fls,aBnum=isString(sB)?sB&&sB.match(rxLast):fls;if(aAnum&&aBnum){var sAprv=sA.substr(0,sA.length-aAnum[0].length),sBprv=sB.substr(0,sB.length-aBnum[0].length);if(sAprv==sBprv){bNumeric=!fls;sA=prsflt(aAnum[0]);sB=prsflt(aBnum[0]);}}}
iReturn=oPoint.iAsc*(sA<sB?-1:(sA>sB?1:0));}
loop(aPluginSort,function(fn){iReturn=fn.call(fn,bNumeric,sA,sB,iReturn);});if(iReturn===0)iCriteria++;}
return iReturn;};for(i=0,l=arguments.length;i<l;i++){var o=arguments[i];if(isString(o)){if(aFind.push(o)-1>aSettings.length)aSettings.length=aFind.length-1;}else{if(aSettings.push(o)>aFind.length)aFind.length=aSettings.length;}}
if(aFind.length>aSettings.length)aSettings.length=aFind.length;iCriteriaMax=aFind.length;if(iCriteriaMax===0){iCriteriaMax=aFind.length=1;aSettings.push({});}
for(i=0,l=iCriteriaMax;i<l;i++){var sFind=aFind[i],oSettings=$.extend({},$.tinysort.defaults,aSettings[i]),bFind=!(!sFind||sFind===''),bFilter=bFind&&sFind[0]===':';aCriteria.push({sFind:sFind,oSettings:oSettings,bFind:bFind,bAttr:!(oSettings.attr===nll||oSettings.attr===''),bData:oSettings.data!==nll,bFilter:bFilter,$Filter:bFilter?oThis.filter(sFind):oThis,fnSort:oSettings.sortFunction,iAsc:oSettings.order=='asc'?1:-1});}
oThis.each(function(i,el){var $Elm=$(el),mParent=$Elm.parent().get(0),mFirstElmOrSub,aSort=[];for(j=0;j<iCriteriaMax;j++){var oPoint=aCriteria[j],mElmOrSub=oPoint.bFind?(oPoint.bFilter?oPoint.$Filter.filter(el):$Elm.find(oPoint.sFind)):$Elm;aSort.push(oPoint.bData?mElmOrSub.data(oPoint.oSettings.data):(oPoint.bAttr?mElmOrSub.attr(oPoint.oSettings.attr):(oPoint.oSettings.useVal?mElmOrSub.val():mElmOrSub.text())));if(mFirstElmOrSub===undefined)mFirstElmOrSub=mElmOrSub;}
var iElmIndex=fnIndexOf.call(aElementsParent,mParent);if(iElmIndex<0){iElmIndex=aElementsParent.push(mParent)-1;aElements[iElmIndex]={s:[],n:[]};}
if(mFirstElmOrSub.length>0)aElements[iElmIndex].s.push({s:aSort,e:$Elm,n:i});else aElements[iElmIndex].n.push({e:$Elm,n:i});});loop(aElements,function(oParent){oParent.s.sort(fnSort);});loop(aElements,function(oParent){var aSorted=oParent.s,aUnsorted=oParent.n,iSorted=aSorted.length,iUnsorted=aUnsorted.length,iNumElm=iSorted+iUnsorted,aOriginal=[],iLow=iNumElm,aCount=[0,0];switch(oSettings.place){case'first':loop(aSorted,function(obj){iLow=mathmn(iLow,obj.n);});break;case'org':loop(aSorted,function(obj){aOriginal.push(obj.n);});break;case'end':iLow=iUnsorted;break;default:iLow=0;}
for(i=0;i<iNumElm;i++){var bFromSortList=contains(aOriginal,i)?!fls:i>=iLow&&i<iLow+iSorted,iCountIndex=bFromSortList?0:1,mEl=(bFromSortList?aSorted:aUnsorted)[aCount[iCountIndex]].e;mEl.parent().append(mEl);if(bFromSortList||!oSettings.returns)aNewOrder.push(mEl.get(0));aCount[iCountIndex]++;}});oThis.length=0;Array.prototype.push.apply(oThis,aNewOrder);return oThis;}});function toLowerCase(s){return s&&s.toLowerCase?s.toLowerCase():s;}
function contains(a,n){for(var i=0,l=a.length;i<l;i++)if(a[i]==n)return!fls;return fls;}
$.fn.TinySort=$.fn.Tinysort=$.fn.tsort=$.fn.tinysort;})(jsynchat);(function(t){var e={key:null,endpoint:"oembed",secure:null,query:{},method:"replace",addImageStyles:!0,wrapElement:"div",className:"embed",batch:20,urlRe:null},i=/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/,r=function(t){return null===t||void 0===t},n=function(e,i){var r=[],n=[];return t.each(e,function(t,e){n.push(e),n.length===i&&(r.push(n),n=[])}),0!==n.length&&r.push(n),r},s=function(e){return r(e)?[]:t.isArray(e)?e:[e]},o=function(e){return t.map(e[0],function(i,r){return[t.map(e,function(t){return t[r]})]})},a=function(t,e,i){this.init(t,e,i)};a.prototype={init:function(e){this.urls=e,this.count=0,this.results={},this._deferred=t.Deferred()},notify:function(e){if(this.results[e.original_url]=e,this.count++,this._deferred.notify.apply(this._deferred,[e]),this.count===this.urls.length){var i=this,r=t.map(this.urls,function(t){return i.results[t]});this._deferred.resolve(r)}return this},state:function(){return this._deferred.state.apply(this._deferred,arguments)}},window.Keeper=a;var l=function(){};l.prototype={defaults:{},log:function(t,e){r(window.console)||r(window.console[t])||window.console[t].apply(window.console,[e])},build:function(e,i,n){n=r(n)?{}:n;var s=n.secure;r(s)&&(s="https:"===window.location.protocol?!0:!1);var o=(s?"https":"http")+"://api.embed.ly/"+("objectify"===e?"2/":"1/")+e,a=r(n.query)?{}:n.query;return a.key=n.key,o+="?"+t.param(a),o+="&urls="+t.map(i,encodeURIComponent).join(",")},ajax:function(l,h,u){if(u=t.extend({},e,t.embedly.defaults,"object"==typeof u&&u),r(u.key))return this.log("error","Embedly jQuery requires an API Key. Please sign up for one at http://embed.ly"),null;h=s(h);var d,p=new a(h),c=[],f=[];t.each(h,function(t,e){d=!1,i.test(e)&&(d=!0,null!==u.urlRe&&u.urlRe.test&&!u.urlRe.test(e)&&(d=!1)),d===!0?c.push(e):f.push({url:e,original_url:e,error:!0,invalid:!0,type:"error",error_message:'Invalid URL "'+e+'"'})});var y=n(c,u.batch),m=this;return t.each(y,function(e,i){t.ajax({url:m.build(l,i,u),dataType:"jsonp",success:function(e){t.each(o([i,e]),function(t,e){var i=e[1];i.original_url=e[0],i.invalid=!1,p.notify(i)})}})}),f.length&&setTimeout(function(){t.each(f,function(t,e){p.notify(e)})},1),p._deferred},oembed:function(t,e){return this.ajax("oembed",t,e)},preview:function(t,e){return this.ajax("preview",t,e)},objectify:function(t,e){return this.ajax("objectify",t,e)},extract:function(t,e){return this.ajax("extract",t,e)}};var h=function(){};h.prototype={build:function(e,i,n){n=t.extend({},t.embedly.defaults,"object"==typeof n&&n);var s=n.secure;r(s)&&(s="https:"===window.location.protocol?!0:!1);var o=(s?"https":"http")+"://i.embed.ly/"+("display"===e?"1/":"1/display/")+e,a=r(n.query)?{}:n.query;return a.key=n.key,o+="?"+t.param(a),o+="&url="+encodeURIComponent(i)},display:function(t,e){return this.build("display",t,e)},resize:function(t,e){return this.build("resize",t,e)},fill:function(t,e){return this.build("fill",t,e)},crop:function(t,e){return this.build("crop",t,e)}};var u=function(t,e,i){this.init(t,e,i)};u.prototype={init:function(e,i,r){this.elem=e,this.$elem=t(e),this.original_url=i,this.options=r,this.loaded=t.Deferred();var n=this;this.loaded.done(function(){n.$elem.trigger("loaded",[n])}),this.$elem.trigger("initialized",[this])},progress:function(e){t.extend(this,e),this.options.display?this.options.display.apply(this.elem,[this,this.elem]):"oembed"===this.options.endpoint&&this.display(),this.loaded.resolve(this)},imageStyle:function(){var t,e=[];return this.options.addImageStyles&&(this.options.query.maxwidth&&(t=isNaN(parseInt(this.options.query.maxwidth,10))?"":"px",e.push("max-width: "+this.options.query.maxwidth+t)),this.options.query.maxheight&&(t=isNaN(parseInt(this.options.query.maxheight,10))?"":"px",e.push("max-height: "+this.options.query.maxheight+t))),e.join(";")},display:function(){if("error"===this.type)return!1;this.style=this.imageStyle();var t;"photo"===this.type?(t="<a href='"+this.original_url+"' target='_blank'>",t+="<img style='"+this.style+"' src='"+this.url+"' alt='"+this.title+"' /></a>"):"video"===this.type||"rich"===this.type?t=this.html:(this.title=this.title||this.url,t=this.thumbnail_url?"<img src='"+this.thumbnail_url+"' class='thumb' style='"+this.style+"'/>":"",t+="<a href='"+this.original_url+"'>"+this.title+"</a>",t+=this.provider_name?"<a href='"+this.provider_url+"' class='provider'>"+this.provider_name+"</a>":"",t+=this.description?'<div class="description">'+this.description+"</div>":""),this.options.wrapElement&&(t="<"+this.options.wrapElement+' class="'+this.options.className+'">'+t+"</"+this.options.wrapElement+">"),this.code=t,"replace"===this.options.method?this.$elem.replaceWith(this.code):"after"===this.options.method?this.$elem.after(this.code):"afterParent"===this.options.method?this.$elem.parent().after(this.code):"replaceParent"===this.options.method&&this.$elem.parent().replaceWith(this.code),this.$elem.trigger("displayed",[this])}},t.embedly=new l,t.embedly.display=new h,t.fn.embedly=function(i){if(void 0===i||"object"==typeof i){if(i=t.extend({},e,t.embedly.defaults,"object"==typeof i&&i),r(i.key))return t.embedly.log("error","Embedly jQuery requires an API Key. Please sign up for one at http://embed.ly"),this.each(t.noop);var n={},s=function(e){if(!t.data(t(e),"embedly")){var r=t(e).attr("href"),s=new u(e,r,i);t.data(e,"embedly",s),n.hasOwnProperty(r)?n[r].push(s):n[r]=[s]}},o=this.each(function(){r(t(this).attr("href"))?t(this).find("a").each(function(){r(t(this).attr("href"))||s(this)}):s(this)}),a=t.embedly.ajax(i.endpoint,t.map(n,function(t,e){return e}),i).progress(function(e){t.each(n[e.original_url],function(t,i){i.progress(e)})});return i.progress&&a.progress(i.progress),i.done&&a.done(i.done),o}},t.expr[":"].embedly=function(e){return!r(t(e).data("embedly"))},t.fn.display=function(i,n){if(r(i)&&(i="display"),void 0===n||"object"==typeof n){if(n=t.extend({},e,t.embedly.defaults,"object"==typeof n&&n),r(n.key))return t.embedly.log("error","Embedly jQuery requires an API Key. Please sign up for one at http://embed.ly/display"),this.each(t.noop);var s=function(e){var r=t(e);if(!r.data("display")){var s=r.data("src")||r.attr("href"),o={original_url:s,url:t.embedly.display.build(i,s,n)};r.data("display",o),r.trigger("initialized",[e]);var a="<img src='"+o.url+"' />";r.is("a")?r.append(a):r.replaceWith(a)}},o=function(e){return r(t(e).data("src"))&&r(t(e).attr("href"))?!1:!0},a=this.each(function(){o(this)?s(this):t(this).find("img,a").each(function(){o(this)&&s(this)})});return a}},t.expr[":"].display=function(e){return!r(t(e).data("display"))}})(jsynchat,window);(function($)
{$.fn.extend({liveUrl:function(options)
{var defaults={meta:[['description','name','description'],['description','property','og:description'],['description','property','pinterestapp:about'],['image','property','og:image'],['image','itemprop','image'],['title','property','og:title'],['video','property','og:video'],['video_type','property','og:video:type'],['video_width','property','og:video:width'],['video_height','property','og:video:height']],findLogo:false,findDescription:true,matchNoData:true,multipleImages:true,defaultProtocol:'http://',minWidth:100,minHeight:32,logoWord:'logo',apiKeyEmbedly:'',eleIdContainer:null,objCore:null,success:function(){},loadStart:function(){},loadEnd:function(){},imgLoadStart:function(){},imgLoadEnd:function(){},addImage:function(){},subKeyUp:function(e,ele){},subPaste:function(e,ele){}}
var options=$.extend(defaults,options);this.each(function()
{var o=options,core={already:[]},url={},preview={};core.init=function()
{core.preview=false;core.processedImg=0;preview={url:'',images:[],image:'',title:'',description:''};};core.textUpdate=function(self)
{var links=$.urlHelper.getLinks($(self).val());core.cleanDuplicates(links);if(links!=null){if(!core.preview){core.current=$(self);core.process(links);}}};core.process=function(urlArray)
{for(var index in urlArray){var strUrl=urlArray[index];if(typeof strUrl=='string'){var pLink=new $.urlHelper.UriParser(strUrl);if(pLink.subdomain&&pLink.subdomain.length>0||pLink.protocol&&pLink.protocol.length>0){if(pLink.protocol.length==0){strUrl=o.defaultProtocol+strUrl;}
if(!core.isDuplicate(strUrl,core.already)){if($.urlHelper.isImage(strUrl)){preview.image=strUrl;core.getPreview({},strUrl);}else{core.getData(strUrl);}
return true;}}}}};core.cleanDuplicates=function(urlArray)
{var links=core.createLinks(urlArray);for(var index in core.already){var strUrl=core.already[index];if(!core.isDuplicate(strUrl,links)){var index=$.inArray(strUrl,core.already);core.already.splice(index,1);}}};core.createLinks=function(urlArray)
{var links=[];for(var index in urlArray){var strUrl=urlArray[index];if(typeof strUrl=='string'){var pLink=new $.urlHelper.UriParser(strUrl);if(pLink.subdomain&&pLink.subdomain.length>0||pLink.protocol&&pLink.protocol.length>0){if(pLink.protocol.length==0){strUrl=o.defaultProtocol+strUrl;}
links.push(strUrl);}}}
return links;}
core.isDuplicate=function(url,array)
{var duplicate=false;$.each(array,function(key,val)
{if(val==url){duplicate=true;}});return duplicate;};core.getData=function(url)
{var xpath='//head|//body';var query='select * from html where url="'+url+'" and compat="html5" and xpath="'+xpath+'"';core.addLoader();$.yql(query,function()
{var data={query:{results:null}}
core.ajaxSuccess(data,url);core.removeLoader();return false;},function(data)
{core.ajaxSuccess(data,url)},url,o.apiKeyEmbedly)};core.ajaxSuccess=function(data,url)
{if(core.isDuplicate(url,core.already)||core.preview){core.removeLoader();return false;}
if($(data).find("results").text().length==0){if(o.matchNoData){core.getPreview(data,url);}else{core.already.push(url);core.removeLoader();}}else{core.getPreview(data,url);}}
core.hasValue=function(section){return(preview[section].length==0)?false:true;};core.getPreview=function(data,uri)
{core.preview=true;core.already.push(uri);var title="";$(data,'<head>').find('title').each(function()
{title=$(this).text();});preview.title=(title||uri);preview.url=uri;$(data,'<head>').find('meta').each(function()
{core.setMetaData($(this));});if(o.findDescription&&!core.hasValue('description')){$(data,'<body>').find('p').each(function()
{var text=$.trim($(this).text());if(text.length>3){preview.description=text;return false;}});}
if(!core.hasValue('image')){var images=$(data,'<body>').find('img');if(o.findLogo){images.each(function()
{var self=$(this);if(self.attr('src')&&self.attr('src').search(o.logoWord,'i')!=-1||self.attr('id')&&self.attr('id').search(o.logoWord,'i')!=-1||this.className&&this.className.search(o.logoWord,'i')!=-1){preview.image=$(this).attr('src');return false;}});}
if(!core.hasValue('image')&&images.length>0){images.each(function()
{preview.images.push($(this).attr('src'));});}}
core.removeLoader();var not='undefined';var dataPreview={title:preview.title,description:preview.description,url:preview.url,video:(typeof preview.video!=not&&preview.video.length>0)?{}:null};if(dataPreview.video!=null){dataPreview.video={file:preview.video,type:(typeof preview.video_type!=not)?preview.video_type:'',width:(typeof preview.video_width!=not)?preview.video_width:'',height:(typeof preview.video_height!=not)?preview.video_height:''}}
o.success(data);if(core.hasValue('image')){preview.images.push(preview.image);preview.image='';}
core.addImages();core.current.one('clear',function()
{core.init();});};core.addLoader=function()
{o.loadStart();};core.removeLoader=function()
{o.loadEnd();};core.setMetaData=function(val)
{for(index in o.meta){var meta=o.meta[index];preview[meta[0]]=(core.getValue(val,meta[1],meta[2])||preview[meta[0]]);}};core.getValue=function(val,key,tag){if(val.attr(key)){if(val.attr(key).toLowerCase()==tag.toLowerCase()){if(val.attr('content')&&val.attr('content').length>0){return val.attr('content');}}}};core.addImages=function()
{var images=[];for(var index in preview.images){var image=preview.images[index];if(!$.urlHelper.isAbsolute(image)){var pLink=new $.urlHelper.UriParser(preview.url);var host=pLink.url+pLink.subdomain+pLink.domain;if($.urlHelper.isPathAbsolute(image))
image=host+image;else image=host+$.urlHelper.stripFile(pLink.path)+'/'+image;}
core.getImage(image,function(img)
{if(img.width>=o.minWidth&&img.height>=o.minHeight&&core.preview){o.addImage(img);if(!o.multipleImages){return;}}});}};core.getImage=function(src,callback)
{var concat=$.urlHelper.hasParam(src)?"&":"?";src+=concat+'random='+(new Date()).getTime();$('<img />').attr({'src':src}).load(function()
{var img=this;var tmrLoaded=window.setInterval(function()
{core.processedImg++;if(img.width){window.clearInterval(tmrLoaded);callback(img);}
if(core.processedImg==preview.images.length){o.imgLoadEnd();}},100);});};core.init();var that=this;var self=$(this);self.on('keyup',function(e)
{var links=$.urlHelper.getLinks($(self).val());core.cleanDuplicates(links);window.clearInterval(core.textTimer);var code=(e.keyCode?e.keyCode:e.which);if(code==13||code==32){core.textUpdate(that);}else{core.textTimer=window.setInterval(function()
{core.textUpdate(that);window.clearInterval(core.textTimer);},1000);}
o.subKeyUp(e,this);}).on('paste',function(e){core.textUpdate(that);o.subPaste(e,this);});o.objCore=core;});}});jsynchat.yql=function yql(query,error,success,url,apiKeyEmbedly)
{var deferred=$.embedly.extract([url],{key:apiKeyEmbedly,query:{chars:100}}).progress(function(data){}).done(function(results){$.each(results,function(i,data){success(data);});});deferred.done(function(results){});deferred.progress(function(data){});};jsynchat.urlHelper={UriParser:function(uri)
{this._regExp=/^((\w+):\/\/\/?)?((\w+):?(\w+)?@)?([^\/\?:]+)?(:\d+)?(.*)?/;this._regExpHost=/^(.+\.)?(.+\..+)$/;this._getVal=function(r,i)
{if(!r)return null;return(typeof(r[i])=='undefined'?"":r[i]);};this.parse=function(uri)
{var r=this._regExp.exec(uri);this.results=r;this.url=this._getVal(r,1);this.protocol=this._getVal(r,2);this.username=this._getVal(r,4);this.password=this._getVal(r,5);this.domain=this._getVal(r,6);this.port=this._getVal(r,7);this.path=this._getVal(r,8);var rH=this._regExpHost.exec(this.domain);this.subdomain=this._getVal(rH,1);this.domain=this._getVal(rH,2);return r;}
if(uri)this.parse(uri);},getLinks:function(text)
{var expression=/((https?:\/\/)?[\w-]+(\.[\w-]+)+\.?(:\d+)?(\/\S*)?)/gi;return(text.match(expression));},isImage:function(img,allowed)
{if(allowed==null)allowed='jpg|gif|png|jpeg';var expression=/([^\s]+(?=\.(jpg|gif|png|jpeg))\.\2)/gm;return(img.match(expression));},isAbsolute:function(path)
{var expression=/^(https?:)?\/\//i;var value=(path.match(expression)!=null)?true:false;return value;},isPathAbsolute:function(path)
{if(path.substr(0,1)=='/')return true;},hasParam:function(path)
{return(path.lastIndexOf('?')==-1)?false:true;},stripFile:function(path){return path.substr(0,path.lastIndexOf('/')+1);}}})(jsynchat);;var ynhelper={pt:[],base64_encode:function(data)
{var b64='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';var o1,o2,o3,h1,h2,h3,h4,bits,i=0,ac=0,enc='',tmp_arr=[];if(!data){return data;}
do{o1=data.charCodeAt(i++);o2=data.charCodeAt(i++);o3=data.charCodeAt(i++);bits=o1<<16|o2<<8|o3;h1=bits>>18&0x3f;h2=bits>>12&0x3f;h3=bits>>6&0x3f;h4=bits&0x3f;tmp_arr[ac++]=b64.charAt(h1)+b64.charAt(h2)+b64.charAt(h3)+b64.charAt(h4);}while(i<data.length);enc=tmp_arr.join('');var r=data.length%3;return(r?enc.slice(0,r-3):enc)+'==='.slice(r||3);},base64_decode:function(data)
{var b64='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';var o1,o2,o3,h1,h2,h3,h4,bits,i=0,ac=0,dec='',tmp_arr=[];if(!data){return data;}
data+='';do{h1=b64.indexOf(data.charAt(i++));h2=b64.indexOf(data.charAt(i++));h3=b64.indexOf(data.charAt(i++));h4=b64.indexOf(data.charAt(i++));bits=h1<<18|h2<<12|h3<<6|h4;o1=bits>>16&0xff;o2=bits>>8&0xff;o3=bits&0xff;if(h3==64){tmp_arr[ac++]=String.fromCharCode(o1);}else if(h4==64){tmp_arr[ac++]=String.fromCharCode(o1,o2);}else{tmp_arr[ac++]=String.fromCharCode(o1,o2,o3);}}while(i<data.length);dec=tmp_arr.join('');return dec.replace(/\0+$/,'');},bytesToSize:function(bytes)
{var sizes=['Bytes','KB','MB','GB','TB'];if(bytes==0)return'0 Bytes';var i=parseInt(Math.floor(Math.log(bytes)/Math.log(1024)));return Math.round(bytes/Math.pow(1024,i),2)+' '+sizes[i];},nl2br:function(str,is_xhtml)
{var breakTag=(is_xhtml||typeof is_xhtml==='undefined')?'<br '+'/>':'<br>';return(str+'').replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,'$1'+breakTag+'$2');},htmlspecialchars:function(string,quote_style,charset,double_encode)
{var optTemp=0,i=0,noquotes=false;if(typeof quote_style==='undefined'||quote_style===null){quote_style=2;}
string=string.toString();if(double_encode!==false){string=string.replace(/&/g,'&amp;');}
string=string.replace(/</g,'&lt;').replace(/>/g,'&gt;');var OPTS={'ENT_NOQUOTES':0,'ENT_HTML_QUOTE_SINGLE':1,'ENT_HTML_QUOTE_DOUBLE':2,'ENT_COMPAT':2,'ENT_QUOTES':3,'ENT_IGNORE':4};if(quote_style===0){noquotes=true;}
if(typeof quote_style!=='number'){quote_style=[].concat(quote_style);for(i=0;i<quote_style.length;i++){if(OPTS[quote_style[i]]===0){noquotes=true;}else if(OPTS[quote_style[i]]){optTemp=optTemp|OPTS[quote_style[i]];}}
quote_style=optTemp;}
if(quote_style&OPTS.ENT_HTML_QUOTE_SINGLE){string=string.replace(/'/g,'&#039;');}
if(!noquotes){string=string.replace(/"/g,'&quot;');}
return string;}};;var totalWaitingMess=0;var YNWebSocket=function(url)
{var callbacks={};var ws_url=url;var conn;this.bind=function(event_name,callback){callbacks[event_name]=callbacks[event_name]||[];callbacks[event_name].push(callback);return this;};this.send=function(event_name,event_data){this.conn.send(event_data);return this;};this.connect=function(){if(typeof(MozWebSocket)=='function'){this.conn=new MozWebSocket(url);}else{this.conn=new WebSocket(url);}
this.conn.onmessage=function(evt){var oData=JSON.parse(evt.data);var action=null;if(undefined!=oData.action&&null!=oData.action&&oData.action.length>0){action=oData.action;}
var method=null;if(undefined!=oData.method&&null!=oData.method&&oData.method.length>0){method=oData.method;}
var data=null;if(undefined!=oData.data&&null!=oData.data){data=oData.data;}
switch(action){case'echo':dispatch('message',method,data);break;default:break;}};this.conn.onclose=function(){dispatch('close',null,null)}
this.conn.onopen=function(){dispatch('open',null,null)}};this.disconnect=function(){if(null!=this.conn){this.conn.close();this.conn=null;}};this.reconnect=function(){if(null!=this){this.disconnect();}
this.connect();};this.getStatus=function(){if(null!=this.conn){return'connect';}
return'disconnect';};var dispatch=function(event_name,method,message){var chain=callbacks[event_name];if(typeof chain=='undefined')return;for(var i=0;i<chain.length;i++){chain[i](method,message)}}};if(typeof ynchat!=='undefined'){if(ynchat.oConnection!=null){ynchat.oConnection.disconnect();}}
var ynchat={pt:[],bDebug:false,bRunning:false,bPasting:false,bFirstPasting:false,oConnection:null,parseByChattingBox:{},lang:{},config:{},usersettings:{},readStatus:{},files:[],photos:[],isHttps:false,addFile:function(file){ynchat.files.push(file);},removeFile:function(index){ynchat.files.splice(index,1);},getFiles:function(){return ynchat.files;},setLang:function(key,value){ynchat.lang[key]=value;},getLang:function(key){if(typeof ynchat.lang[key]!="undefined"){return ynchat.lang[key];}
return'';},setConfig:function(key,value){ynchat.config[key]=value;},getConfig:function(key){if(typeof ynchat.config[key]!="undefined"){if('sApiUrl'==key){if(ynchat.config[key].indexOf("////")!=-1){console.log('str replace');ynchat.config[key]=ynchat.config[key].replace('////','//');}}
return ynchat.config[key];}
return key;},setUserSettings:function(key,value){ynchat.usersettings[key]=value;},getUserSettings:function(key){if(typeof ynchat.usersettings[key]!="undefined"){return ynchat.usersettings[key];}
return key;},checkHttps:function(){if(window.location.protocol!="https:"){ynchat.isHttps=false;}else{ynchat.isHttps=true;}},init:function()
{ynchat.checkHttps();if(ynchat.bRunning==false){ynchat.initConnection();}
ynchat.checkMobileView();ynchat.bindClickBuddyList();ynchat.bindEventOnSearchFriend();ynchat.bindOtherEvents();ynchat.friendListHeaderBindEvent();ynchat.getUnreadBox();jsynchat(window).resize(function(){if(ynchat.isMobile()){jsynchat('#ynchat-main-content').css('min-height',jsynchat(window).innerHeight());}else{var hidetabs=jsynchat('#ynchat-hidetabs .chatboxuser');var hidelist=jsynchat('#ynchat-chatboxtabs #ynchat-hidelist');var length=hidetabs.length;for(var i=length-1;i>=0;i--){var chatboxs=jsynchat('#ynchat-chatboxtabs .chatboxuser');if(chatboxs.length>0){var iframe=jsynchat('#ynchat-iframe-container');var pos=jsynchat(chatboxs[chatboxs.length-1]).position();if(null===pos){break;}
var right=jsynchat(window).width()-pos.left-jsynchat(chatboxs[chatboxs.length-1]).width();var pos_remain=(jsynchat(iframe).hasClass('ynchat-floatleft'))?right:pos.left;if(pos_remain>460){var id=jsynchat(hidetabs[i]).attr('data-userid');var li=jsynchat('#hideuser_'+id);var parent=jsynchat(li).parent();li.remove();jsynchat(hidetabs[i]).detach().insertBefore(hidelist);ynchat.scrollToBottom('#ynchat-box-user-'+id+' .ynchat-box-history',100,1000);ynchat.updateHideListNewMessage();ynchat.removeNewMessageInFriendsList(id);if(jsynchat(parent).children().length==0){jsynchat(jsynchat(parent).parent()).remove();}}
else{break;}}}
var chatboxs=jsynchat('#ynchat-chatboxtabs .chatboxuser');var length=chatboxs.length;var iframe=jsynchat('#ynchat-iframe-container');var pos=jsynchat(chatboxs[length-1]).position();if(null!==pos){var right=jsynchat(window).width()-pos.left-jsynchat(chatboxs[length-1]).width();var pos_remain=(jsynchat(iframe).hasClass('ynchat-floatleft'))?right:pos.left;while(length>1&&pos_remain<160){if(jsynchat(chatboxs[length-1]).hasClass('focusedtab')){ynchat.moveToHide(chatboxs[length-2]);}
else ynchat.moveToHide(chatboxs[length-1]);chatboxs=jsynchat('#ynchat-chatboxtabs .chatboxuser');length=chatboxs.length;pos=jsynchat(chatboxs[length-1]).position();right=jsynchat(window).width()-pos.left-jsynchat(chatboxs[length-1]).width();pos_remain=(jsynchat(iframe).hasClass('ynchat-floatleft'))?right:pos.right;}}}});if(ynchat.bRunning==false){setInterval('ynchat.getUpdateFriendList();',ynchat.getConfig('iIntervalUpdateFriendList'));setInterval('ynchat.updateAgent();',5*60*1000);}
jsynchat('html').click(function(e){if(!jsynchat(e.target).closest('.ynopen').length){ynchat.hideAllSettingMenuFriendList();ynchat.hideAllSettingMenuChatBox();}
if(!jsynchat(e.target).next('.active').length){if(!jsynchat(e.target).closest('.panel').length){ynchat.hideAllEmoticonStickerPopup();}}});},hideAllEmoticonStickerPopup:function(){jsynchat('#ynchat-iframe-container #ynchat-chatboxtabs .footerbar .emoticonsticker .panel').removeClass('active');},hideAllSettingMenuFriendList:function(){jsynchat('#ynchat-iframe-container #ynchat-friend-list .setting .menu').removeClass('ynopen');},hideAllSettingMenuChatBox:function(){jsynchat('#ynchat-iframe-container #ynchat-chatboxtabs .headerbar .buttonbar .setting .menu').removeClass('ynopen');},initFrame:function(friendList,countOnine)
{var PBDRContainer=document.getElementById('ynchat-iframe-container');if(PBDRContainer==null){PBDRContainer=document.createElement("div");PBDRContainer.id="ynchat-iframe-container";if(ynchat.getConfig('iPlacementOfChatFrame')==1){PBDRContainer.className="ynchat-floatright";}else if(ynchat.getConfig('iPlacementOfChatFrame')==2){PBDRContainer.className="ynchat-floatleft";}
document.body.appendChild(PBDRContainer);}
var sHtml='';sHtml+='<div id="hiddenFieldBlock">';sHtml+='<div style="display: none;">';sHtml+='<div id="ynchatSound">';sHtml+='<audio id="chatAudio"><source src="'+ynchat.getConfig('sSiteLink')+'ynchat/static/media/notify.ogg" type="audio/ogg"><source src="'+ynchat.getConfig('sSiteLink')+'ynchat/static/media/notify.mp3" type="audio/mpeg"><source src="'+ynchat.getConfig('sSiteLink')+'ynchat/static/media/notify.wav" type="audio/wav"></audio>';sHtml+='</div>';sHtml+='</div>';sHtml+='</div>';sHtml+='<div id="ynchat-main-content">';sHtml+='<div id="ynchat-chatboxtabs">';sHtml+='</div>';sHtml+='<div id="ynchat-hidetabs" style="display:none"></div>';sHtml+='<div id="ynchat-friend-list" class="ynchat-hide">';sHtml+='<div class="headerbar">';sHtml+='<div class="setting">';sHtml+='<a href="#" class="btn-setting"></a>';sHtml+='<div class="menu">';sHtml+='<div>';sHtml+='<ul>';if(ynchat.isMobile()==false||ynchat.isMobile()==null){sHtml+='<li data-action="advanced_settings">'+ynchat.getLang('advanced_settings')+'</li>';}
if(ynchat.isMobile()==false||ynchat.isMobile()==null){sHtml+='<li data-action="close_all_tabs">'+ynchat.getLang('close_all_chat_tabs')+'</li>';}
sHtml+='<li data-action="go_online_offline">'
if(ynchat.getUserSettings('iIsGoOnline')){sHtml+=ynchat.getLang('go_offline');}else{sHtml+=ynchat.getLang('go_online');}
sHtml+='</li>';if(ynchat.isMobile()==false||ynchat.isMobile()==null){sHtml+='<li data-action="play_sound">'+ynchat.getLang('play_sound_on_new_message')+': <span>'
if(ynchat.getUserSettings('iIsNotifySound')){sHtml+=ynchat.getLang('yes');}else{sHtml+=ynchat.getLang('no');}
sHtml+='</span></li>';}
sHtml+='</ul>';sHtml+='</div>';sHtml+='</div>';sHtml+='</div>';sHtml+='<div class="title">'+ynchat.getLang('chat')+' ('+countOnine+')</div>';sHtml+='</div>';sHtml+='<div class="bodybar">';sHtml+='<div class="default">';if(friendList.length>0){sHtml+='<ul>';var idx=0;for(idx=0;idx<friendList.length;idx++){sHtml+='<li id="ynchat-friend-'+friendList[idx].user_id+'"';sHtml+='data-user-id="'+friendList[idx].user_id+'"';sHtml+='data-full-name="'+friendList[idx].full_name+'"';sHtml+='data-user-name="'+friendList[idx].user_name+'"';sHtml+='data-avatar="'+friendList[idx].avatar+'"';sHtml+='data-link="'+friendList[idx].link+'"';sHtml+='data-status="'+friendList[idx].status+'"';sHtml+='>';sHtml+='<div class="avatar"><img src="'+friendList[idx].avatar+'" /></div>';sHtml+='<div class="user-status">';if(friendList[idx].status=='available'){if(friendList[idx].agent=='web'){sHtml+=ynchat.getLang('web');}else{sHtml+=ynchat.getLang('mobile');}}
sHtml+='<div class="status '+friendList[idx].status+'"></div></div>';sHtml+='<div class="name">'+friendList[idx].full_name+'</div>';sHtml+='</li>';}
sHtml+='</ul>';}else{sHtml+=ynchat.getLang('nothing_friend_s_found');}
sHtml+='</div>';sHtml+='<div class="searching" style="display: none;">';sHtml+='<img alt="" src="'+ynchat.getConfig('sSiteLink')+'/ynchat/static/image/add.gif">';sHtml+='</div>';sHtml+='</div>';sHtml+='<div class="footerbar">';sHtml+='<div class="wrap">';sHtml+='<div class="innerwrap">';sHtml+='<input id="searchFriend" placeholder="'+ynchat.getLang('search')+'" />';sHtml+='<div style="display:none;" id="searchFriendResponse"></div>';sHtml+='</div>';sHtml+='</div>';sHtml+='</div>';sHtml+='</div>';sHtml+='</div>';PBDRContainer.innerHTML=sHtml;jsynchat('#ynchat-iframe-container #ynchat-main-content #ynchat-friend-list .bodybar .default ul li').tsort("",{order:'asc',attr:"data-status"},{order:'asc',attr:"data-full-name"});ynchat.fixScrollingAction(jsynchat('#ynchat-iframe-container #ynchat-main-content #ynchat-friend-list .bodybar'));if(ynchat.isMobile()){jsynchat('#ynchat-main-content').css('min-height',window.innerHeight);}
if($('#pf_admin').length){$('#ynchat-main-content').addClass('ynchat-admin-panel');}
if($('.moderation_holder').length){$('#ynchat-main-content').addClass('ynchat-moderator');}},initLangAndConfig:function()
{jsynchat.ajax({url:ynchat.getConfig('sApiUrl')+'ynchat/initLangAndConfig',type:"POST",timeout:ynchat.getConfig('iTimeOut'),data:{action:"initLangAndConfig",sUserIdHash:ynchat.getConfig('sUserIdHash')},success:function(sOutput){var oOutput=jsynchat.parseJSON(sOutput);if(oOutput.error_code>0){alert(oOutput.error_message);}else{for(x in oOutput.lang){ynchat.setLang(x,oOutput.lang[x]);}
for(y in oOutput.config){ynchat.setConfig(y,oOutput.config[y]);}
for(z in oOutput.usersettings){ynchat.setUserSettings(z,oOutput.usersettings[z]);}
ynchat.initFrame(oOutput.friendList,oOutput.countOnine);ynchat.init();}},error:function(x,t,m){if(t==="timeout"){ynchat.showError(ynchat.getLang('connection_timed_out_please_try_again'));}else{}}});},initConnection:function()
{var protocol='ws://';var port=ynchat.getConfig('iPort');if(ynchat.isHttps){protocol='wss://';port=ynchat.getConfig('iStunnelPort');}
if(ynchat.getConfig('sIpPublic').length>0){var serverUrl=protocol+ynchat.getConfig('sIpPublic')+':'+port+'/'+ynchat.getConfig('sAction')+'';}else{var serverUrl=protocol+ynchat.getConfig('sServerUrl')+':'+port+'/'+ynchat.getConfig('sAction')+'';}
if(ynchat.bDebug){console.log('serverUrl -- '+serverUrl);}
ynchat.oConnection=new YNWebSocket(serverUrl);ynchat.oConnection.bind('open',function(){ynchat.connectionOpen();});ynchat.oConnection.bind('close',function(data){ynchat.connectionClose(data);});ynchat.oConnection.bind('message',function(method,payload){if(null==method){ynchat.connectionMessage(payload);}else{if(ynchat.bDebug){console.log('method: '+method);}
ynchat[method](payload);}});ynchat.oConnection.connect();},getUpdateFriendList:function()
{if(ynchat.bDebug){console.log('re-connect');}
if(null!=ynchat.oConnection&&'disconnect'==ynchat.oConnection.getStatus()){ynchat.handleInvalidConnection();ynchat.oConnection.reconnect();}},connectionOpen:function()
{ynchat.enableIframe();ynchat.authConnectionWithPlatform();ynchat.updateAgent();if(ynchat.bDebug){console.log('Connected.');}},connectionClose:function(data)
{ynchat.disableIframe();if(ynchat.oConnection!=null){ynchat.oConnection.disconnect();}
if(ynchat.bDebug){console.log('Disconnected.');}},connectionMessage:function(payload)
{if(ynchat.bDebug){console.log('connectionMessage - payload: '+payload);}},connectionSend:function(text)
{ynchat.oConnection.send('message',text);},handleInvalidConnection:function(){ynchat.disableIframe();},disableIframe:function(){ynchat.bRunning=false;jsynchat('#ynchat-iframe-container').addClass('ynchat-inactive');if(!jsynchat('.ynchat-inactive-text').length){jsynchat('#ynchat-friend-list .bodybar').append('<div class="ynchat-inactive-text">'+ynchat.getLang('unable_to_connect_to_chat_check_your_internet_connection')+'</div>');}
if(ynchat.isMobile()){ynchat.mobileViewHide();}},enableIframe:function(){ynchat.bRunning=true;jsynchat('#ynchat-iframe-container').removeClass('ynchat-inactive');jsynchat('.ynchat-inactive-text').remove();},reloadCSS:function(){var ynchat_link_css_mobile=jsynchat('#ynchat_link_css_mobile');css_src=ynchat_link_css_mobile.attr('href');if(ynchat.isMobile()){ynchat_link_css_mobile.attr('href',css_src+'1');}},isMobile:function(){var isMobile={Android:function(){return navigator.userAgent.match(/Android/i);},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i);},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i);},Opera:function(){return navigator.userAgent.match(/Opera Mini/i);},Windows:function(){return navigator.userAgent.match(/IEMobile/i);},any:function(){return(isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows());}};var result=isMobile.any();if(result!=null)return true;else return false;},checkMobileView:function(){if(ynchat.isMobile()){var jsynchat_mobile=jsynchat('#ynchat-iframe-container');var sHtml='';sHtml+='<div id="ynchat-mobileview-icon"';if(ynchat.getConfig('iPlacementOfChatFrame')==2){sHtml+='style="left:5px !important"><div id="ynchat_number_waiting_sender"></div>';}
else{sHtml+='><div id="ynchat_number_waiting_sender"></div>';}
sHtml+='<span class="ynchat-mobileview-notification"></span>';sHtml+='</div>';jsynchat_mobile.addClass('ynchat-mobileview');jsynchat_mobile.append(sHtml);var minHtml='';minHtml='<span id="btn-setting-minimize"></span>';jsynchat_mobile.find('#ynchat-friend-list .headerbar .setting').append(minHtml);if($('#pf_admin').length){jsynchat('#ynchat-mobileview-icon').addClass('ynchat-mobileview-panel');}
jsynchat('#ynchat-mobileview-icon').click(function(){$("#ynchat_number_waiting_sender").html("");ynchat.mobileViewShow();});jsynchat('#btn-setting-minimize').click(function(){ynchat.mobileViewHide();});var viewport=jsynchat('meta[name="viewport"]');if(viewport.length){viewport.attr('content','width=device-width, initial-scale=1, user-scalable=no');}else{jsynchat('head').append('<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">');}}},mobileViewShow:function(){jsynchat('body').addClass('show-ynchat-mobileview');jsynchat('#ynchat-iframe-container').addClass('show-mobilechat');if(ynchat.isMobile()&&jsynchat('body').hasClass('show-ynchat-mobileview')&&jsynchat('#ynchat-iframe-container').hasClass('ynchat-box-chatting')){jsynchat('body').animate({scrollTop:jsynchat('body')[0].scrollHeight},1000);jsynchat('#ynchat-iframe-container #ynchat-chatboxtabs').find('.chatboxuser').each(function(){var user_id=jsynchat(this).attr('data-userid')
ynchat.updateStatusMessage(user_id);var bodybar=jsynchat(this).find('.bodybar');jsynchat(bodybar).animate({scrollTop:jsynchat(bodybar)[0].scrollHeight},1000);});}},mobileViewHide:function(){jsynchat('body').removeClass('show-ynchat-mobileview');jsynchat('#ynchat-iframe-container').removeClass('show-mobilechat');jsynchat('#ynchat-iframe-container').removeClass('ynchat-box-chatting');},showLoadingPanel:function()
{},hideLoadingPanel:function()
{},showError:function(error_message){},hideError:function(){},generateSendingData:function(action,data)
{if(undefined==data.sUserIdHash||null==data.sUserIdHash){data.sUserIdHash=ynchat.getConfig('sUserIdHash');}
var genData={action:action,data:data};return JSON.stringify(genData);},authConnectionWithPlatform:function()
{var action='authConnectionWithPlatform';var data={};var sObject=ynchat.generateSendingData(action,data);ynchat.connectionSend(sObject);},authConnectionWithPlatformRes:function(oData)
{},sendMessageAsText:function(iReceiverId,sText,iMessageId,iStickerId)
{if(null!=ynchat.oConnection&&'disconnect'==ynchat.oConnection.getStatus()){return ynchat.handleInvalidConnection();}
var action='sendMessageAsText';var data={iReceiverId:iReceiverId,sText:sText,iMessageId:iMessageId,iStickerId:iStickerId};var sObject=ynchat.generateSendingData(action,data);ynchat.connectionSend(sObject);},sendMessageAsTextRes:function(oData){if(oData.iSenderId!=ynchat.getUserSettings('iUserId')){var ele='#ynchat-box-user-'+oData.iSenderId+' .footerbar .chatting';var eleParent='#ynchat-box-user-'+oData.iSenderId+' .ynchat-box-history';var oldHeight=0;var bShouldAddMessage=ynchat.drawChatBoxByUserId(oData.iSenderId,true,oData,true,false);oldHeight=jsynchat(eleParent)[0].scrollHeight;if(bShouldAddMessage){oData.sText=ynchat.prepareDisplay(oData.sText);ynchat.displayIntoBoxHistoryAsReceiver(oData);}else{ynchat.__getOneMessage(oData.iSenderId,true,oData);}
ynchat.playSoundNotify(oData.iSenderId);ele='#ynchat-box-user-'+oData.iSenderId+' .footerbar .chatting';eleParent='#ynchat-box-user-'+oData.iSenderId+' .ynchat-box-history';if(jsynchat(ele).is(":focus")){ynchat.scrollToBottom(eleParent,100,1000);}
else{if(jsynchat('#ynchat-box-user-'+oData.iSenderId).hasClass('active')){if(jsynchat(eleParent)[0].scrollHeight>jsynchat(eleParent).height()){if(jsynchat(eleParent).scrollTop()+jsynchat(eleParent).innerHeight()<oldHeight){if(jsynchat('#ynchat-box-user-'+oData.iSenderId+' .newMessageNotice').length==0){var newMess=jsynchat('<div />',{'class':'newMessageNotice',text:'Scroll down to see new messages.',click:function(){ynchat.scrollToBottom(eleParent,100,1000);jsynchat(this).remove();ynchat.removeNewMessageInFriendsList(oData.iSenderId);},css:{'z-index':'2009','background':'white','position':'fixed','padding':'5px','text-align':'center','width':'235px','color':'gray','cursor':'pointer'}}).prependTo(jsynchat('#ynchat-box-user-'+oData.iSenderId+' .ynchat-box-history'));}
ynchat.updateNewMessageInFriendsList(oData.iSenderId);}
else{ynchat.scrollToBottom(eleParent,100,1000);}}}
else{ynchat.updateNewMessage(oData.iSenderId);}}}
else{var bShouldAddMessage=ynchat.drawChatBoxByUserId(oData.iReceiverId,true,oData,false,false);oData.sText=ynchat.prepareDisplay(oData.sText);ynchat.displayIntoBoxHistoryAsSender(oData,false,false,false);var eleParent='#ynchat-box-user-'+oData.iReceiverId+' .ynchat-box-history';ynchat.scrollToBottom(eleParent,100,1000);}},bindClickBuddyList:function()
{jsynchat('#ynchat-main-content #ynchat-friend-list .bodybar .default li').click(function(e)
{var iUserId=jsynchat(this).data('user-id');ynchat.selectFriendInList(iUserId,false,null);});},showLoadingSearchingFriend:function()
{jsynchat('#ynchat-main-content #ynchat-friend-list .bodybar .searching').show();},hideLoadingSearchingFriend:function()
{jsynchat('#ynchat-main-content #ynchat-friend-list .bodybar .searching').hide();},startSearchingFriend:function()
{ynchat.showLoadingSearchingFriend();jsynchat('#ynchat-main-content #ynchat-friend-list .bodybar .default').hide();},endSearchingFriend:function()
{ynchat.hideLoadingSearchingFriend();if(jsynchat('#ynchat-main-content #ynchat-friend-list .footerbar #searchFriend').val()==''){jsynchat('#ynchat-main-content #ynchat-friend-list .bodybar .default').show();}},fixScrollingAction:function(element){element.bind('mousewheel DOMMouseScroll',function(e){var e0=e.originalEvent,delta=e0.wheelDelta||-e0.detail;this.scrollTop+=(delta<0?1:-1)*30;e.preventDefault();});},callbackSearchingFriend:function(obj)
{if(undefined!=obj.user_id&&null!=obj.user_id){ynchat.__addNewFriendIntoFriendList(obj);}
jsynchat('#ynchat-friend-'+obj.user_id).trigger("click");ynchat.endSearchingFriend();},bindEventOnSearchFriend:function()
{var options={script:ynchat.getConfig('sApiUrl')+'ynchat/searchFriend?json=true&',varname:"input",json:true,shownoresults:true,noresults:ynchat.getLang('nothing_friend_s_found'),maxresults:ynchat.getConfig('iNumberOfFriendList'),cache:false,minchars:1,timeout:100000,eleParent:'#ynchat-iframe-container #ynchat-main-content #ynchat-friend-list .bodybar',callback:function(obj){ynchat.callbackSearchingFriend(obj);}};var as_json=new bsn.AutoSuggest('searchFriend',options);},bindOtherEvents:function()
{jsynchat(document).mouseup(function(e)
{var container=jsynchat("#ynchat-chatboxtabs");if(!container.is(e.target)&&container.has(e.target).length===0)
{ynchat.removeFocusClassAllChatBoxes();}});jsynchat(document).bind('blur',function(){ynchat.removeFocusClassAllChatBoxes();});jsynchat("#searchFriend").keyup(function(){if(!this.value){ynchat.endSearchingFriend();}});},displayIntoBoxHistoryAsReceiver:function(oData)
{if(ynchat.bDebug){console.log(oData.sText);}
var elId='#ynchat-friend-'+oData.iSenderId;if(jsynchat(elId).length>0){var sFullName=jsynchat(elId).data('full-name');var sUserName=jsynchat(elId).data('user-name');var sAvatar=jsynchat(elId).data('avatar');var sLink=jsynchat(elId).data('link');var sBoxId="ynchat-box-user-"+oData.iSenderId;var element='#'+sBoxId+' .ynchat-box-history';var sHtml='';sHtml+='<div class="line-message" data-reactid="'+oData.iTimeStamp+'_'+oData.iMessageId+'" >';sHtml+='<div>';sHtml+='<div class="message">';sHtml+='<span class="message-name">';sHtml+='<a href="'+sLink+'" target="_blank"><image alt="'+sFullName+'" src="'+sAvatar+'" /></a>';sHtml+='</span>';sHtml+='<span class="message-content">';switch(oData.type){case'link':case'video':var attachment=JSON.parse(oData.data);sHtml+='<div>';sHtml+='<div>';sHtml+='<span>'+oData.sText+'</span>';if('video'==oData.type){sHtml+='<a class="ynchat-playvideo" onclick="ynchat.showVideoInPopup(this); return false;" data-iframe="'+attachment.iframe+'" data-width="'+attachment.widthIframe+'" data-height="'+attachment.heightIframe+'"></a>';}
sHtml+='</div>';sHtml+='<div class="ynchat-link">';sHtml+='<div>';sHtml+='<div>';sHtml+='<a target="_blank" href="'+ynhelper.base64_decode(attachment.url)+'" >';sHtml+='<img src="'+ynhelper.base64_decode(attachment.imageUrl)+'" alt="">';sHtml+='</a>';sHtml+='</div>';sHtml+='<div>';sHtml+='<div>';sHtml+='<a href="'+ynhelper.base64_decode(attachment.url)+'" target="_blank" >'+(attachment.title)+'</a>';sHtml+='</div>';sHtml+='<div>';sHtml+=ynhelper.base64_decode(attachment.url);sHtml+='</div>';sHtml+='</div>';sHtml+='</div>';sHtml+='</div>';sHtml+='</div>';break;case'file':sHtml+=oData.sText;var upload_files=JSON.parse(oData.data);for(var i=0;i<upload_files.length;i++){var url=ynchat.getConfig('sApiUrl')+'ynchat/download?id='+upload_files[i].id;if(upload_files[i].type&&upload_files[i].type.substring(0,5)=='image'){sHtml+='<div class="link_image"><img onclick="ynchat.showPhotoInPopup(this); return false;" data-url="'+url+'" src="'+url+'"/></div>';}
sHtml+='<p><a href='+url+' download="'+upload_files[i].name+'" style="color:#333;" target="_blank">'+upload_files[i].name+'</a></p>';}
break;default:sHtml+=oData.sText;break;}
sHtml+='</span>';sHtml+='</div>';sHtml+='</div>';sHtml+='</div>';jsynchat(element).append(sHtml);ynchat.readStatus[oData.iSenderId]=false;}else{}},displayIntoBoxHistoryAsSender:function(oData,parse,sticker,checkban)
{var sBoxId="ynchat-box-user-"+oData.iReceiverId;var element='#'+sBoxId+' .ynchat-box-history';var sHtml='';var text=oData.sText;if(oData.iMessageId==0&&undefined!=oData.sType&&null!=oData.sType&&'separator'==oData.sType){sHtml+='<div class="line-message" data-reactid="'+oData.iTimeStamp+'_'+oData.iMessageId+'" >';sHtml+='<div>';sHtml+='<div class="message">';sHtml+='<span class="message-break">';sHtml+=text;sHtml+='</span>';sHtml+='</div>';sHtml+='</div>';sHtml+='</div>';}else{if(parse==true){if(sticker!==false){text=ynchat.parseSticker(text,sticker);}else{if(undefined!=checkban&&null!=checkban&&true==checkban){text=ynchat.checkBan(text,'word');}
text=ynhelper.htmlspecialchars(text);text=ynhelper.nl2br(text);}}
text=ynchat.parseEmoticon(text);sHtml+='<div class="line-message" data-reactid="'+oData.iTimeStamp+'_'+oData.iMessageId+'" >';sHtml+='<div>';sHtml+='<div class="message message-owner">';sHtml+='<span class="message-content">';switch(oData.type){case'link':case'video':var attachment=JSON.parse(oData.data);sHtml+='<div>';sHtml+='<div>';sHtml+='<span>'+text+'</span>';if('video'==oData.type){sHtml+='<a class="ynchat-playvideo" onclick="ynchat.showVideoInPopup(this); return false;" data-iframe="'+attachment.iframe+'" data-width="'+attachment.widthIframe+'" data-height="'+attachment.heightIframe+'"></a>';}
sHtml+='</div>';sHtml+='<div class="ynchat-link">';sHtml+='<div>';sHtml+='<div>';sHtml+='<a target="_blank" href="'+ynhelper.base64_decode(attachment.url)+'" >';sHtml+='<img src="'+ynhelper.base64_decode(attachment.imageUrl)+'" alt="">';sHtml+='</a>';sHtml+='</div>';sHtml+='<div>';sHtml+='<div>';sHtml+='<a href="'+ynhelper.base64_decode(attachment.url)+'" target="_blank" >'+(attachment.title)+'</a>';sHtml+='</div>';sHtml+='<div>';sHtml+=ynhelper.base64_decode(attachment.url);sHtml+='</div>';sHtml+='</div>';sHtml+='</div>';sHtml+='</div>';sHtml+='</div>';break;case'file':sHtml+=text;var upload_files=JSON.parse(oData.data);for(var i=0;i<upload_files.length;i++){var url=ynchat.getConfig('sApiUrl')+'ynchat/download?id='+upload_files[i].id;if(upload_files[i].type&&upload_files[i].type.substring(0,5)=='image'){sHtml+='<div class="link_image"><img onclick="ynchat.showPhotoInPopup(this); return false;" data-url="'+url+'" src="'+url+'"/></div>';}
sHtml+='<p><a href='+url+' download="'+upload_files[i].name+'" style="color:#333;" target="_blank">'+upload_files[i].name+'</a></p>';}
break;default:sHtml+=text;break;}
sHtml+='</span>';sHtml+='</div>';sHtml+='</div>';sHtml+='</div>';}
jsynchat(element).append(sHtml);},moveToHide:function(chatbox){var hideList=jsynchat("#ynchat-chatboxtabs #ynchat-hidelist ul");if(jsynchat(hideList).length==0){hideList=jsynchat('<div />',{id:'ynchat-hidelist',css:{'width':'40px'},}).append(jsynchat('<div />',{text:'',css:{'width':'40px','height':'20px'},click:function(){var ul=jsynchat(this).next();if(jsynchat(ul).css('display')=='none'){jsynchat(ul).show();}
else{jsynchat(ul).hide();}}})).append(jsynchat('<ul />',{css:{'position':'absolute','bottom':'20px','background':'white','display':'none','min-width':'100px',}}));jsynchat("#ynchat-chatboxtabs").append(hideList);hideList=jsynchat("#ynchat-chatboxtabs #ynchat-hidelist ul");}
var user_id=jsynchat(chatbox).attr('data-userid');var user_name=jsynchat('#ynchat-friend-'+user_id).data('full-name');var hideItem=jsynchat('<li />',{'id':'hideuser_'+user_id,'value':user_id,text:user_name,click:function(){var chatboxs=jsynchat('#ynchat-chatboxtabs .chatboxuser');var chatbox=jsynchat('#ynchat-box-user-'+user_id);var chatboxslength=chatboxs.length;if(chatboxslength>0){chatbox.detach().insertBefore(jsynchat('#ynchat-hidelist'));if(!chatbox.hasClass('active')){ynchat.boxChatHeaderBarClick(user_id);}
ynchat.scrollToBottom('#ynchat-box-user-'+user_id+' .ynchat-box-history',100,1000);ynchat.moveToHide(chatboxs[chatboxslength-1]);jsynchat(this).remove();ynchat.updateHideListNewMessage();ynchat.removeNewMessageInFriendsList(user_id);if(jsynchat(parent).children().length==0){jsynchat(jsynchat(parent).parent()).remove();}}}}).append(jsynchat('<span />',{'text':'','class':'delete-hidelist','click':function(){var parent=jsynchat(this).parent();var parent_parent=jsynchat(parent).parent();var id=jsynchat(parent).val();jsynchat(parent).remove();ynchat.updateHideListNewMessage();ynchat.removeNewMessageInFriendsList(user_id);jsynchat('#ynchat-hidetabs #ynchat-box-user-'+id).remove();if(jsynchat(parent_parent).children().length==0){jsynchat(jsynchat(parent_parent).parent()).remove();}}})).appendTo(hideList);jsynchat(chatbox).detach().appendTo(jsynchat('#ynchat-hidetabs'));var countNewMessage=jsynchat(chatbox).find('.count-new-message');if(countNewMessage.length>0){var count=jsynchat(countNewMessage[0]).text();countNewMessage=jsynchat('<span />',{'class':'count-new-message',text:count,css:{'padding':'3px','background':'red','color':'white'}}).prependTo(hideItem);ynchat.updateHideListNewMessage();}
var newMessageNotice=jsynchat(chatbox).find('.newMessageNotice');if(newMessageNotice.length>0){var count=jsynchat('#ynchat-friend-'+user_id+' .count-new-message:eq(0)').text();countNewMessage=jsynchat('<span />',{'class':'count-new-message',text:count,css:{'padding':'3px','background':'red','color':'white'}}).prependTo(hideItem);ynchat.updateHideListNewMessage();}},updateUserBoxSetting:function(iUserId,sType){jsynchat.ajax({url:ynchat.getConfig('sApiUrl')+'ynchat/updateUserBoxSetting',type:"POST",timeout:ynchat.getConfig('iTimeOut'),data:{action:"updateUserBoxSetting",iUserId:iUserId,sType:sType,sUserIdHash:ynchat.getConfig('sUserIdHash')},success:function(sOutput){},error:function(x,t,m){}});},drawChatBoxByUserId:function(iUserId,bReceiver,oExtra,bUpdateStatus,bFocus)
{var bShouldAddMessage=true;var elId='#ynchat-friend-'+iUserId;if(jsynchat(elId).length>0){ynchat.updateUserBoxSetting(iUserId,'open');if(undefined!=bUpdateStatus&&bUpdateStatus){jsynchat(elId+' .status').removeClass('offline');jsynchat(elId+' .status').addClass('available');}
var sFullName=jsynchat(elId).data('full-name');var sUserName=jsynchat(elId).data('user-name');var sLink=jsynchat(elId).data('link');var sBoxId="ynchat-box-user-"+iUserId;if(jsynchat('#'+sBoxId).length==0){bShouldAddMessage=false;var sHtml='';sHtml+='<div id="'+sBoxId+'" class="chatboxuser" data-userid="'+iUserId+'">';sHtml+='<div class="outer">';sHtml+='<div class="inner">';sHtml+='<div class="headerbar">';sHtml+='<div class="buttonbar">';sHtml+='<div class="ynchat-close">';sHtml+='<a href="#">close';sHtml+='</a>';sHtml+='</div>';sHtml+='<div class="setting">';sHtml+='<a href="#" class="btn-setting"></a>';sHtml+='<div class="menu">';sHtml+=ynchat.boxButtonBarGetFormSetting(iUserId);sHtml+='</div>';sHtml+='</div>';sHtml+='</div>';sHtml+='<div class="title">';sHtml+='<a href="#" data-href="'+sLink+'">'+sFullName+'</a>';sHtml+='</div>';sHtml+='</div>';sHtml+='<div class="bodybar ynchat-box-history" draggable ondrop="ynchat.dropFiles(event, this)" ondragover="ynchat.dragoverFiles(event)" ondragenter="ynchat.dragenterFiles(event, this)" onscroll="ynchat.checkNewMessage(this)">';sHtml+='</div>';sHtml+='<div class="footerbar ynchat-box-actions">';sHtml+='<div class="chat-content"><textarea class="chatting"></textarea></div>';sHtml+='<div class="chat-content-attach">';if(ynchat.getConfig('bIsEnablePhotoAction')){sHtml+='<div class="photo" title="'+ynchat.getLang('upload_photo')+'"> <div class="ynchat-button" onclick="ynchat.uploadFilesClick(this, '+iUserId+')"></div> '
sHtml+='<input type="file" class="upload_input" onchange="ynchat.uploadPhotosExec(this, '+iUserId+')" multiple style="position:absolute;left:-999px;width:0px;height:0px;" accept="image/*"/>'
sHtml+='<div class="panel"></div></div>';}
if(ynchat.getConfig('bIsEnableEmoticonStickerAction')){sHtml+='<div title="'+ynchat.getLang('choose_a_sticker_or_emoticon')+'" class="emoticonsticker"> <div class="ynchat-button" ></div> <div class="panel"></div></div>';}
sHtml+='</div>';sHtml+='</div>';sHtml+='<div class="chat-attachment">';sHtml+='<div class="ynchat-loading"><img src="'+ynchat.getConfig('sSiteLink')+'ynchat/static/image/add.gif" alt="Please Wait"/></div>';sHtml+='<div class="ynchat-content"></div>';sHtml+='</div>';sHtml+='</div>';sHtml+='</div>';sHtml+='</div>';var chatBoxs=jsynchat("#ynchat-chatboxtabs .chatboxuser");var chatBoxsLength=chatBoxs.length;if(chatBoxsLength>0){var iframe=jsynchat('#ynchat-iframe-container');var pos=jsynchat(chatBoxs[chatBoxsLength-1]).position();var right=jsynchat(window).width()-pos.left-jsynchat(chatBoxs[chatBoxsLength-1]).width();var pos_remain=(jsynchat(iframe).hasClass('ynchat-floatleft'))?right:pos.left;if(pos_remain<460){if(!jsynchat(chatBoxs[chatBoxsLength-1]).hasClass('focusedtab')){jsynchat(sHtml).insertBefore(jsynchat(chatBoxs[chatBoxsLength-1]));ynchat.moveToHide(chatBoxs[chatBoxsLength-1]);}
else{if(chatBoxsLength>1){jsynchat(sHtml).insertBefore(jsynchat(chatBoxs[chatBoxsLength-2]));ynchat.moveToHide(chatBoxs[chatBoxsLength-2]);}
else{ynchat.moveToHide(sHtml);}}}
else{var hideList=jsynchat("#ynchat-chatboxtabs #ynchat-hidelist");if(hideList.length>0){jsynchat(sHtml).insertBefore(hideList);}
else jsynchat("#ynchat-chatboxtabs").append(sHtml);}}else{var hideList=jsynchat("#ynchat-chatboxtabs #ynchat-hidelist");if(hideList.length>0){jsynchat(sHtml).insertBefore(hideList);}
else jsynchat("#ynchat-chatboxtabs").append(sHtml);}
ynchat.parseByChattingBox['#'+sBoxId]=true;jsynchat('#'+sBoxId+' .headerbar .title a').click(function(e){window.location.href=jsynchat(this).data('href');e.stopPropagation();});jsynchat(function(){jsynchat('#'+sBoxId+' .ynchat-box-actions .chatting').keyup(function(){var pos=0;if(this.selectionStart){pos=this.selectionStart;}else if(document.selection){this.focus();var r=document.selection.createRange();if(r==null){pos=0;}else{var re=this.createTextRange(),rc=re.duplicate();re.moveToBookmark(r.getBookmark());rc.setEndPoint('EndToStart',re);pos=rc.text.length;}}
var sBoxId_height=this.value.substr(0,pos).split("\n").length*18;jsynchat(this).css('height',sBoxId_height);if(sBoxId_height>50){jsynchat('#'+sBoxId+' .chat-content-attach').css('right','17px');}else{jsynchat('#'+sBoxId+' .chat-content-attach').css('right','0');}});});ynchat.fixScrollingAction(jsynchat('#'+sBoxId+' .bodybar'));jsynchat('#'+sBoxId+' .ynchat-box-actions .chatting').liveUrl({apiKeyEmbedly:ynchat.getConfig('sApiKeyEmbedly'),eleIdContainer:'#'+sBoxId,subKeyUp:ynchat.subKeyupChattingTextarea,subPaste:ynchat.subPasteChattingTextarea,loadStart:function(){jsynchat('#'+sBoxId+' .chat-attachment .ynchat-loading').show();},loadEnd:function(){jsynchat('#'+sBoxId+' .chat-attachment .ynchat-loading').hide();},success:function(data){if(true==ynchat.parseByChattingBox[this.eleIdContainer]){var title,subtitle,description,url,imageUrl,iframe='';var media=null;var widthIframe,heightIframe=0;if(undefined!=data.title&&null!=data.title){title=data.title;}
if(undefined!=data.provider_display&&null!=data.provider_display){subtitle=data.provider_display;}
if(undefined!=data.description&&null!=data.description){description=data.description;}
else{description='';}
if(undefined!=data.url&&null!=data.url){url=data.url;}
if(undefined!=data.images&&null!=data.images&&data.images.length>0){imageUrl=data.images[0].url;}
else{imageUrl='';}
if(undefined!=data.media&&null!=data.media&&data.media.type=='video'){media=data.media;widthIframe=media.width;heightIframe=media.height;var width='width="'+media.width+'"';var height='height="'+media.height+'"';iframe=media.html;}
$sHtml='';$sHtml+='<div>';$sHtml+='<div class="ynchat-attachment-close">close</div>';$sHtml+='<div class="ynchat-attachment">';$sHtml+='<div>';$sHtml+='<div class="ynchat-image">';if(imageUrl!='')
$sHtml+='<img alt="" src="'+imageUrl+'">';$sHtml+='</div>';$sHtml+='<div class="ynchat-titledesc">';$sHtml+='<div class="ynchat-title">';$sHtml+='<span>'+title+'</span>';$sHtml+='</div>';$sHtml+='<div class="ynchat-subtitle">';$sHtml+='<span>'+subtitle+'</span>';$sHtml+='</div>';if(description!=''){$sHtml+='<div class="ynchat-summary">';$sHtml+='<span>'+description+'</span>';$sHtml+='</div>';}
$sHtml+='</div>';$sHtml+='</div>';$sHtml+='<input type="hidden" id="title" value="'+title+'" />';$sHtml+='<input type="hidden" id="subtitle" value="'+subtitle+'" />';if(description!='')
$sHtml+='<input type="hidden" id="description" value="'+description+'" />';$sHtml+='<input type="hidden" id="url" value="'+ynhelper.base64_encode(url)+'" />';if(imageUrl!='')
$sHtml+='<input type="hidden" id="imageUrl" value="'+ynhelper.base64_encode(imageUrl)+'" />';$sHtml+='<input type="hidden" id="iframe" value="'+ynhelper.base64_encode(iframe)+'" />';$sHtml+='<input type="hidden" id="widthIframe" value="'+widthIframe+'" />';$sHtml+='<input type="hidden" id="heightIframe" value="'+heightIframe+'" />';$sHtml+='</div>';$sHtml+='</div>';jsynchat('#'+sBoxId+' .chat-attachment .ynchat-content').html($sHtml);jsynchat('#'+sBoxId+' .chat-attachment .ynchat-attachment-close').click(function(){jsynchat('#'+sBoxId+' .chat-attachment .ynchat-content').html('');jsynchat('#'+sBoxId+' .ynchat-box-actions .chatting').trigger('clear');});}else{this.objCore.init();}
ynchat.parseByChattingBox[this.eleIdContainer]=true;}});jsynchat('#'+sBoxId+' .ynchat-box-actions .chatting').keypress(function(e){if(e.keyCode==13&&!e.shiftKey){var sBoxId="ynchat-box-user-"+iUserId;ynchat.parseByChattingBox['#'+sBoxId]=false;console.log('#'+sBoxId+' .chat-attachment .ynchat-content');if(jsynchat('#'+sBoxId+' .chat-attachment .ynchat-content').html().length>0){var upload_files=ynchat.getFiles();if(upload_files.length>0){var box_actions=jsynchat(this).closest('.ynchat-box-actions');var chat_attachment=jsynchat(box_actions).next('.chat-attachment');var loadding=jsynchat(chat_attachment).find('.ynchat-loading')[0];var files_container=jsynchat(chat_attachment).find('.ynchat-content')[0];var files=[];var i=0;var value=jsynchat(this).val();for(i=0;i<upload_files.length;i++){ynchat.readFile(iUserId,files,upload_files[i],value);}
e.preventDefault();jsynchat(loadding).show();jsynchat(this).val('');jsynchat(files_container).empty();}
else{ynchat.sendMessageByAjax(iUserId);ynchat.emptyChatting(iUserId);}}else if((jsynchat.trim(this.value).length)){var iTimeStamp=0;if(jsynchat('#'+sBoxId+' .ynchat-box-history div:last-child').length>0){iTimeStamp=jsynchat('#'+sBoxId+' .ynchat-box-history div:last-child').data('reactid');}
ynchat.sendMessageAsText(iUserId,jsynchat.trim(this.value),0,0);ynchat.emptyChatting(iUserId);ynchat.hideAllEmoticonStickerPopup();}}});jsynchat('#'+sBoxId).click(function(){ynchat.updateStatusMessage(iUserId);});jsynchat('#'+sBoxId+' .footerbar .emoticonsticker .ynchat-button').click(function(e){ynchat.clickEmoticonStickerInBox(this,iUserId);});jsynchat('#'+sBoxId+' .headerbar .setting .menu input').click(function(e){e.stopPropagation();});jsynchat('#'+sBoxId+' .headerbar').click(function(e){ynchat.boxChatHeaderBarClick(iUserId);});ynchat.boxChatHeaderBarClick(iUserId);jsynchat('#'+sBoxId+' .headerbar .buttonbar .ynchat-close a').click(function(e){ynchat.boxButtonBarClickClose(iUserId);e.stopPropagation();return false;});jsynchat('#'+sBoxId+' .headerbar .buttonbar .setting a').click(function(e){ynchat.hideAllEmoticonStickerPopup();ynchat.boxButtonBarClickSetting(iUserId);e.preventDefault();e.stopPropagation();});jsynchat('#'+sBoxId+' .headerbar .buttonbar .setting li').click(function(e){var action=jsynchat(this).data('action');jsynchat('#'+sBoxId+' .headerbar .buttonbar .setting .menu').removeClass('active');switch(action){case'get_old_conversation':ynchat.getOldConversation(iUserId,'yesterday');break;case'add_files':ynchat.uploadFilesClick(this,' + iUserId + ');break;}
e.stopPropagation();});}else{var parent=jsynchat('#'+sBoxId).parent();if(jsynchat(parent).attr('id')=='ynchat-hidetabs'){var chatboxs=jsynchat('#ynchat-chatboxtabs .chatboxuser');var chatboxslength=chatboxs.length;if(chatboxslength>0){if(jsynchat(chatboxs[chatboxslength-1]).hasClass('focusedtab')){if(chatboxslength>1){jsynchat('#'+sBoxId).detach().insertBefore(chatboxs[chatboxslength-1]);jsynchat("#ynchat-hidelist #hideuser_"+iUserId).remove();ynchat.moveToHide(chatboxs[chatboxslength-2]);}
else{ynchat.updateNewMessage(iUserId);}}
else{ynchat.moveToHide(chatboxs[chatboxslength-1]);jsynchat('#'+sBoxId).detach().insertBefore('#ynchat-hidelist');jsynchat("#ynchat-hidelist #hideuser_"+iUserId).remove();}}}
jsynchat('#'+sBoxId).addClass('active');}
if(bFocus){setTimeout(function()
{jsynchat('#'+sBoxId+' .ynchat-box-actions .chatting').focus();ynchat.updateStatusMessage(iUserId);},500);}
if(!jsynchat('#ynchat-iframe-container').hasClass('ynchat-box-chatting')){jsynchat('#ynchat-iframe-container').addClass('ynchat-box-chatting');}}else{if(bReceiver){ynchat.__getOneMessage(iUserId,bReceiver,oExtra);bShouldAddMessage=false;}}
if(ynchat.isMobile()){totalWaitingMess=$('#ynchat-chatboxtabs .chatboxuser').length+$('#ynchat-hidetabs .chatboxuser').length;if(parseInt(totalWaitingMess)>0){if(ynchat.getConfig('iPlacementOfChatFrame')==2){$("#ynchat_number_waiting_sender").html("<i style=\"right:-5px;left:auto\">"+totalWaitingMess+"</i>");}
else{$("#ynchat_number_waiting_sender").html("<i>"+totalWaitingMess+"</i>");}}
else{$("#ynchat_number_waiting_sender").html("");}}
return bShouldAddMessage;},sendMessageByAjax:function(iUserId){if(null!=ynchat.oConnection&&'disconnect'==ynchat.oConnection.getStatus()){return ynchat.handleInvalidConnection();}
var sBoxId="ynchat-box-user-"+iUserId;var eleAttachment='#'+sBoxId+' .chat-attachment .ynchat-content';var text=jsynchat('#'+sBoxId+' .ynchat-box-actions .chatting').val();var title=jsynchat(eleAttachment).find('#title').val();var url=jsynchat(eleAttachment).find('#url').val();var imageUrl=jsynchat(eleAttachment).find('#imageUrl').val();var iframe=jsynchat(eleAttachment).find('#iframe').val();var widthIframe=jsynchat(eleAttachment).find('#widthIframe').val();var heightIframe=jsynchat(eleAttachment).find('#heightIframe').val();jsynchat.ajax({url:ynchat.getConfig('sApiUrl')+'ynchat/sendMessageByAjax',type:"POST",timeout:ynchat.getConfig('iTimeOut'),data:{action:"sendMessageByAjax",iUserId:iUserId,text:text,title:title,url:url,imageUrl:imageUrl,iframe:iframe,widthIframe:widthIframe,heightIframe:heightIframe,sUserIdHash:ynchat.getConfig('sUserIdHash')},success:function(sOutput){var oOutput=jsynchat.parseJSON(sOutput);if(oOutput.error_code>0){alert(oOutput.error_message);}else{var sBoxId='#ynchat-box-user-'+oOutput.iUserId;jsynchat(sBoxId+' .chat-attachment .ynchat-attachment-close').trigger('click');ynchat.parseByChattingBox[sBoxId]=true;ynchat.sendMessageAsText(oOutput.aMessage.iReceiverId,'',oOutput.aMessage.iMessageId,0);}},error:function(x,t,m){if(t==="timeout"){ynchat.showError(ynchat.getLang('connection_timed_out_please_try_again'));}else{}}});},subKeyupChattingTextarea:function(e,ele){if(e.keyCode==13&&!e.shiftKey&&ynchat.bPasting==false){}
ynchat.bPasting=false;},emptyChatting:function(userid){var ele='#ynchat-box-user-'+userid+' .footerbar .chatting';jsynchat(ele).val('');jsynchat(ele).html('');jsynchat(ele).removeAttr('style');jsynchat(ele).closest(".inner").find('.chat-attachment .ynchat-attachment-close').trigger('click');setTimeout(function()
{jsynchat(ele).val('');jsynchat(ele).html('');jsynchat(ele).removeAttr('style');},100);},subPasteChattingTextarea:function(e,ele){ynchat.bPasting=true;if(ynchat.bFirstPasting==false){ynchat.bFirstPasting=true;var text=(e.originalEvent||e).clipboardData.getData('text/plain')||prompt('');}},boxButtonBarClickClose:function(userid)
{totalWaitingMess=parseInt(totalWaitingMess)-1;if(parseInt(totalWaitingMess)>0){if(ynchat.getConfig('iPlacementOfChatFrame')==2){$("#ynchat_number_waiting_sender").html("<i style=\"right:-5px;left:auto\">"+totalWaitingMess+"</i>");}
else{$("#ynchat_number_waiting_sender").html("<i>"+totalWaitingMess+"</i>");}}
else{$("#ynchat_number_waiting_sender").html("");}
ynchat.updateUserBoxSetting(userid,'close');var ele='#ynchat-box-user-'+userid;if(jsynchat(ele).length>0){jsynchat(ele).remove();}
var chatboxs=jsynchat('#ynchat-chatboxtabs .chatboxuser');var hidelist=jsynchat('#ynchat-chatboxtabs #ynchat-hidelist');var hidetabs=jsynchat('#ynchat-hidetabs .chatboxuser');if(chatboxs.length>0&&hidetabs.length>0){var iframe=jsynchat('#ynchat-iframe-container');var pos=jsynchat(chatboxs[chatboxs.length-1]).position();var right=jsynchat(window).width()-pos.left-jsynchat(chatboxs[chatboxs.length-1]).width();var pos_remain=(jsynchat(iframe).hasClass('ynchat-floatleft'))?right:pos.left;if(pos_remain>460){var id=jsynchat(hidetabs[0]).attr('data-userid');ynchat.updateStatusMessage(id);var li=jsynchat('#hideuser_'+id);var parent=li.parent();li.remove();jsynchat(hidetabs[0]).detach().insertBefore(hidelist);ynchat.scrollToBottom('#ynchat-box-user-'+id+' .ynchat-box-history',100,1000);if(jsynchat(parent).children().length==0){jsynchat(jsynchat(parent).parent()).remove();}}}
else if(hidetabs.length>0){var id=jsynchat(hidetabs[0]).attr('data-userid');ynchat.updateStatusMessage(id);var li=jsynchat('#hideuser_'+id);var parent=li.parent();li.remove();jsynchat(hidetabs[0]).detach().insertBefore(hidelist);if(jsynchat(parent).children().length==0){jsynchat(jsynchat(parent).parent()).remove();}}
if(jsynchat('#ynchat-chatboxtabs > div').length==0){jsynchat('#ynchat-iframe-container').removeClass('ynchat-box-chatting');}},boxButtonBarClickSetting:function(userid)
{var ele='#ynchat-box-user-'+userid;var eleSettingMenu='#ynchat-box-user-'+userid+' .headerbar .buttonbar .setting .menu';if(jsynchat(ele).length>0){if(jsynchat(eleSettingMenu).hasClass('ynopen')==false){jsynchat('.ynopen').removeClass('ynopen');jsynchat(eleSettingMenu).addClass('ynopen');}else{jsynchat(eleSettingMenu).removeClass('ynopen');}}},boxChatHeaderBarClick:function(userid)
{var eleBoxChat="#ynchat-box-user-"+userid;jsynchat(eleBoxChat).toggleClass('active');if(jsynchat(eleBoxChat+' .count-new-message').length>0){jsynchat(eleBoxChat+' .count-new-message').remove();ynchat.scrollToBottom(eleBoxChat+' .ynchat-box-history',100,1000);ynchat.removeNewMessageInFriendsList(userid);}
ynchat.scrollToBottom(jsynchat(eleBoxChat+' .bodybar'),100,1000);},boxButtonBarGetFormSetting:function(userid){var sForm='';sForm+='<div data-userid="'+userid+'">';sForm+='<ul>';sForm+='<li data-action="get_old_conversation">'+ynchat.getLang('view_old_conversation')+'</li>';if(!ynchat.isMobile()){sForm+='<li data-action="add_files">'+ynchat.getLang('add_files')+'</li>';}
sForm+='<input type="file" class="upload_input" onchange="ynchat.uploadFilesExec(this, '+userid+')" multiple style="position:absolute;left:-999px;width:0px;height:0px;"/>'
sForm+='</ul>';sForm+='</div>';return sForm;},getOldConversation:function(userid,type){jsynchat.ajax({url:ynchat.getConfig('sApiUrl')+'ynchat/getOldConversation',type:"POST",timeout:ynchat.getConfig('iTimeOut'),data:{action:"getOldConversation",iUserId:userid,sType:type,sUserIdHash:ynchat.getConfig('sUserIdHash')},success:function(sOutput){var oOutput=jsynchat.parseJSON(sOutput);if(oOutput.error_code>0){alert(oOutput.error_message);}else{ynchat.renderOldConversation(oOutput);}},error:function(x,t,m){if(t==="timeout"){ynchat.showError(ynchat.getLang('connection_timed_out_please_try_again'));}else{}}});},renderOldConversation:function(data){var sForm='';var idx=0;var aMessages=data.aMessages;var iFriendId=data.iUserId;var type=data.sType;sForm+='<div class="headeroldconversation padding-bottom">';sForm+='<span>'+ynchat.getLang('show_message_from')+':</span> ';if('yesterday'==type){sForm+='<b>'+ynchat.getLang('yesterday')+'</b>';}else{sForm+='<a href="#" onclick="ynchat.getOldConversation('+iFriendId+', \'yesterday\'); return false;">'+ynchat.getLang('yesterday')+'</a>';}
if('week'==type){sForm+=' - <b>7 '+ynchat.getLang('days')+'</b>';}else{sForm+=' - <a href="#" onclick="ynchat.getOldConversation('+iFriendId+', \'week\'); return false;">7 '+ynchat.getLang('days')+'</a>';}
if('month'==type){sForm+=' - <b>30 '+ynchat.getLang('days')+'</b>';}else{sForm+=' - <a href="#" onclick="ynchat.getOldConversation('+iFriendId+', \'month\'); return false;">30 '+ynchat.getLang('days')+'</a>';}
if('quarter'==type){sForm+=' - <b>3 '+ynchat.getLang('month')+'</b>';}else{sForm+=' - <a href="#" onclick="ynchat.getOldConversation('+iFriendId+', \'quarter\'); return false;">3 '+ynchat.getLang('month')+'</a>';}
sForm+='</div>';sForm+='<div class="bodyoldconversation">';if(aMessages.length>0){var sDate='';for(idx=0;idx<aMessages.length;idx++){if(sDate!=aMessages[idx].sDate){sDate=aMessages[idx].sDate;sForm+='<div class="message-date"><span>';sForm+=sDate;sForm+='</span></div>';}
if(aMessages[idx].iSenderId==iFriendId){sForm+=ynchat.displayIntoBoxOldConversationAsReceiver(aMessages[idx]);}else{sForm+=ynchat.displayIntoBoxOldConversationAsSender(aMessages[idx]);}}}
sForm+='</div>';var ele='#oldconversation_'+iFriendId;if(jsynchat(ele).length>0){jsynchat(ele).html(sForm);}else{sForm='<div id="oldconversation_'+iFriendId+'">'+sForm+'</div>';jsynchat('.ynopen').removeClass('ynopen');ynchat.openPopupModal(ynchat.getLang('message_history'),sForm,'500px','auto');ynchat.fixScrollingAction(jsynchat('.bodyoldconversation'));}},displayIntoBoxOldConversationAsReceiver:function(oData)
{var elId='#ynchat-friend-'+oData.iSenderId;if(jsynchat(elId).length>0){var sFullName=jsynchat(elId).data('full-name');var sAvatar=jsynchat(elId).data('avatar');var sLink=jsynchat(elId).data('link');var sHtml='';sHtml+='<div class="line-message receiver" data-reactid="'+oData.iTimeStamp+'_'+oData.iMessageId+'" >';sHtml+='<div>';sHtml+='<div class="message">';sHtml+='<span class="message-name">';sHtml+='<a href="'+sLink+'" target="_blank"><image alt="'+sFullName+'" src="'+sAvatar+'" /></a>';sHtml+='</span>';sHtml+='<span class="message-content">';switch(oData.type){case'link':case'video':var attachment=JSON.parse(oData.data);sHtml+='<div>';sHtml+='<div>';sHtml+='<span>'+oData.sText+'</span>';if('video'==oData.type){sHtml+='<a class="ynchat-playvideo" onclick="ynchat.showVideoInPopup(this); return false;" data-iframe="'+attachment.iframe+'" data-width="'+attachment.widthIframe+'" data-height="'+attachment.heightIframe+'"></a>';}
sHtml+='</div>';sHtml+='<div class="ynchat-link">';sHtml+='<div>';sHtml+='<div>';sHtml+='<a target="_blank" href="'+ynhelper.base64_decode(attachment.url)+'" >';sHtml+='<img src="'+ynhelper.base64_decode(attachment.imageUrl)+'" alt="">';sHtml+='</a>';sHtml+='</div>';sHtml+='<div>';sHtml+='<div>';sHtml+='<a href="'+ynhelper.base64_decode(attachment.url)+'" target="_blank" >'+(attachment.title)+'</a>';sHtml+='</div>';sHtml+='<div>';sHtml+=ynhelper.base64_decode(attachment.url);sHtml+='</div>';sHtml+='</div>';sHtml+='</div>';sHtml+='</div>';sHtml+='</div>';break;case'file':var upload_files=JSON.parse(oData.data);for(var i=0;i<upload_files.length;i++){var url=ynchat.getConfig('sApiUrl')+'ynchat/download?id='+upload_files[i].id;if(upload_files[i].type&&upload_files[i].type.substring(0,5)=='image'){sHtml+='<div class="link_image"><img onclick="ynchat.showPhotoInPopup(this); return false;" data-url="'+url+'" src="'+url+'"/></div>';}
sHtml+='<p><a href='+url+' download="'+upload_files[i].name+'" style="color:#333;" target="_blank">'+upload_files[i].name+'</a></p>';}
sHtml+=oData.sText;break;default:sHtml+=oData.sText;break;}
sHtml+='</span>';sHtml+='</div>';sHtml+='<div class="datetime">';sHtml+='<span>'+oData.sTime+'</span>';sHtml+='</div>';sHtml+='</div>';sHtml+='</div>';return sHtml;}},displayIntoBoxOldConversationAsSender:function(oData)
{var sHtml='';var text=oData.sText;sHtml+='<div class="line-message sender" data-reactid="'+oData.iTimeStamp+'_'+oData.iMessageId+'" >';sHtml+='<div>';sHtml+='<div class="message message-owner">';sHtml+='<span class="message-content">'
switch(oData.type){case'link':case'video':var attachment=JSON.parse(oData.data);sHtml+='<div>';sHtml+='<div>';sHtml+='<span>'+text+'</span>';if('video'==oData.type){sHtml+='<a class="ynchat-playvideo" onclick="ynchat.showVideoInPopup(this); return false;" data-iframe="'+attachment.iframe+'" data-width="'+attachment.widthIframe+'" data-height="'+attachment.heightIframe+'"></a>';}
sHtml+='</div>';sHtml+='<div class="ynchat-link">';sHtml+='<div>';sHtml+='<div>';sHtml+='<a target="_blank" href="'+ynhelper.base64_decode(attachment.url)+'" >';sHtml+='<img src="'+ynhelper.base64_decode(attachment.imageUrl)+'" alt="">';sHtml+='</a>';sHtml+='</div>';sHtml+='<div>';sHtml+='<div>';sHtml+='<a href="'+ynhelper.base64_decode(attachment.url)+'" target="_blank" >'+(attachment.title)+'</a>';sHtml+='</div>';sHtml+='<div>';sHtml+=ynhelper.base64_decode(attachment.url);sHtml+='</div>';sHtml+='</div>';sHtml+='</div>';sHtml+='</div>';sHtml+='</div>';break;case'file':var upload_files=JSON.parse(oData.data);for(var i=0;i<upload_files.length;i++){var url=ynchat.getConfig('sApiUrl')+'ynchat/download?id='+upload_files[i].id;if(upload_files[i].type&&upload_files[i].type.substring(0,5)=='image'){sHtml+='<div class="link_image"><img onclick="ynchat.showPhotoInPopup(this); return false;" data-url="'+url+'" src="'+url+'"/></div>';}
sHtml+='<p><a href='+url+' download="'+upload_files[i].name+'" style="color:#333;" target="_blank">'+upload_files[i].name+'</a></p>';}
sHtml+=text;break;default:sHtml+=text;break;}
sHtml+='</span>';sHtml+='</div>';sHtml+='<div class="datetime">';sHtml+='<span>'+oData.sTime+'</span>';sHtml+='</div>';sHtml+='</div>';sHtml+='</div>';return sHtml;},__getOneMessage:function(iFriendId,bReceiver,oExtra)
{jsynchat.ajax({url:ynchat.getConfig('sApiUrl')+'ynchat/threadInfo',type:"POST",timeout:ynchat.getConfig('iTimeOut'),data:{action:"threadInfo",iFriendId:iFriendId,iReceiver:bReceiver?1:0,iMessageId:(oExtra==null?0:oExtra.iMessageId),iNew:1,sUserIdHash:ynchat.getConfig('sUserIdHash')},success:function(sOutput){var oOutput=jsynchat.parseJSON(sOutput);if(oOutput.error_code>0){ynchat.showError(oOutput.error_message);}else{var aFriend=oOutput.aFriend;var aMessage=oOutput.aMessage;if(undefined!=aFriend.user_id&&null!=aFriend.user_id){ynchat.__addNewFriendIntoFriendList(aFriend);}
var bReceiver=false;if(oOutput.iReceiver=='1'){bReceiver=true;}
ynchat.drawChatBoxByUserId(aMessage.iSenderId,bReceiver,aMessage,true,false);ynchat.displayIntoBoxHistoryAsReceiver(aMessage);ynchat.__getMoreMessages(aMessage.iSenderId,bReceiver,aMessage);var eleParent='#ynchat-box-user-'+aMessage.iSenderId+' .ynchat-box-history';var eleChild='.line-message';ynchat.sortMessageInUserChatBox(eleParent,eleChild);}},error:function(x,t,m){if(t==="timeout"){ynchat.showError(ynchat.getLang('connection_timed_out_please_try_again'));}else{}}});},__getMoreMessages:function(iFriendId,bReceiver,oExtra)
{jsynchat.ajax({url:ynchat.getConfig('sApiUrl')+'ynchat/threadInfo',type:"POST",timeout:ynchat.getConfig('iTimeOut'),data:{action:"threadInfo",iFriendId:iFriendId,iReceiver:bReceiver?1:0,iMessageId:(oExtra==null?0:oExtra.iMessageId),iNew:0,sUserIdHash:ynchat.getConfig('sUserIdHash')},success:function(sOutput){var oOutput=jsynchat.parseJSON(sOutput);if(oOutput.error_code>0){ynchat.showError(oOutput.error_message);}else{var aMoreMessages=oOutput.aMoreMessages;var iFriendId=oOutput.iFriendId;if(aMoreMessages.length>0){for(var idx=0;idx<aMoreMessages.length;idx++){if(aMoreMessages[idx].iSenderId==iFriendId){ynchat.displayIntoBoxHistoryAsReceiver(aMoreMessages[idx]);}else{ynchat.displayIntoBoxHistoryAsSender(aMoreMessages[idx],false,false,false);}}
var eleParent='#ynchat-box-user-'+iFriendId+' .ynchat-box-history';var eleChild='.line-message';ynchat.sortMessageInUserChatBox(eleParent,eleChild);ynchat.scrollToBottom(eleParent,750,1000);}}},error:function(x,t,m){if(t==="timeout"){ynchat.showError(ynchat.getLang('connection_timed_out_please_try_again'));}else{}}});},sortMessageInUserChatBox:function(eleParent,eleChild)
{jsynchat(eleParent+' '+eleChild).tsort("",{order:'asc',attr:"data-reactid"});},__addNewFriendIntoFriendList:function(aUser)
{var elId='#ynchat-friend-'+aUser.user_id;if(jsynchat(elId).length==0){var sHtml='';sHtml+='<li id="ynchat-friend-'+aUser.user_id+'" data-user-id="'+aUser.user_id+'" data-status="'+aUser.status+'" data-avatar="'+aUser.avatar+'" data-link="'+aUser.link+'" data-full-name="'+aUser.full_name+'" data-user-name="'+aUser.user_name+'" >';sHtml+='<div class="avatar"><img src="'+aUser.avatar+'" /></div>';sHtml+='<div class="user-status">';if(aUser.status=='available'){if(aUser.agent=='web'){sHtml+=ynchat.getLang('web');}
else
if(aUser.agent=='mobile'){sHtml+=ynchat.getLang('mobile');}}
sHtml+='<div class="status '+aUser.status+'"></div></div>';sHtml+='<div class="name">'+aUser.full_name+'</div>';sHtml+='</li>';jsynchat("#ynchat-main-content #ynchat-friend-list .bodybar .default > ul").prepend(sHtml);jsynchat('#ynchat-friend-'+aUser.user_id).click(function(e)
{var iUserId=jsynchat(this).data('user-id');ynchat.selectFriendInList(iUserId,false,null,false);});}},selectFriendInList:function(iUserId,bReceiver,oExtra,bUpdateStatus)
{ynchat.updateHideListNewMessage();ynchat.removeNewMessageInFriendsList(iUserId);var bShouldAddMessage=ynchat.drawChatBoxByUserId(iUserId,bReceiver,oExtra,bUpdateStatus,true);ynchat.removeNewMessageInFriendsList(iUserId);if(bShouldAddMessage==false){ynchat.__getMoreMessages(iUserId,bReceiver,oExtra);}},getUnreadBox:function(){if(!ynchat.getUserSettings('iIsGoOnline')){return false;}
jsynchat.ajax({url:ynchat.getConfig('sApiUrl')+'ynchat/getUnreadBox',type:"POST",timeout:ynchat.getConfig('iTimeOut'),data:{action:"getUnreadBox",sUserIdHash:ynchat.getConfig('sUserIdHash')},success:function(sOutput){var oOutput=jsynchat.parseJSON(sOutput);if(oOutput.error_code>0){ynchat.showError(oOutput.error_message);}else{var aUnreadBox=oOutput.aUnreadBox;for(var idx=0;idx<aUnreadBox.length;idx++){var aSenderInfo=aUnreadBox[idx].aSenderInfo;var aMessages=aUnreadBox[idx].aMessages;ynchat.__addNewFriendIntoFriendList(aSenderInfo);ynchat.drawChatBoxByUserId(aSenderInfo.user_id,true,aMessages[0],false,false);if(aUnreadBox[idx].iUnread==1){ynchat.updateNewMessage(aSenderInfo.user_id);}
for(var idxMsg=(aMessages.length-1);idxMsg>=0;idxMsg--){if(aMessages[idxMsg].iSenderId==aSenderInfo.user_id){ynchat.displayIntoBoxHistoryAsReceiver(aMessages[idxMsg]);}else{ynchat.displayIntoBoxHistoryAsSender(aMessages[idxMsg],false,false,false);}}
var eleParent='#ynchat-box-user-'+aSenderInfo.user_id+' .ynchat-box-history';var eleChild='.line-message';ynchat.sortMessageInUserChatBox(eleParent,eleChild);ynchat.scrollToBottom(eleParent,750,1000);jsynchat('#ynchat-box-user-'+aSenderInfo.user_id).removeClass('active');}}
if(ynchat.bRunning==false){ynchat.disableIframe();}},error:function(x,t,m){if(t==="timeout"){ynchat.showError(ynchat.getLang('connection_timed_out_please_try_again'));}else{}}});},addFocusClass:function(iFriendId)
{ynchat.removeFocusClassAllChatBoxes();jsynchat('#ynchat-box-user-'+iFriendId).addClass('focusedtab');},removeFocusClassAllChatBoxes:function()
{jsynchat('#ynchat-main-content #ynchat-chatboxtabs .chatboxuser').removeClass('focusedtab');},updateStatusMessage:function(iFriendId)
{ynchat.addFocusClass(iFriendId);if(undefined!=ynchat.readStatus[iFriendId]&&null!=ynchat.readStatus[iFriendId]&&false==ynchat.readStatus[iFriendId]){ynchat.readStatus[iFriendId]=true;jsynchat.ajax({url:ynchat.getConfig('sApiUrl')+'ynchat/updateStatusMessage',type:"POST",timeout:ynchat.getConfig('iTimeOut'),data:{action:"updateStatusMessage",iFriendId:iFriendId,sUserIdHash:ynchat.getConfig('sUserIdHash')},success:function(sOutput){var oOutput=jsynchat.parseJSON(sOutput);if(oOutput.error_code>0){ynchat.showError(oOutput.error_message);}},error:function(x,t,m){if(t==="timeout"){ynchat.showError(ynchat.getLang('connection_timed_out_please_try_again'));}else{}}});}},playSoundNotify:function(iFriendId)
{if(ynchat.getUserSettings('iIsNotifySound')){jsynchat('#chatAudio')[0].play();}},getFormUploadPhoto:function(userid)
{var sForm='';sForm+='<form action="'+ynchat.getConfig('sApiUrl')+'ynchat/uploadPhoto" onSubmit="return false" method="post" enctype="multipart/form-data" id="uploadphoto_'+userid+'">';sForm+='<input type="hidden" value="'+userid+'" id="iUserId" name="iUserId">';sForm+='<input name="image" id="imageInput" type="file" />';sForm+='<input type="submit" id="submit-btn" value="'+ynchat.getLang('upload')+'" />';sForm+='<img src="'+ynchat.getConfig('sSiteLink')+'ynchat/static/image/add.gif" id="loading-img" style="display:none;" alt="Please Wait"/>';sForm+='</form>';sForm+='<div id="progressbox" style="display:none;"><div id="progressbar"></div><div id="statustxt">0%</div></div>';sForm+='<div class="output"></div>';return sForm;},uploadFilesClick:function(ele,userid){if(null!=ynchat.oConnection&&'disconnect'==ynchat.oConnection.getStatus()){return ynchat.handleInvalidConnection();}
var parent=jsynchat(ele).parent();if(jsynchat('#uploadphoto_'+userid).length==0){var input=jsynchat(ele).next('.upload_input');jsynchat(input).trigger('click');}
jsynchat(parent).closest('.menu').toggleClass('ynopen');},uploadFilesExec:function(ele,userid){if(null!=ynchat.oConnection&&'disconnect'==ynchat.oConnection.getStatus()){return ynchat.handleInvalidConnection();}
var files=jsynchat(ele).prop('files');var inner=jsynchat(ele).closest('.inner');var box_actions=jsynchat(inner).find('.ynchat-box-actions')[0];var chat_attachment=jsynchat(box_actions).next('.chat-attachment');var files_container=jsynchat(chat_attachment).find('.ynchat-content')[0];var chatinput=jsynchat(box_actions).find('.chatting')[0];if(files.length>0){for(var i=0;i<files.length;i++){ynchat.addFile(files[i]);var file_div=jsynchat('<div />',{'class':'file_div'});var file_name=jsynchat('<span />',{'class':'file_name',text:files[i].name});var remove_btn=jsynchat('<span />',{'class':'remove_file','text':'','click':function(){var parent=jsynchat(this).parent();var index=jsynchat(parent).index();jsynchat(parent).remove();ynchat.removeFile(index);}});file_div.append(remove_btn);file_div.append(file_name);jsynchat(files_container).append(file_div);jsynchat(chatinput).focus();}}
jsynchat(ele).val('');},uploadPhotosExec:function(ele,userid){if(null!=ynchat.oConnection&&'disconnect'==ynchat.oConnection.getStatus()){return ynchat.handleInvalidConnection();}
var box_actions=jsynchat(ele).closest('.ynchat-box-actions')[0];var chat_attachment=jsynchat(box_actions).next('.chat-attachment');var loadding=jsynchat(chat_attachment).find('.ynchat-loading')[0];var chatinput=jsynchat(box_actions).find('.chatting')[0];var photos=jsynchat(ele).prop('files');if(photos.length>0){var files=[];for(var i=0;i<photos.length;i++){var type=photos[i].type;switch(type){case'image/png':case'image/gif':case'image/jpeg':case'image/pjpeg':ynchat.photos.push(photos[i]);ynchat.readFile(userid,files,photos[i],'',true);break;}}
if(ynchat.photos.length>0){jsynchat(loadding).show();jsynchat(chatinput).focus();}
else{alert(ynchat.getLang('please_try_again_make_sure_you_are_uploading_a_valid_photo'));}}},readFile:function(id,files,file,value,isPhoto){var name=file.name;if(window.FileReader){var reader=new FileReader();var rawData=new ArrayBuffer();reader.onload=function(e){rawData=e.target.result;var file_item={};file_item['file_name']=name;file_item['file_data']=rawData;files.push(file_item);if(!isPhoto){if(files.length==ynchat.files.length){var upload_files=[];ynchat.sendMessageWithFiles(id,value,files,upload_files,isPhoto);}}
else{if(files.length==ynchat.photos.length){var upload_files=[];ynchat.sendMessageWithFiles(id,value,files,upload_files,isPhoto);}}};reader.readAsDataURL(file);}},sendMessageWithFiles:function(iReceiverId,message,files,upload_files,isPhoto){if(files.length>0){jsynchat.ajax({url:ynchat.getConfig('sApiUrl')+'ynchat/upload',type:"POST",timeout:ynchat.getConfig('iTimeOut'),data:{iReceiverId:iReceiverId,fileName:files[0].file_name,fileData:files[0].file_data},success:function(sOutput){var oOutput=jsynchat.parseJSON(sOutput);if(oOutput.error_code>0){var sBoxId="ynchat-box-user-"+iReceiverId;var element='#'+sBoxId+' .ynchat-box-history';var inner=jsynchat(element).closest('.inner');var loadding=jsynchat(inner).find('.ynchat-loading')[0];jsynchat(loadding).hide();ynchat.files=[];alert(oOutput.error_message);}else{var file={'id':oOutput.id,'name':oOutput.name,'type':oOutput.type};upload_files.push(file);files.splice(0,1);ynchat.sendMessageWithFiles(iReceiverId,message,files,upload_files,isPhoto);}},error:function(x,t,m){if(t==="timeout"){ynchat.showError(ynchat.getLang('connection_timed_out_please_try_again'));}else{}}});}
else{var action='sendMessageWithFiles';var data={iUserId:ynchat.getUserSettings('iUserId'),iReceiverId:iReceiverId,sText:message,files:JSON.stringify(upload_files)};var sObject=ynchat.generateSendingData(action,data);ynchat.connectionSend(sObject);if(isPhoto==true){ynchat.photos=[];}
else{ynchat.files=[];}
var sBoxId="ynchat-box-user-"+iReceiverId;var element='#'+sBoxId+' .ynchat-box-history';var inner=jsynchat(element).closest('.inner');var loadding=jsynchat(inner).find('.ynchat-loading')[0];jsynchat(loadding).hide();}},sendMessageWithFilesRes:function(oData){if(oData.iSenderId!=ynchat.getUserSettings('iUserId')){var ele='#ynchat-box-user-'+oData.iSenderId+' .footerbar .chatting';var eleParent='#ynchat-box-user-'+oData.iSenderId+' .ynchat-box-history';var oldHeight=0;var bShouldAddMessage=ynchat.drawChatBoxByUserId(oData.iSenderId,true,oData,true,false);oldHeight=jsynchat(eleParent)[0].scrollHeight;if(bShouldAddMessage){oData.sText=ynchat.prepareDisplay(oData.sText);ynchat.displayIntoBoxHistoryAsReceiver(oData);}else{ynchat.__getOneMessage(oData.iSenderId,true,oData);}
ynchat.playSoundNotify(oData.iSenderId);ele='#ynchat-box-user-'+oData.iSenderId+' .footerbar .chatting';eleParent='#ynchat-box-user-'+oData.iSenderId+' .ynchat-box-history';if(jsynchat(ele).is(":focus")){ynchat.scrollToBottom(eleParent,100,1000);}
else{if(jsynchat('#ynchat-box-user-'+oData.iSenderId).hasClass('active')){if(jsynchat(eleParent)[0].scrollHeight>jsynchat(eleParent).height()){if(jsynchat(eleParent).scrollTop()+jsynchat(eleParent).innerHeight()<oldHeight){if(jsynchat('#ynchat-box-user-'+oData.iSenderId+' .newMessageNotice').length==0){var newMess=jsynchat('<div />',{'class':'newMessageNotice',text:'Scroll down to see new messages.',click:function(){ynchat.scrollToBottom(eleParent,100,1000);jsynchat(this).remove();ynchat.removeNewMessageInFriendsList(oData.iSenderId);},css:{'z-index':'2009','background':'white','position':'fixed','padding':'5px','text-align':'center','width':'235px','color':'gray','cursor':'pointer'}}).prependTo(jsynchat('#ynchat-box-user-'+oData.iSenderId+' .ynchat-box-history'));}
ynchat.updateNewMessageInFriendsList(oData.iSenderId);}
else{ynchat.scrollToBottom(eleParent,100,1000);}}}
else{ynchat.updateNewMessage(oData.iSenderId);}}}
else{var bShouldAddMessage=ynchat.drawChatBoxByUserId(oData.iReceiverId,true,oData,false,false);oData.sText=ynchat.prepareDisplay(oData.sText);ynchat.displayIntoBoxHistoryAsSender(oData,false,false,false);var eleParent='#ynchat-box-user-'+oData.iReceiverId+' .ynchat-box-history';ynchat.scrollToBottom(eleParent,100,1000);}},clickPhotoInBox:function(ele,userid)
{if(null!=ynchat.oConnection&&'disconnect'==ynchat.oConnection.getStatus()){return ynchat.handleInvalidConnection();}
var parent=jsynchat(ele).parent();if(jsynchat('#uploadphoto_'+userid).length==0){jsynchat(parent).find('.panel').html(ynchat.getFormUploadPhoto(userid));var options={target:'#ynchat-box-user-'+userid+' .footerbar .photo .panel .output',dataType:'json',beforeSubmit:function(){ynchat.uploadPhotoBeforeSubmit(userid);},uploadProgress:function(event,position,total,percentComplete){ynchat.uploadPhotoOnProgress(event,position,total,percentComplete,userid);},success:function(data,status,xhr){ynchat.uploadPhotoAfterSuccess(data,status,xhr,userid);},resetForm:true};jsynchat('#uploadphoto_'+userid).submit(function(){jsynchat(this).ajaxSubmit(options);return false;});}
jsynchat(parent).find('.panel').toggleClass('active');},uploadPhotoBeforeSubmit:function(userid)
{var imageInput='#ynchat-box-user-'+userid+' .footerbar .photo .panel #imageInput';var output='#ynchat-box-user-'+userid+' .footerbar .photo .panel .output';var submit_btn='#ynchat-box-user-'+userid+' .footerbar .photo .panel #submit-btn';var loading_img='#ynchat-box-user-'+userid+' .footerbar .photo .panel #loading-img';var progressbox=jsynchat('#ynchat-box-user-'+userid+' .footerbar .photo .panel #progressbox');var progressbar=jsynchat('#ynchat-box-user-'+userid+' .footerbar .photo .panel #progressbar');var statustxt=jsynchat('#ynchat-box-user-'+userid+' .footerbar .photo .panel #statustxt');var completed='0%';if(window.File&&window.FileReader&&window.FileList&&window.Blob)
{if(!jsynchat(imageInput).val())
{jsynchat(output).html("Are you kidding me?");return false}
var fsize=jsynchat(imageInput)[0].files[0].size;var ftype=jsynchat(imageInput)[0].files[0].type;switch(ftype)
{case'image/png':case'image/gif':case'image/jpeg':case'image/pjpeg':break;default:jsynchat(output).html("<b>"+ftype+"</b> Unsupported file type!");return false}
if(fsize>ynchat.getConfig('iImageSizeLimit'))
{jsynchat(output).html("<b>"+ynhelper.bytesToSize(fsize)+"</b> "+ynchat.getLang('too_big_image_file')+" <br />"+ynchat.getLang('please_try_another_image'));return false}
progressbox.show();progressbar.width(completed);statustxt.html(completed);statustxt.css('color','#000');jsynchat(submit_btn).hide();jsynchat(loading_img).show();jsynchat(output).html("");}
else
{jsynchat(output).html("Please upgrade your browser, because your current browser lacks some new features we need!");return false;}},uploadPhotoOnProgress:function(event,position,total,percentComplete,userid)
{var progressbar=jsynchat('#ynchat-box-user-'+userid+' .footerbar .photo .panel #progressbar');var statustxt=jsynchat('#ynchat-box-user-'+userid+' .footerbar .photo .panel #statustxt');progressbar.width(percentComplete+'%')
statustxt.html(percentComplete+'%');if(percentComplete>50)
{statustxt.css('color','#fff');}},uploadPhotoAfterSuccess:function(data,status,xhr,userid)
{var submit_btn='#ynchat-box-user-'+userid+' .footerbar .photo .panel #submit-btn';var loading_img='#ynchat-box-user-'+userid+' .footerbar .photo .panel #loading-img';var progressbox=jsynchat('#ynchat-box-user-'+userid+' .footerbar .photo .panel #progressbox');jsynchat(submit_btn).show();jsynchat(loading_img).hide();progressbox.hide();if(undefined!=data.aMessage&&null!=data.aMessage){ynchat.sendMessageAsText(userid,'',data.aMessage.iMessageId,0);}},getFormAttachVideo:function(userid)
{var sForm='';sForm+='<div>';sForm+='<input type="text" class="input-video" value="" data-userid="'+userid+'"/>';sForm+='<div class="extra_info"></div>';sForm+='</div>';sForm+='<div>';sForm+='<button type="button" class="button-video btn btn-primary btn-sm">'+ynchat.getLang('add')+'</button>';sForm+='</div>';return sForm;},clickVideoInBox:function(ele,userid)
{var parent=jsynchat(ele).parent();var $panel=jsynchat(parent).find('.panel');if($panel.find('.input-video').length==0){$panel.html(ynchat.getFormAttachVideo(userid));$panel.find('.button-video').click(function(){ynchat.attachVideo($panel,userid);});}
$panel.toggleClass('active');},attachVideo:function($ele,userid){if(null!=ynchat.oConnection&&'disconnect'==ynchat.oConnection.getStatus()){return ynchat.handleInvalidConnection();}
jsynchat.ajax({url:ynchat.getConfig('sApiUrl')+'ynchat/attachVideo',type:"POST",timeout:ynchat.getConfig('iTimeOut'),data:{action:"attachVideo",iUserId:userid,sUrl:ynhelper.base64_encode($ele.find('.input-video').val()),sUserIdHash:ynchat.getConfig('sUserIdHash')},success:function(sOutput){var oOutput=jsynchat.parseJSON(sOutput);if(oOutput.error_code>0){alert(oOutput.error_message);}else{ynchat.sendMessageAsText(oOutput.aMessage.iReceiverId,'',oOutput.aMessage.iMessageId,0);}},error:function(x,t,m){if(t==="timeout"){ynchat.showError(ynchat.getLang('connection_timed_out_please_try_again'));}else{}}});},getFormAttachLink:function(userid)
{var sForm='';sForm+='<div>';sForm+='<input type="text" class="input-link" value="" data-userid="'+userid+'"/>';sForm+='<div class="extra_info"></div>';sForm+='</div>';sForm+='<div>';sForm+='<button type="button" class="button-link btn btn-primary btn-sm" >'+ynchat.getLang('add')+'</button>';sForm+='</div>';return sForm;},clickLinkInBox:function(ele,userid)
{var parent=jsynchat(ele).parent();var $panel=jsynchat(parent).find('.panel');if($panel.find('.input-link').length==0){$panel.html(ynchat.getFormAttachLink(userid));$panel.find('.button-link').click(function(){ynchat.attachLink($panel,userid);});}
$panel.toggleClass('active');},attachLink:function($ele,userid){if(null!=ynchat.oConnection&&'disconnect'==ynchat.oConnection.getStatus()){return ynchat.handleInvalidConnection();}
jsynchat.ajax({url:ynchat.getConfig('sApiUrl')+'ynchat/attachLink',type:"POST",timeout:ynchat.getConfig('iTimeOut'),data:{action:"attachLink",iUserId:userid,sUrl:ynhelper.base64_encode($ele.find('.input-link').val()),sUserIdHash:ynchat.getConfig('sUserIdHash')},success:function(sOutput){var oOutput=jsynchat.parseJSON(sOutput);if(oOutput.error_code>0){alert(oOutput.error_message);}else{ynchat.sendMessageAsText(oOutput.aMessage.iReceiverId,'',oOutput.aMessage.iMessageId,0);}},error:function(x,t,m){if(t==="timeout"){ynchat.showError(ynchat.getLang('connection_timed_out_please_try_again'));}else{}}});},clickEmoticonStickerInBox:function(ele,userid)
{if(null!=ynchat.oConnection&&'disconnect'==ynchat.oConnection.getStatus()){return ynchat.handleInvalidConnection();}
var parent=jsynchat(ele).parent();var $panel=jsynchat(parent).find('.panel');if($panel.find('.emoticonsticker-container').length==0){$panel.html(ynchat.getFormEmoticonSticker(userid));$panel.find('.emoticonsticker-header span').click(function(){var tab_active=jsynchat(this).attr('rel');$panel.find('.emoticonsticker-header > span').removeClass('active');$panel.find('.emoticonsticker-body > div').removeClass('active');jsynchat(this).addClass('active');$panel.find('.'+tab_active).addClass('active');});$panel.find('.emoticon-item').click(function(){var ele=jsynchat(this);var text=ele.attr('icon');var textarea=jsynchat('#ynchat-box-user-'+userid+' .ynchat-box-actions').find('textarea');textarea.trigger('focus');var caret=textarea.caret().start;var val=textarea.val();val=val.substr(0,caret)+text+val.substr(caret);textarea.val(val);textarea.trigger('changed');});$panel.find('.sticker-item').click(function(){var stickerid=jsynchat(this).data('stickerid');var sBoxId="ynchat-box-user-"+userid;var iTimeStamp=0;if(jsynchat('#'+sBoxId+' .ynchat-box-history div:last-child').length>0){iTimeStamp=jsynchat('#'+sBoxId+' .ynchat-box-history div:last-child').data('reactid');}
ynchat.sendMessageAsText(userid,'',0,stickerid);$panel.removeClass('active');});}
if($panel.hasClass('active')==false){jsynchat('.panel.active').removeClass('active');$panel.addClass('active');}else{$panel.removeClass('active');}},getFormEmoticonSticker:function(userid)
{var sForm='';var idx=0;var aEmoticon=ynchat.getConfig('aEmoticon');var aSticker=ynchat.getConfig('aSticker');var sPicUrl=ynchat.getConfig('sPicUrl');sForm+='<div class="emoticonsticker-container" data-userid="'+userid+'">';sForm+='<div class="emoticonsticker-header">';sForm+='<span rel="emoticon-list" class="active">Emoticons</span>';sForm+='<span rel="sticker-list">Sticker</span>';sForm+='</div>';sForm+='<div class="emoticonsticker-body">';sForm+='<div class="emoticon-list active">';for(idx=0;idx<aEmoticon.length;idx++){sForm+='<span class="emoticon-item" icon="'+aEmoticon[idx].sText+'" title="'+aEmoticon[idx].sTitle+'"><img  data-text="'+aEmoticon[idx].sText+'" src="'+sPicUrl+'ynchat_emoticon/'+(ynchat.isMobile()?('png/'+aEmoticon[idx].sImage.replace('gif','png')):aEmoticon[idx].sImage)+'"></span>';}
sForm+='</div>';sForm+='<div class="sticker-list">';for(idx=0;idx<aSticker.length;idx++){sForm+='<span class="sticker-item" data-stickerid="'+aSticker[idx].iStickerId+'" title="'+aSticker[idx].sTitle+'"><img src="'+sPicUrl+'ynchat_sticker/'+(ynchat.isMobile()?('png/'+aSticker[idx].sImage.replace('gif','png')):aSticker[idx].sImage)+'"></span>';}
sForm+='</div>';sForm+='</div>';sForm+='</div>';return sForm;},checkBan:function(text,type)
{var idx=0;var aBanWord=ynchat.getConfig('aBanWord');switch(type){case'word':for(idx=0;idx<aBanWord.length;idx++){text=text.replace(aBanWord[idx].org_find_value,aBanWord[idx].org_replacement);}
break;}
return text;},parseEmoticon:function(text)
{var idx=0;var aEmoticon=ynchat.getConfig('aEmoticon');var sPicEmoticonUrl=ynchat.getConfig('sPicUrl')+'ynchat_emoticon/';var key='';for(idx=0;idx<aEmoticon.length;idx++){key=aEmoticon[idx].sText;text=text.replace(key,'<img src="'+sPicEmoticonUrl+aEmoticon[idx].sImage+'" alt="'+aEmoticon[idx].sTitle+'" title="'+aEmoticon[idx].sTitle+'" class="v_middle" />');text=text.replace('&lt;','<');text=text.replace('&gt;','>');text=text.replace('&quot;','"');}
return text;},prepareDisplay:function(sText){sText=sText.replace(/&lt;/g,'<').replace(/&gt;/g,'>').replace(/&quot;/g,'"');sText=sText.replace(/<script\b[^>]*>([\s\S]*?)<\/script>/gmi,'$1');return sText;},parseSticker:function(text,stickerid)
{var idx=0;var aSticker=ynchat.getConfig('aSticker');var sPicStickernUrl=ynchat.getConfig('sPicUrl')+'ynchat_sticker/';for(idx=0;idx<aSticker.length;idx++){if(stickerid==aSticker[idx].iStickerId){text='<img src="'+sPicStickernUrl+aSticker[idx].sImage+'" alt="'+aSticker[idx].sTitle+'" title="'+aSticker[idx].sTitle+'" />';break;}}
return text;},friendListHeaderBindEvent:function()
{jsynchat('#ynchat-main-content #ynchat-friend-list .headerbar').click(function(){ynchat.friendListHeaderClick(this);});jsynchat('#ynchat-main-content #ynchat-friend-list .headerbar .setting > a').click(function(e){if(jsynchat(this).next().hasClass('ynopen')==false){jsynchat('.ynopen').removeClass('ynopen');jsynchat(this).next().addClass('ynopen');}else{jsynchat(this).next().removeClass('ynopen');}
e.stopPropagation();return false;});jsynchat('#ynchat-main-content #ynchat-friend-list .headerbar .setting .menu li').click(function(e){var action=jsynchat(this).data('action');switch(action){case'advanced_settings':ynchat.getAdvancedSetting();break;case'close_all_tabs':ynchat.friendListHeaderMenuClickCloseAllTabs(this);break;case'go_online_offline':ynchat.friendListHeaderMenuClickGoOnlineOffline(this);break;case'play_sound':ynchat.friendListHeaderMenuClickPlaySound(this);break;}
jsynchat('#ynchat-main-content #ynchat-friend-list .headerbar .setting a').trigger('click');e.stopPropagation();});},getAdvancedSetting:function()
{jsynchat.ajax({url:ynchat.getConfig('sApiUrl')+'ynchat/getAdvancedSetting',type:"POST",timeout:ynchat.getConfig('iTimeOut'),data:{action:"getAdvancedSetting",sUserIdHash:ynchat.getConfig('sUserIdHash')},success:function(sOutput){var oOutput=jsynchat.parseJSON(sOutput);if(oOutput.error_code>0){alert(oOutput.error_message);}else{ynchat.friendListHeaderMenuClickAdvancedSettings(oOutput.aBlockList,oOutput.aAllowList);}},error:function(x,t,m){if(t==="timeout"){ynchat.showError(ynchat.getLang('connection_timed_out_please_try_again'));}else{}}});},friendListHeaderMenuClickAdvancedSettings:function(aBlockList,aAllowList)
{var sForm='';sForm+='<div class="advanced-settings">';sForm+='<div class="padding-bottom">';sForm+='<div class="ynchat-input-checkbox">';sForm+='<input type="radio" id="turnoff" name="list_turn_on_off_chat" value="turnoff">'+ynchat.getLang('turn_on_chat_except');sForm+='</div>';sForm+='<div class="list-turn-off-chat">';sForm+='<input type="text" id="list-turn-off-chat" class="form-control"/>';sForm+='</div>';sForm+='</div>';sForm+='<div class="padding-bottom">';sForm+='<div class="ynchat-input-checkbox">';sForm+='<input type="radio" id="turnon" name="list_turn_on_off_chat" value="turnon">'+ynchat.getLang('turn_on_chat_for_only_some_friends');sForm+='</div>';sForm+='<div class="list-turn-on-chat">';sForm+='<input type="text" id="list-turn-on-chat" class="form-control"/>';sForm+='</div>';sForm+='</div>';sForm+='<div>';sForm+='<button class="btn btn-primary btn-xs">'+ynchat.getLang('save')+'</button>';sForm+='</div>';sForm+='</div>';jsynchat('.ynopen').removeClass('ynopen');ynchat.openPopupModal('Advanced Settings',sForm,'500px','auto');var options={theme:"facebook",method:"POST",noResultsText:ynchat.getLang('nothing_friend_s_found'),searchingText:ynchat.getLang('searching'),placeholder:ynchat.getLang('enter_name'),preventDuplicates:true,hintText:'',resultsFormatter:ynchat.resultsFormatterTurnOnOffChatWithFriend,tokenFormatter:ynchat.tokenFormatterTest};jsynchat("#list-turn-off-chat").tokenInput(ynchat.getConfig('sApiUrl')+'ynchat/searchFriend',options);jsynchat("#list-turn-on-chat").tokenInput(ynchat.getConfig('sApiUrl')+'ynchat/searchFriend',options);jsynchat('.advanced-settings input[type=radio][name=list_turn_on_off_chat]').change(function(){var elelTurnoff='.advanced-settings .list-turn-off-chat';var eleTurnon='.advanced-settings .list-turn-on-chat';switch(this.value){case'turnoff':jsynchat(elelTurnoff).show();jsynchat(eleTurnon).hide();break;case'turnon':jsynchat(eleTurnon).show();jsynchat(elelTurnoff).hide();break;}});jsynchat('.advanced-settings button').click(function(){ynchat.friendListHeaderMenuSaveAdvancedSettings();return false;});var elelTurnoff='.advanced-settings .list-turn-off-chat';var eleTurnon='.advanced-settings .list-turn-on-chat';switch(ynchat.getUserSettings('sTurnOnOff')){case'onall':case'offall':jsynchat('.advanced-settings #turnoff').prop('checked',true);jsynchat(elelTurnoff).show();jsynchat(eleTurnon).hide();break;case'onsome':jsynchat('.advanced-settings #turnon').prop('checked',true);jsynchat(eleTurnon).show();jsynchat(elelTurnoff).hide();break;case'offsome':jsynchat('.advanced-settings #turnoff').prop('checked',true);jsynchat(elelTurnoff).show();jsynchat(eleTurnon).hide();break;}
var idx=0;for(idx=0;idx<aBlockList.length;idx++){jsynchat("#list-turn-off-chat").tokenInput("add",aBlockList[idx]);}
for(idx=0;idx<aAllowList.length;idx++){jsynchat("#list-turn-on-chat").tokenInput("add",aAllowList[idx]);}},friendListHeaderMenuSaveAdvancedSettings:function()
{var sBlockList='';var sAllowList='';var idx=0;var aBlockList=jsynchat("#list-turn-off-chat").tokenInput("get");if(aBlockList.length>0){sBlockList+=aBlockList[0].user_id;for(idx=1;idx<aBlockList.length;idx++){sBlockList+=','+aBlockList[idx].user_id;}}
var aAllowList=jsynchat("#list-turn-on-chat").tokenInput("get");if(aAllowList.length>0){sAllowList+=aAllowList[0].user_id;for(idx=1;idx<aAllowList.length;idx++){sAllowList+=','+aAllowList[idx].user_id;}}
jsynchat.ajax({url:ynchat.getConfig('sApiUrl')+'ynchat/saveAdvancedSetting',type:"POST",timeout:ynchat.getConfig('iTimeOut'),data:{action:"saveAdvancedSetting",sTurn:jsynchat(".advanced-settings input[type='radio']:checked").val(),sBlockList:sBlockList,sAllowList:sAllowList,sUserIdHash:ynchat.getConfig('sUserIdHash')},success:function(sOutput){var oOutput=jsynchat.parseJSON(sOutput);if(oOutput.error_code>0){alert(oOutput.error_message);}else{ynchat.closePopupModal(jsynchat('.ynchat-popup-close'));ynchat.setUserSettings('sTurnOnOff',oOutput.sTurnonoff)}},error:function(x,t,m){if(t==="timeout"){ynchat.showError(ynchat.getLang('connection_timed_out_please_try_again'));}else{}}});},resultsFormatterTurnOnOffChatWithFriend:function(item)
{var sHtml='';sHtml+='<div class="avatar"><img src="'+(item.avatar)+'" /></div>';sHtml+='<div class="name">'+item.full_name+'</div>';return"<li>"+sHtml+"</li>";},tokenFormatterTest:function(item)
{var sHtml='';sHtml+=item.full_name;return"<li><p>"+sHtml+"</p></li>";},friendListHeaderMenuClickCloseAllTabs:function(ele)
{ynchat.updateUserBoxSetting(0,'removeall');jsynchat('#ynchat-chatboxtabs').html('');jsynchat('#ynchat-hidetabs').html('');},friendListHeaderMenuClickGoOnlineOffline:function(ele)
{var status=ynchat.getUserSettings('iIsGoOnline')==1?0:1;ynchat.setUserSettings('iIsGoOnline',status);if(ynchat.getUserSettings('iIsGoOnline')){jsynchat(ele).html(ynchat.getLang('go_offline'));}else{jsynchat(ele).html(ynchat.getLang('go_online'));}
jsynchat.ajax({url:ynchat.getConfig('sApiUrl')+'ynchat/updateStatusGoOnline',type:"POST",timeout:ynchat.getConfig('iTimeOut'),data:{action:"updateStatusGoOnline",iStatus:status,sUserIdHash:ynchat.getConfig('sUserIdHash')},success:function(sOutput){var oOutput=jsynchat.parseJSON(sOutput);if(oOutput.error_code>0){alert(oOutput.error_message);}else{}},error:function(x,t,m){if(t==="timeout"){ynchat.showError(ynchat.getLang('connection_timed_out_please_try_again'));}else{}}});},friendListHeaderMenuClickPlaySound:function(ele)
{var status=ynchat.getUserSettings('iIsNotifySound')==1?0:1;ynchat.setUserSettings('iIsNotifySound',status);if(ynchat.getUserSettings('iIsNotifySound')){jsynchat(ele).find('span').html(ynchat.getLang('yes'));}else{jsynchat(ele).find('span').html(ynchat.getLang('no'));}
jsynchat.ajax({url:ynchat.getConfig('sApiUrl')+'ynchat/updateStatusPlaySound',type:"POST",timeout:ynchat.getConfig('iTimeOut'),data:{action:"updateStatusPlaySound",iStatus:status,sUserIdHash:ynchat.getConfig('sUserIdHash')},success:function(sOutput){var oOutput=jsynchat.parseJSON(sOutput);if(oOutput.error_code>0){alert(oOutput.error_message);}else{}},error:function(x,t,m){if(t==="timeout"){ynchat.showError(ynchat.getLang('connection_timed_out_please_try_again'));}else{}}});},friendListHeaderClick:function(ele)
{jsynchat(ele).parent().toggleClass('ynchat-hide');jsynchat(ele).toggleClass('active');},updateAgent:function(){sUrl=ynchat.getConfig('sApiUrl');jsynchat.ajax({url:ynchat.getConfig('sApiUrl')+'ynchat/updateAgent',type:"POST",timeout:ynchat.getConfig('iTimeOut'),data:{action:"updateAgent",sUserIdHash:ynchat.getConfig('sUserIdHash')},success:function(sOutput){},error:function(x,t,m){}});},dragenterFiles:function(e,ele){e.preventDefault();jsynchat(ele).addClass('ynchat-file-pending');},dragoverFiles:function(e){e.preventDefault();},dropFiles:function(e,ele){jsynchat(ele).removeClass('ynchat-file-pending');e.preventDefault();var files=e.dataTransfer.files;var box_actions=jsynchat(ele).next('.ynchat-box-actions');var chat_attachment=jsynchat(box_actions).next('.chat-attachment');var files_container=jsynchat(chat_attachment).find('.ynchat-content')[0];var chatinput=jsynchat(box_actions).find('.chatting')[0];if(files.length>0){for(var i=0;i<files.length;i++){ynchat.addFile(files[i]);var file_div=jsynchat('<div />',{'class':'file_div'});var file_name=jsynchat('<span />',{'class':'file_name',text:files[i].name});var remove_btn=jsynchat('<span />',{'class':'remove_file','text':'','click':function(){var parent=jsynchat(this).parent();var index=jsynchat(parent).index();jsynchat(parent).remove();ynchat.removeFile(index);}});file_div.append(remove_btn);file_div.append(file_name);jsynchat(files_container).append(file_div);jsynchat(chatinput).focus();}}},checkNewMessage:function(ele){if(jsynchat(ele).scrollTop()+jsynchat(ele).innerHeight()>=ele.scrollHeight){var newMessageNotice=jsynchat(ele).find('.newMessageNotice');if(newMessageNotice.length>0){jsynchat(newMessageNotice[0]).remove();var parent=jsynchat(ele).closest('.chatboxuser');ynchat.removeNewMessageInFriendsList(jsynchat(parent).attr('data-userid'));}}},updateNewMessage:function(userId){var chatbox=jsynchat('#ynchat-box-user-'+userId);var parent=chatbox.parent();if(jsynchat(parent).attr('id')=='ynchat-hidetabs'){var hideItem=jsynchat('#hideuser_'+userId);var countNewMessage=jsynchat('#hideuser_'+userId+' .count-new-message');if(countNewMessage.length==0){countNewMessage=jsynchat('<span />',{'class':'count-new-message',text:1,css:{'padding':'3px','background':'red','color':'white'}}).prependTo(hideItem);}
else{var text=jsynchat(countNewMessage[0]).text();if(isNaN(text)){return;}
var count_mess=parseInt(text)+1;if(count_mess>9)count_mess='9+';jsynchat(countNewMessage[0]).text(count_mess);}
ynchat.updateHideListNewMessage();}
else{if(!chatbox.hasClass('active')){var countNewMessage=chatbox.find('.count-new-message');if(countNewMessage.length==0){var title=jsynchat(chatbox.find('.title')[0]);countNewMessage=jsynchat('<span />',{'class':'count-new-message',text:1,css:{'padding':'3px','background':'red','color':'white'}}).prependTo(title);}
else{var text=jsynchat(countNewMessage[0]).text();var count_mess=parseInt(text)+1;jsynchat(countNewMessage[0]).text(count_mess);}}}
ynchat.updateNewMessageInFriendsList(userId);},updateHideListNewMessage:function(){var count=0;jsynchat('#ynchat-hidelist .count-new-message').each(function(){if(jsynchat(this).text()=='9+'){count=10;return;}
count+=parseInt(jsynchat(this).text());})
var countNewMessage=jsynchat('#ynchat-hidelist #count-new-message');if(count>0){if(count>9)count='9+';if(countNewMessage.length==0){countNewMessage=jsynchat('<div />',{id:'count-new-message',text:count,css:{'padding':'3px','background':'red','color':'white','position':'absolute','bottom':'18px','left':'30px'}}).appendTo(jsynchat('#ynchat-hidelist'));}
else{countNewMessage.text(count);}}
else{if(countNewMessage.length==0){}
else{countNewMessage.remove();}}},updateNewMessageInFriendsList:function(userId){var friendItem='#ynchat-friend-'+userId;var countNewMessage=jsynchat(friendItem+' .count-new-message');if(countNewMessage.length==0){countNewMessage=jsynchat('<span />',{'class':'count-new-message',text:1}).appendTo(friendItem);}
else{countNewMessage=jsynchat(countNewMessage[0]);var count=countNewMessage.text();if(isNaN(count)){return;}
var count=parseInt(count)+1;if(count>9)count='9+';countNewMessage.text(count);}},removeNewMessageInFriendsList:function(userId){var friendItem='#ynchat-friend-'+userId;var countNewMessage=jsynchat(friendItem+' .count-new-message');if(countNewMessage.length>0){ynchat.scrollToBottom('#ynchat-box-user-'+userId+' .ynchat-box-history',100,1000);jsynchat('.newMessageNotice').remove();jsynchat(countNewMessage[0]).remove();}},openPopupModal:function(title,content,width,height){if(!width){width='500px';}
if(!height){height='400px';}
var sPopup='';sPopup+='<div class="ynchat-popup-overlay"></div>';sPopup+='<div class="ynchat-popup-drop">';sPopup+='<div class="ynchat-popup" style="width: '+width+'; height: '+height+'">';sPopup+='<div class="ynchat-popup-header"><h2>'+title+'</h2>';sPopup+='<div class="ynchat-popup-close"></div></div>';sPopup+='<div class="ynchat-popup-body">'+content+'</div>';sPopup+='</div>';sPopup+='</div>';jsynchat('#ynchat-iframe-container').addClass('ynchat-popup-open');jsynchat('#ynchat-iframe-container').append(sPopup);jsynchat('#ynchat-iframe-container').find('img').css('max-height',(window.innerHeight-60)*0.8);jsynchat('#ynchat-iframe-container').find('iframe').css('max-height',(window.innerHeight-60)*0.8);jsynchat('#ynchat-iframe-container').find('video').css('max-height',(window.innerHeight-60)*0.8);jsynchat('#ynchat-iframe-container').find('embed').css('max-height',(window.innerHeight-60)*0.8);jsynchat('.ynchat-popup-overlay').click(function(){ynchat.closePopupModal(jsynchat(this));});jsynchat('.ynchat-popup-close').click(function(){ynchat.closePopupModal(jsynchat(this));});},closePopupModal:function(e){e.closest('.ynchat-popup-drop').remove();jsynchat('#ynchat-iframe-container').find('.ynchat-popup-overlay:eq(0)').remove();if(jsynchat('.ynchat-popup-drop').length==0)
{jsynchat('#ynchat-iframe-container').removeClass('ynchat-popup-open');}},showVideoInPopup:function(ele){var iframe=jsynchat(ele).data('iframe');var width=parseInt(jsynchat(ele).data('width'))+26+'px';var height=parseInt(jsynchat(ele).data('height'))+75+'px';iframe=ynhelper.base64_decode(iframe);ynchat.openPopupModal(ynchat.getLang('video'),iframe,width,'auto');},showPhotoInPopup:function(ele){var url=jsynchat(ele).data('url');var sHtml='';sHtml+='<div>';sHtml+='<img onclick="return false;" src="'+url+'" />';sHtml+='</div>';ynchat.openPopupModal(ynchat.getLang('photo'),sHtml,'auto','auto');},checkAtBottomContainer:function(ele){var elem=jsynchat(ele);if(elem[0].scrollHeight-elem.scrollTop()==elem.outerHeight())
{return true;}
return false;},scrollToBottom:function(ele,timeout,timeanimate){setTimeout(function()
{if(ynchat.checkAtBottomContainer(ele)==false){jsynchat(ele).animate({scrollTop:jsynchat(ele)[0].scrollHeight},timeanimate);}
if(ynchat.isMobile()&&jsynchat('body').hasClass('show-ynchat-mobileview')&&jsynchat('#ynchat-iframe-container').hasClass('ynchat-box-chatting')){jsynchat('body').animate({scrollTop:jsynchat('body')[0].scrollHeight},timeanimate);}},timeout);}};jsynchat(document).ready(function(){ynchat.setConfig('sApiUrl','http://productdev.local/PF.Base/module/ynchat/api.php/');ynchat.setConfig('iIsMobile','0');ynchat.initLangAndConfig();if(window.navigator&&window.navigator.onLine){window.addEventListener("offline",function(e){ynchat.disableIframe();},false);window.addEventListener("online",function(e){if(ynchat.oConnection!=null){ynchat.oConnection.reconnect();}},false);}});